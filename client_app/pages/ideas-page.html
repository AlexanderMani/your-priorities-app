<polymer-element name="ideas-page">
  <template>


    <style>
      .card-container {
        text-align: center;
      }

      section {
        padding: 20px 0;
      }

      .category {
        padding-right: 16px;
      }

      .description {
        padding-top: 8px;
        padding-bottom: 8px;
      }

      .card {
        display: inline-block;
        background: white;
        box-sizing: border-box;
        width: 400px;
        height: 240px;
        margin: 16px;
        padding: 16px;
        border-radius: 2%;
        text-align: left;
        vertical-align: top;
      }
    </style>

    <core-ajax
      auto="false"
      id="ajax"
      url="/api/ideas"
      response="{{response}}"
      handleAs="json">
    </core-ajax>

    <div class="card-container">
      <template repeat="{{ideas as idea}}">
        <paper-shadow class="card" z="1" center-center layout>
          <div layout horizontal flex>
            <div>
              <img class="category"
                src="https://s3.amazonaws.com/better-reykjavik-paperclip-production/categories/icons/000/000/{{idea.Category.id | fillIdValue}}/icon_50/{{idea.Category.icon_file_name}}"/>
            </div>
            <div flex><b>{{idea.name | trim | truncate(60) }}</b></div>
          </div>

          <div justified layout class="description">{{idea.description | trim | truncate(300,"...")}}</div>

          <template if="{{false}}">
            <div horizontal justified layout>
              <template if="{{idea.Points[0].content}}">
                <div flex style="color:#136c22" class="point">{{idea.Points[0].content | truncate(160)}}</div>
              </template>
              <template if="{{idea.Points[1].content}}">
                <div flex style="color:#900" class="table-style">{{idea.Points[1].content | truncate(160)}}</div>
              </template>
              <template if="{{!idea.Points[1].content}}">
                <div flex style="color:#900" class="table-style">Add point against</div>
              </template>
            </div>
          </template>
        </paper-shadow>
      </template>
    </div>
  </template>

  <script>

    Polymer('ideas-page', {

      page: 0,

      ideas: [],

      selectedIdea: null,

      fillIdValue: function (value) {
        return ('000' + value).substr(-3);
      },

      ready: function () {
        this.url = "http://gdata.youtube.com/feeds/api/videos/";
        this.params = '{"alt":"json", "q":"chrome"}';
        this.$.ajax.go();
      },
      transition: function (e) {
        if (this.page === 0 && e.target.templateInstance.model.idea) {
          this.selectedIdea = e.target.templateInstance.model.idea;
          this.page = 1;
        } else {
          this.page = 0;
        }
      },
      responseChanged: function (e, detail, sender) {
        this.ideas = detail;
      }
    });
  </script>
</polymer-element>
