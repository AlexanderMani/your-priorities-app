<link rel="import" href="../../bower_components/polymer/polymer.html">

<link rel="import" href="../../bower_components/iron-flex-layout/iron-flex-layout-classes.html">
<link rel="import" href="../../bower_components/lite-signal/lite-signal.html">

<link rel="import" href="../../bower_components/paper-dialog/paper-dialog.html">
<link rel="import" href="../../bower_components/paper-button/paper-button.html">

<link rel="import" href="../yp-behaviors/yp-language-behavior.html">
<link rel="import" href="../yp-app-globals/yp-language-selector.html">

<dom-module id="yp-autotranslate-dialog">
  <template>

    <style include="iron-flex iron-flex-alignment">
      paper-dialog {
        background-color: #FFF;
      }
    </style>
    <lite-signal on-lite-signal-yp-language="_languageEvent"></lite-signal>
    <yp-language-selector hidden id="languageSelector"></yp-language-selector>

    <paper-dialog id="dialog">
      <div>[[t('shouldAutoTranslateInfo')]]</div>
      <div class="buttons">
        <paper-button on-tap="_dontAskAgain" dialog-dismiss>[[t('dontAskAgain')]]</paper-button>
        <paper-button dialog-dismiss>[[t('no')]]</paper-button>
        <paper-button raised dialog-confirm on-tap="_startAutoTranslate">[[t('autoTranslate')]]</paper-button>
      </div>
    </paper-dialog>

  </template>

  <script>
    Polymer({

      is: 'yp-autotranslate-dialog',

      behaviors: [
        Polymer.ypLanguageBehavior
      ],

      _dontAskAgain: function () {
        localStorage.setItem("dontPromptForAutoTranslation", true);
      },

      _startAutoTranslate: function () {
        this.$.languageSelector._startTranslation();
      },

      openLaterIfAutoTranslationEnabled: function () {
        this.async(function () {
          if (this.$.languageSelector.canUseAutoTranslate===true) {
            this.$.dialog.open();
          }
        }, 750);
      }
    });
  </script>
</dom-module>
