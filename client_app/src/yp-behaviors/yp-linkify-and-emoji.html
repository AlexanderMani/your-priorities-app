<link rel="import" href="../../bower_components/polymer/polymer.html">

<script src="../../bower_components/twemoji-min/2/twemoji.min.js"></script>
<script type="text/javascript" src="sanitize-html.min.js"></script>

<script>
  /**
   * @polymerBehavior Polymer.YpLinkifyAndEmjoi
   */
  Polymer.YpLinkifyAndEmjoi = {
    addLinksAndEmjois: function (text) {
      var sanitizedText = sanitizeHtml(text, {
        allowedTags: [ 'b', 'i', 'em', 'strong'] });
      sanitizedText = linkifyStr(sanitizedText, {
        format: function (value, type) {
          if (type === 'url' && value.length > 34) {
            value = value.slice(0, 35) + 'â€¦';
          }
          return value;
        },
        ignoreTags: [
          'b',
          'i',
          'em',
          'strong'
        ]
      });
      return twemoji.parse(sanitizedText).
                     replace(/&amp\;quot\;/g,"\"").
                     replace(/class=\"emoji\" /g,'style="height: 1em;width: 1em;margin: 0 .3em 0 .3em;vertical-align: -0.1em;" ');
    }
  }
</script>
