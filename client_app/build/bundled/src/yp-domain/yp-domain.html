<html><head><meta charset="UTF-8"><link rel="import" href="../yp-app.html"></head><body><dom-module id="yp-domain">
  <template>
    <style>

      ac-activities {
        @apply(--layout-vertical);
        @apply(--layout-flex);
      }

      .card-container {
        @apply(--layout-horizontal);
        @apply(--layout-wrap);
      }

      .card {
        padding: 16px;
      }

      @media (max-width: 330px) {
        .card {
          padding-left: 0;
          padding-right: 0;
          padding-bottom: 8px;
          padding-top: 8px;
        }

        .card-container {
          padding: 0;
          margin: 0;
        }
      }

      yp-ajax {
        background-color: var(--primary-background-color);
      }

      .twitterFeed {
        margin-top: 24px;
      }

      .archivedText {
        font-size: 26px;
        color: #333;
      }
    </style>
    <iron-signals on-iron-signal-yp-language="_languageEvent"></iron-signals>

    <yp-page id="page" create-fab-icon="[[createFabIcon]]" create-fab-title="[[t('community.add')]]" on-yp-create-fab-tap="_newCommunity">

      <yp-domain-large-card id="domainCard" class="largeCard card" domain="[[domain]]" on-update-domain="_refresh"></yp-domain-large-card>

      <paper-tabs id="paper_tabs" class="tabs" selected="{{selected}}" focused="">
        <paper-tab class="tab"><span>[[t('communities')]]</span> &nbsp; (<span>[[communitiesLength]]</span>)</paper-tab>
        <paper-tab class="tab">[[t('news')]]</paper-tab>
        <paper-tab class="tab">
          <div class="layout vertical center-center">
            <div>[[t('other')]]</div>
            <div>[[t('socialMedia')]]</div>
          </div>
        </paper-tab>
      </paper-tabs>

      <iron-pages class="tabPages" selected="{{selected}}" entry-animation="fade-in-animation" exit-animation="fade-out-animation">
        <section class="layout vertical">
          <div class="card-container layout center-center wrap">
            <yp-community-grid featured-communities="[[featuredCommunities]]" active-communities="[[activeCommunities]]" archived-communities="[[archivedCommunities]]">
            </yp-community-grid>
          </div>
          <yp-community-card-add hidden$="[[!createFabIcon]]" class="card" on-tap="_newCommunity"></yp-community-card-add>
        </section>
        <section>
          <ac-activities domain-id="[[domain.id]]"></ac-activities>
        </section>
        <section class="layout vertical">
          <yp-other-social-media active="[[otherSocialMediaActive]]"></yp-other-social-media>
        </section>
      </iron-pages>
    </yp-page>

    <yp-ajax id="ajax" url="[[url]]" on-response="_response"></yp-ajax>
    <yp-ajax id="pagesAjax" on-response="_pagesResponse"></yp-ajax>

  </template>

  <script>Polymer({is:"yp-domain",behaviors:[Polymer.appHelpers,Polymer.ypThemeBehavior,Polymer.CommunityCollectionBehaviors,Polymer.CollectionHelpers,Polymer.AccessHelpers],properties:{createFabIcon:{type:String,value:null,notify:!0},domainId:{type:Number,value:null,observer:"_domainIdChanged"},url:{type:String},domainEmpty:{type:Boolean,value:!1},domain:{type:Object},hideAdd:{type:Boolean,value:!0},selected:{type:Number,value:0,observer:"_selectedChanged"},otherSocialMediaActive:{type:Boolean,value:!1},domainTabName:{type:String,value:null,observer:"_tabNameChanged"}},_tabNameChanged:function(e){e&&("communities"==e?this.set("selected",0):"news"==e?this.set("selected",1):"other_social_media"==e&&this.set("selected",2))},_selectedChanged:function(e){2==e?this.set("otherSocialMediaActive",!0):this.set("otherSocialMediaActive",!1),this.domain&&(0==e?this.redirectTo("/domain/"+this.domain.id+"/communities"):1==e?this.redirectTo("/domain/"+this.domain.id+"/news"):2==e&&this.redirectTo("/domain/"+this.domain.id+"/other_social_media"))},_domainIdChanged:function(e,i){e&&(this.set("featuredCommunities",null),this.set("activeCommunities",null),this.set("archivedCommunities",null),this.$.ajax.url="/api/domains/"+this.domainId,this.$.ajax.generateRequest(),this.hideAdd=!0)},_refresh:function(){this.$.ajax.generateRequest()},_newCommunity:function(){window.appGlobals.activity("open","newCommunity");var e=Polymer.dom(document).querySelector("yp-app").getDialog("communityEdit");e.setup(null,!0,null),e.open("new",{domainId:this.domainId})},_pagesResponse:function(e,i){this.fire("yp-set-pages",i.response)},_response:function(e,i,t){this.set("domain",i.response),this.fire("yp-set-home-link",{type:"domain",id:this.domain.id,name:this.domain.name}),window.appGlobals.domain=this.domain,null!=this.domain.theme_id&&this.setTheme(this.domain.theme_id),this.domain.only_admins_can_create_communities&&!this.checkDomainAccess(this.domain)||this.set("createFabIcon","group-work"),this.$.pagesAjax.url="/api/domains/"+this.domain.id+"/pages",this.$.pagesAjax.generateRequest(),window.appGlobals.setupGoogleAnalytics(this.domain),this.domain.DomainHeaderImages&&this.domain.DomainHeaderImages.length>0&&this.$.page.setupTopHeaderImage(this.domain.DomainHeaderImages),this.domain.Communities&&this.setupCommunities(_.dropRight(this.domain.Communities,this.domain.Communities.length-15)),this.$.domainCard.setElevation(5),this.$.domainCard.lowerCardLater(),this.fire("change-header",{headerTitle:null,documentTitle:this.domain.name,headerDescription:this.domain.description}),this.activeCommunities.length>0?this.hideAdd=!0:this.hideAdd=!1}});</script>
</dom-module>
</body></html>