<html><head></head><body><div hidden="" by-polymer-bundler=""><dom-module id="yp-category-edit" assetpath="../yp-category/"><template><style include="iron-flex iron-flex-alignment"></style><lite-signal on-lite-signal-yp-language="_languageEvent"></lite-signal><yp-edit-dialog id="editDialog" title="[[editHeaderText]]" icon="add" action="[[action]]" method="[[method]]" params="[[params]]" save-text="[[saveText]]" toast-text="[[toastText]]"><paper-input id="name" name="name" type="text" label="[[t('Name')]]" value="{{category.name}}" maxlength="60" char-counter=""></paper-input><paper-textarea id="description" name="description" value="{{category.description}}" label="[[t('Description')]]" char-counter="" rows="2" max-rows="5" maxlength="300"></paper-textarea><div class="layout vertical additionalSettings"><yp-file-upload id="iconImageUpload" droppable="true" raised="true" multi="false" target="/api/images?itemType=category-icon" method="POST" on-success="_iconImageUploaded"><iron-icon class="icon" icon="photo-camera"></iron-icon><span>[[t('image.icon.upload')]]</span></yp-file-upload></div><div class="layout vertical additionalSettings" hidden=""><yp-file-upload id="headerImageUpload" droppable="true" raised="true" multi="false" target="/api/images?itemType=category-header" method="POST" on-success="_headerImageUploaded"><iron-icon class="icon" icon="photo-camera"></iron-icon><span>[[t('image.header.upload')]]</span></yp-file-upload></div><input type="hidden" name="uploadedIconImageId" value="[[uploadedIconImageId]]"> <input type="hidden" name="uploadedHeaderImageId" value="[[uploadedHeaderImageId]]"></yp-edit-dialog></template></dom-module><script>Polymer({is:'yp-category-edit',behaviors:[Polymer.appHelpers,Polymer.ypEditDialogBehavior],properties:{action:{type:String,value:'/api/categories'},category:{type:Object},group:{type:Object},categoryAccess:{type:String},params:{type:String},method:{type:String},uploadedIconImageId:{type:String},uploadedHeaderImageId:{type:String}},_iconImageUploaded:function(a,b){var c=JSON.parse(b.xhr.response);this.set('uploadedIconImageId',c.id)},_headerImageUploaded:function(a,b){var c=JSON.parse(b.xhr.response);this.set('uploadedHeaderImageId',c.id)},setup:function(a,b,c,d){this.set('group',a),this.set('new',b),this.set('refreshFunction',c),d&&this.set('category',d),this._setupTranslation(),this._setupNewUpdateState()},_clear:function(){this.set('category',{name:'',description:''}),this.set('uploadedIconImageId',null),this.set('uploadedHeaderImageId',null),this.$.headerImageUpload.clear(),this.$.iconImageUpload.clear()},_setupTranslation:function(){this.new?(this.editHeaderText=this.t('New category'),this.toastText=this.t('category.toast.created')):(this.editHeaderText=this.t('Update category info'),this.toastText=this.t('category.toast.updated'))}});</script><dom-module id="yp-users-grid" assetpath="../yp-user/"><template><style include="iron-flex iron-flex-alignment">#dialog{width:800px;background-color:#FFF;}iron-list{color:#000;height:500px;width:100%;}.userItem{padding-right:16px;}.id{width:40px;}.name{width:200px;}.email{width:190px;}.organization{width:150px;}.addRemoveButtons{width:150px;}#selectOrganizationDialog{background-color:#FFF;}[hidden]{display:none !important;}</style><lite-signal on-lite-signal-yp-language="_languageEvent"></lite-signal><paper-dialog id="selectOrganizationDialog" modal=""><h2>[[t('users.selectOrganization')]]</h2><paper-dialog-scrollable><paper-listbox><template is="dom-repeat" items="[[availableOrganizations]]"><paper-item on-tap="_selectOrganization" id="[[item.id]]">[[item.name]]</paper-item></template></paper-listbox></paper-dialog-scrollable><div class="buttons"><paper-button dialog-dismiss="">[[t('Close')]]</paper-button></div></paper-dialog><paper-dialog id="dialog"><h2>[[headerText]]</h2><paper-dialog-scrollable><iron-list items="[[users]]" as="user"><template><div class="layout horizontal"><div class="userItem id">[[user.id]]</div><div class="userItem name">[[user.name]]</div><div class="userItem email">[[user.email]]</div><template is="dom-if" if="[[!_userOrganizationName(user)]]"><div class="organization"><paper-button data-args$="[[user.id]]" on-tap="_addToOrganization">[[t('users.addToOrganization')]]</paper-button></div></template><div class="organization" hidden$="[[!_userOrganizationName(user)]]"><div class="organizationName">[[_userOrganizationName(user)]]</div><paper-button data-args$="[[user.id]]" data-args-org$="[[_userOrganizationId(user)]]" on-tap="_removeFromOrganization">[[t('users.removeFromOrganization')]]</paper-button></div><div hidden$="[[!adminUsers]]" class="addRemoveButtons"><paper-button data-args$="[[user.id]]" on-tap="_removeAdmin">[[t('users.removeAdmin')]]</paper-button></div><div hidden$="[[adminUsers]]"><paper-button data-args$="[[user.id]]" on-tap="_removeUser">[[t('users.removeUser')]]</paper-button></div></div></template></iron-list></paper-dialog-scrollable><div hidden$="[[!adminUsers]]" class="layout horizontal"><paper-input label="[[t('users.email')]]" value="{{addAdminEmail}}"></paper-input><paper-button on-tap="_addAdmin">[[t('users.addAdmin')]]</paper-button></div><div hidden$="[[adminUsers]]" class="layout horizontal"><paper-input label="[[t('users.email')]]" value="{{inviteUserEmail}}"></paper-input><paper-button on-tap="_inviteUser">[[t('users.inviteUser')]]</paper-button></div><div class="buttons"><paper-button dialog-dismiss="">[[t('close')]]</paper-button></div></paper-dialog><div class="layout horizontal center-center"><yp-ajax id="ajax" on-response="_usersResponse"></yp-ajax><yp-ajax method="DELETE" id="removeAdminAjax" on-response="_removeAdminResponse"></yp-ajax><yp-ajax method="DELETE" id="removeUserAjax" on-response="_removeUserResponse"></yp-ajax><yp-ajax method="DELETE" id="removeOrganizationAjax" on-response="_removeOrganizationResponse"></yp-ajax><yp-ajax method="POST" id="inviteUserAjax" on-response="_inviteUserResponse"></yp-ajax><yp-ajax method="POST" id="addAdminAjax" on-response="_addAdminResponse"></yp-ajax><yp-ajax method="POST" id="addOrganizationAjax" on-response="_addOrganizationResponse"></yp-ajax></div></template><script>Polymer({is:'yp-users-grid',behaviors:[Polymer.appHelpers],properties:{addAdminEmail:{type:String},inviteUserEmail:{type:String},users:{type:Array,notify:!0},headerText:{type:String},groupId:{type:Number,observer:'_groupIdChanged'},domainId:{type:Number,observer:'_domainIdChanged'},communityId:{type:Number,observer:'_communityIdChanged'},adminUsers:{type:Boolean,value:!1},selected:{type:Object},modelType:{type:String},opened:{type:Boolean,value:!1},availableOrganizations:{type:Array},userIdForSelectingOrganization:Number},_userOrganizationId:function(a){return a&&a.OrganizationUsers&&0<a.OrganizationUsers.length?a.OrganizationUsers[0].id:null},_userOrganizationName:function(a){return a&&a.OrganizationUsers&&0<a.OrganizationUsers.length?a.OrganizationUsers[0].name:null},_availableOrganizations:function(){return window.appUser.adminRights&&window.appUser.adminRights.OrganizationAdmins?window.appUser.adminRights.OrganizationAdmins:[]},_addToOrganization:function(a){this.set('userIdForSelectingOrganization',a.target.getAttribute('data-args')),this.set('availableOrganizations',this._availableOrganizations()),this.$.selectOrganizationDialog.open()},_removeFromOrganization:function(a){var b=a.target.getAttribute('data-args'),c=a.target.getAttribute('data-args-org');this.$.removeOrganizationAjax.body={},this.$.removeOrganizationAjax.url='/api/organizations/'+c+'/'+b+'/remove_user',this.$.removeOrganizationAjax.generateRequest()},_selectOrganization:function(a){this.$.addOrganizationAjax.body={},this.$.addOrganizationAjax.url='/api/organizations/'+a.target.id+'/'+this.userIdForSelectingOrganization+'/add_user',this.$.addOrganizationAjax.generateRequest(),this.$.selectOrganizationDialog.close()},_removeAdmin:function(a){var b=a.target.getAttribute('data-args');this.$.removeAdminAjax.body={},'groups'==this.modelType&&this.groupId?(this.$.removeAdminAjax.url='/api/'+this.modelType+'/'+this.groupId+'/'+b+'/remove_admin',this.$.removeAdminAjax.generateRequest()):'communities'==this.modelType&&this.communityId?(this.$.removeAdminAjax.url='/api/'+this.modelType+'/'+this.communityId+'/'+b+'/remove_admin',this.$.removeAdminAjax.generateRequest()):console.warn('Can\'t find model type or ids')},_removeUser:function(a){var b=a.target.getAttribute('data-args');this.$.removeUserAjax.body={},'groups'==this.modelType&&this.groupId?(this.$.removeUserAjax.url='/api/'+this.modelType+'/'+this.groupId+'/'+b+'/remove_user',this.$.removeUserAjax.generateRequest()):'communities'==this.modelType&&this.communityId?(this.$.removeUserAjax.url='/api/'+this.modelType+'/'+this.communityId+'/'+b+'/remove_user',this.$.removeUserAjax.generateRequest()):console.warn('Can\'t find model type or ids')},_addAdmin:function(){this.$.addAdminAjax.body={},'groups'==this.modelType&&this.groupId?(this.$.addAdminAjax.url='/api/'+this.modelType+'/'+this.groupId+'/'+this.addAdminEmail+'/add_admin',this.$.addAdminAjax.generateRequest()):'communities'==this.modelType&&this.communityId?(this.$.addAdminAjax.url='/api/'+this.modelType+'/'+this.communityId+'/'+this.addAdminEmail+'/add_admin',this.$.addAdminAjax.generateRequest()):console.warn('Can\'t find model type or ids')},_inviteUser:function(){this.$.inviteUserAjax.body={},'groups'==this.modelType&&this.groupId?(this.$.inviteUserAjax.url='/api/'+this.modelType+'/'+this.groupId+'/'+this.inviteUserEmail+'/invite_user',this.$.inviteUserAjax.generateRequest()):'communities'==this.modelType&&this.communityId?(this.$.inviteUserAjax.url='/api/'+this.modelType+'/'+this.communityId+'/'+this.inviteUserEmail+'/invite_user',this.$.inviteUserAjax.generateRequest()):console.warn('Can\'t find model type or ids')},_removeAdminResponse:function(){window.appGlobals.notifyUserViaToast(this.t('users.adminRemoved')),this.$.ajax.generateRequest()},_removeUserResponse:function(){window.appGlobals.notifyUserViaToast(this.t('users.userRemoved')),this.$.ajax.generateRequest()},_addAdminResponse:function(){window.appGlobals.notifyUserViaToast(this.t('users.adminAdded')+' '+this.addAdminEmail),this.set('addAdminEmail',null),this.$.ajax.generateRequest()},_addOrganizationResponse:function(a,b){window.appGlobals.notifyUserViaToast(this.t('users.organizationUserAdded')+' '+b.response.email),this.$.ajax.generateRequest()},_removeOrganizationResponse:function(a,b){window.appGlobals.notifyUserViaToast(this.t('users.organizationUserRemoved')+' '+b.response.email),this.$.ajax.generateRequest()},_inviteUserResponse:function(){window.appGlobals.notifyUserViaToast(this.t('users.userInvited')+' '+this.inviteUserEmail),this.set('inviteUserEmail',null),this.$.ajax.generateRequest()},_domainIdChanged:function(a){a&&(this.set('modelType','domains'),this._generateRequest(a))},_groupIdChanged:function(a){a&&(this.set('modelType','groups'),this._generateRequest(a))},_communityIdChanged:function(a){a&&(this.set('modelType','communities'),this._generateRequest(a))},_generateRequest:function(a){var b=this.adminUsers?'admin_users':'users';this.$.ajax.url='/api/'+this.modelType+'/'+a+'/'+b,this.$.ajax.generateRequest()},_usersResponse:function(a,b){this.set('users',b.response)},setup:function(a,b,c,d){this.set('groupId',null),this.set('communityId',null),this.set('domainId',null),this.set('users',null),this.set('adminUsers',d),a&&this.set('groupId',a),b&&this.set('communityId',b),c&&this.set('domainId',c),this._setupHeaderText()},open:function(){this.set('opened',!0),this.$.dialog.open()},_setupHeaderText:function(){this.groupId?this.adminUsers?this.set('headerText',this.t('group.admins')):this.set('headerText',this.t('group.users')):this.communityId?this.adminUsers?this.set('headerText',this.t('community.admins')):this.set('headerText',this.t('community.users')):this.domainId&&(this.adminUsers?this.set('headerText',this.t('domain.admins')):this.set('headerText',this.t('domain.users')))},ready2:function(){},_adminActionRenderer:function(a){a.element.innerHTML='';var b=document.createElement('progress');b.setAttribute('value',a.data),a.element.appendChild(b)},_onSelect:function(){this.selected=0===this.$.grid.selection.selected().length?null:this.users[this.$.grid.selection.selected()]}});</script></dom-module><dom-module id="yp-pages-grid" assetpath="../yp-page/"><template><style include="iron-flex iron-flex-alignment">#dialog{width:90%;max-height:90%;background-color:#FFF;}iron-list{color:#000;height:500px;width:100%;}.pageItem{padding-right:16px;}.id{width:60px;}.title{width:200px;}.email{width:240px;}#editPageLocale{width:80%;max-height:80%;background-color:#FFF;}.locale{width:30px;cursor:pointer;}paper-textarea{height:60%;}.localeInput{width:26px;}.pageItem{padding-top:8px;}[hidden]{display:none !important;}</style><lite-signal on-lite-signal-yp-language="_languageEvent"></lite-signal><paper-dialog id="editPageLocale" modal="" class="layout vertical"><h2>[[t('page.editPageLocale')]]</h2><paper-dialog-scrollable><paper-input id="title" name="title" type="text" label="[[t('pages.title')]]" value="{{currentlyEditingTitle}}" maxlength="60" char-counter="" class="mainInput"></paper-input><paper-textarea id="content" name="content" value="{{currentlyEditingContent}}" label="[[t('pages.content')]]" rows="7" max-rows="10"></paper-textarea></paper-dialog-scrollable><div class="buttons"><paper-button on-tap="_closePageLocale" dialog-dismiss="">[[t('close')]]</paper-button><paper-button on-tap="_updatePageLocale" dialog-dismiss="">[[t('save')]]</paper-button></div></paper-dialog><paper-dialog id="dialog"><h2>[[headerText]]</h2><iron-list items="[[pages]]" as="page"><template><div class="layout horizontal"><div class="pageItem id">[[page.id]]</div><div class="pageItem title">[[page.title.en]]</div><template is="dom-repeat" items="[[_toLocaleArray(page.title)]]" class="pageItem"><div class="layout vertical center-center"><a class="locale" data-args-page$="[[page]]" data-args-locale$="[[item.locale]]" on-tap="_editPageLocale">[[item.locale]]</a></div></template><paper-input no-label-float="" class="localeInput" length="2" maxlength="2" value="{{newLocaleValue}}"></paper-input><paper-button data-args$="[[page.id]]" on-tap="_addLocale">[[t('pages.addLocale')]]</paper-button><div hidden$="[[page.published]]"><paper-button data-args$="[[page.id]]" on-tap="_publishPage">[[t('pages.publish')]]</paper-button></div><div hidden$="[[!page.published]]"><paper-button data-args$="[[page.id]]" on-tap="_unPublishPage">[[t('pages.unPublish')]]</paper-button></div><paper-button data-args$="[[page.id]]" on-tap="_deletePage">[[t('pages.deletePage')]]</paper-button></div></template></iron-list><div class="layout horizontal"><paper-button id="addPageButton" on-tap="_addPage">[[t('pages.addPage')]]</paper-button></div><div class="buttons"><paper-button dialog-dismiss="">[[t('close')]]</paper-button></div></paper-dialog><div class="layout horizontal center-center"><yp-ajax id="ajax" on-response="_pagesResponse"></yp-ajax><yp-ajax method="POST" id="newPageAjax" on-response="_newPageResponse"></yp-ajax><yp-ajax method="DELETE" id="deletePageAjax" on-response="_deletePageResponse"></yp-ajax><yp-ajax method="PUT" id="updatePageAjax" on-response="_updatePageResponse"></yp-ajax><yp-ajax method="PUT" id="publishPageAjax" on-response="_publishPageResponse"></yp-ajax><yp-ajax method="PUT" id="unPublishPageAjax" on-response="_unPublishPageResponse"></yp-ajax></div></template><script>Polymer({is:'yp-pages-grid',behaviors:[Polymer.appHelpers,Polymer.WordWrap],properties:{pages:{type:Array,notify:!0},headerText:{type:String},groupId:{type:Number,observer:'_groupIdChanged'},domainId:{type:Number,observer:'_domainIdChanged'},communityId:{type:Number,observer:'_communityIdChanged'},selected:{type:Object},modelType:{type:String},newLocaleValue:{type:String},currentlyEditingLocale:{type:String},currentlyEditingPage:{type:Object},currentlyEditingTitle:{type:String},currentlyEditingContent:{type:String}},_toLocaleArray:function(a){var b=Object.keys(a).map(function(b){return{locale:b,value:a[b]}});return __.sortBy(b,function(a){return a.item})},_editPageLocale:function(a){this.set('currentlyEditingPage',JSON.parse(a.target.getAttribute('data-args-page'))),this.set('currentlyEditingLocale',a.target.getAttribute('data-args-locale')),this.set('currentlyEditingContent',this.wordwrap(120)(this.currentlyEditingPage.content[this.currentlyEditingLocale])),this.set('currentlyEditingTitle',this.currentlyEditingPage.title[this.currentlyEditingLocale]),this.$.editPageLocale.open()},_closePageLocale:function(){this.set('currentlyEditingPage',null),this.set('currentlyEditingLocale',null),this.set('currentlyEditingContent',null),this.set('currentlyEditingTitle',null)},_dispatchAjax:function(a,b,c){var d;d=b?'/'+b+'/'+c:'/'+c,'groups'==this.modelType&&this.groupId?(a.url='/api/'+this.modelType+'/'+this.groupId+d,a.generateRequest()):'communities'==this.modelType&&this.communityId?(a.url='/api/'+this.modelType+'/'+this.communityId+d,a.generateRequest()):'domains'==this.modelType&&this.domainId?(a.url='/api/'+this.modelType+'/'+this.domainId+d,a.generateRequest()):console.warn('Can\'t find model type or ids')},_updatePageLocale:function(){this.$.updatePageAjax.body={locale:this.currentlyEditingLocale,content:this.currentlyEditingContent,title:this.currentlyEditingTitle},this._dispatchAjax(this.$.updatePageAjax,this.currentlyEditingPage.id,'update_page_locale'),this._closePageLocale()},_publishPage:function(){this.$.updatePageAjax.body={};var a=event.target.getAttribute('data-args');this._dispatchAjax(this.$.updatePageAjax,a,'publish_page')},_publishPageResponse:function(){window.appGlobals.notifyUserViaToast(this.t('pages.pagePublished')),this.$.ajax.generateRequest()},_unPublishPage:function(){this.$.updatePageAjax.body={};var a=event.target.getAttribute('data-args');this._dispatchAjax(this.$.updatePageAjax,a,'un_publish_page')},_unPublishPageResponse:function(){window.appGlobals.notifyUserViaToast(this.t('pages.pageUnPublished')),this.$.ajax.generateRequest()},_deletePage:function(){this.$.deletePageAjax.body={};var a=event.target.getAttribute('data-args');this._dispatchAjax(this.$.deletePageAjax,a,'delete_page')},_deletePageResponse:function(){window.appGlobals.notifyUserViaToast(this.t('pages.pageDeleted')),this.$.ajax.generateRequest()},_addLocale:function(a){if(this.newLocaleValue&&1<this.newLocaleValue.length){var b=a.target.getAttribute('data-args');this.$.updatePageAjax.body={locale:this.newLocaleValue.toLowerCase(),content:'',title:''},this._dispatchAjax(this.$.updatePageAjax,b,'update_page_locale'),this.set('newLocaleValue',null)}},_addPage:function(){this.$.newPageAjax.body={},this.$.addPageButton.disabled=!0,this._dispatchAjax(this.$.newPageAjax,null,'add_page')},_newPageResponse:function(){window.appGlobals.notifyUserViaToast(this.t('pages.newPageCreated')),this.$.ajax.generateRequest(),this.$.addPageButton.disabled=!1},_updatePageResponse:function(){window.appGlobals.notifyUserViaToast(this.t('posts.updated')),this.$.ajax.generateRequest()},_domainIdChanged:function(a){a&&(this.set('modelType','domains'),this._generateRequest(a))},_groupIdChanged:function(a){a&&(this.set('modelType','groups'),this._generateRequest(a))},_communityIdChanged:function(a){a&&(this.set('modelType','communities'),this._generateRequest(a))},_generateRequest:function(a){this.$.ajax.url='/api/'+this.modelType+'/'+a+'/pages_for_admin',this.$.ajax.generateRequest()},_pagesResponse:function(a,b){this.set('pages',b.response)},setup:function(a,b,c){this.set('groupId',null),this.set('communityId',null),this.set('domainId',null),this.set('pages',null),a&&this.set('groupId',a),b&&this.set('communityId',b),c&&this.set('domainId',c),this._setupHeaderText()},open:function(){this.$.dialog.open()},_setupHeaderText:function(){this.groupId?this.set('headerText',this.t('group.pages')):this.communityId?this.set('headerText',this.t('community.pages')):this.domainId&&this.set('headerText',this.t('domain.pages'))}});</script></dom-module><dom-module id="yp-organization-edit" assetpath="../yp-organization/"><template><style include="iron-flex iron-flex-alignment">.access{@apply (--layout-horizontal);@apply (--layout-center-justified);}.accessHeader{color:var(--primary-color,#777);font-weight:normal;margin-bottom:0;}paper-radio-button{display:block;}.additionalSettings{padding-top:16px;}.half{width:50%;}</style><lite-signal on-lite-signal-yp-language="_languageEvent"></lite-signal><yp-edit-dialog id="editDialog" title="[[editHeaderText]]" icon="business-center" action="[[action]]" method="[[method]]" params="[[params]]" save-text="[[saveText]]" toast-text="[[toastText]]"><h2 slot="h2">[[editHeaderText]]</h2><div class="layout vertical"><paper-input id="name" name="name" type="text" label="[[t('name')]]" value="{{organization.name}}" maxlength="60" char-counter="" class="mainInput"></paper-input><paper-textarea id="description" name="description" value="{{organization.description}}" label="[[t('description')]]" char-counter="" rows="2" max-rows="5" maxlength="300" class="mainInput"></paper-textarea><paper-input id="website" name="website" type="text" label="[[t('website')]]" value="{{organization.website}}" maxlength="256" char-counter="" class="mainInput"></paper-input></div><div class="layout horizontal"><div class="layout vertical additionalSettings half"><yp-file-upload id="logoImageUpload" raised="true" multi="false" target="/api/images?itemType=organization-logo" method="POST" on-success="_logoImageUploaded"><iron-icon class="icon" icon="photo-camera"></iron-icon><span>[[t('image.logo.upload')]]</span></yp-file-upload></div><div class="layout vertical additionalSettings half"><yp-file-upload id="headerImageUpload" raised="true" multi="false" target="/api/images?itemType=organization-header" method="POST" on-success="_headerImageUploaded"><iron-icon class="icon" icon="photo-camera"></iron-icon><span>[[t('image.header.upload')]]</span></yp-file-upload></div></div><input type="hidden" name="uploadedLogoImageId" value="[[uploadedLogoImageId]]"> <input type="hidden" name="uploadedHeaderImageId" value="[[uploadedHeaderImageId]]"><h3 class="accessHeader">[[t('Access')]]</h3><paper-radio-group id="access" name="access" class="access" selected="{{organizationAccess}}"><paper-radio-button name="public">[[t('public')]]</paper-radio-button><paper-radio-button name="closed">[[t('closed')]]</paper-radio-button><paper-radio-button name="secret">[[t('secret')]]</paper-radio-button></paper-radio-group></yp-edit-dialog></template></dom-module><script>Polymer({is:"yp-organization-edit",behaviors:[Polymer.appHelpers,Polymer.ypEditDialogBehavior],properties:{action:{type:String,value:"/api/organizations"},organization:{type:Object,observer:"_organizationChanged"},organizationAccess:{type:String,value:"public"},params:{type:String},method:{type:String},uploadedLogoImageId:{type:String},uploadedHeaderImageId:{type:String}},_customRedirect:function(a){a||console.warn("No organization found on custom redirect")},_organizationChanged:function(){0===this.organization.access?this.organizationAccess="public":1===this.organization.access?this.organizationAccess="closed":2===this.organization.access&&(this.organizationAccess="secret")},_clear:function(){this.set("organization",{name:"",description:"",access:0}),this.set("uploadedLogoImageId",null),this.set("uploadedHeaderImageId",null),this.$.headerImageUpload.clear(),this.$.logoImageUpload.clear()},setup:function(a,b,c){a?this.set("organization",a):this.set("organization",{name:"",description:"",access:0}),this.set("new",b),this.set("refreshFunction",c),this._setupTranslation()},_setupTranslation:function(){this.new?(this.set("editHeaderText",this.t("organization.new")),this.set("toastText",this.t("organization.toast.created")),this.set("saveText",this.t("create"))):(this.set("editHeaderText",this.t("Update organization info")),this.set("toastText",this.t("organization.toast.updated")),this.set("saveText",this.t("update")))}});</script><dom-module id="yp-organizations-grid" assetpath="../yp-organization/"><template><style include="iron-flex iron-flex-alignment">#dialog{width:90%;max-height:90%;background-color:#FFF;}iron-list{color:#000;height:500px;width:100%;}.pageItem{padding-right:16px;}.id{width:60px;}.title{width:200px;}.email{width:240px;}#editPageLocale{width:80%;max-height:80%;background-color:#FFF;}.locale{width:30px;cursor:pointer;}paper-textarea{height:60%;}.localeInput{width:26px;}.pageItem{padding-top:8px;}[hidden]{display:none !important;}</style><lite-signal on-lite-signal-yp-language="_languageEvent"></lite-signal><paper-dialog id="selectOrganizationDialog" modal=""><h2>[[t('users.selectOrganization')]]</h2><paper-dialog-scrollable><paper-listbox><template is="dom-repeat" items="[[availableOrganizations]]"><paper-item on-tap="_selectOrganization" id="[[item.id]]">[[item.name]]</paper-item></template></paper-listbox></paper-dialog-scrollable><div class="buttons"><paper-button dialog-dismiss="">[[t('Close')]]</paper-button></div></paper-dialog><paper-dialog id="dialog"><h2>[[headerText]]</h2><paper-dialog-scrollable><iron-list items="[[availableOrganizations]]" as="organization"><template><div class="layout horizontal"><div class="pageItem id">[[organization.name]]</div><div class="pageItem title">[[_organizationImageUrl(organization)]]</div><paper-button data-args$="[[organization]]" on-tap="_editOrganization">[[t('update')]]</paper-button></div></template></iron-list><iron-list items="[[users]]" as="user"><template><div class="layout horizontal"><div class="userItem id">[[user.id]]</div><div class="userItem name">[[user.name]]</div><div class="userItem email">[[user.email]]</div><template is="dom-if" if="[[!_userOrganizationName(user)]]"><div class="organization"><paper-button data-args$="[[user.id]]" on-tap="_addToOrganization">[[t('users.addToOrganization')]]</paper-button></div></template><div class="organization" hidden$="[[!_userOrganizationName(user)]]"><div class="organizationName">[[_userOrganizationName(user)]]</div><paper-button data-args$="[[user.id]]" data-args-org$="[[_userOrganizationId(user)]]" on-tap="_removeFromOrganization">[[t('users.removeFromOrganization')]]</paper-button></div></div></template></iron-list></paper-dialog-scrollable><div class="buttons"><paper-button dialog-dismiss="">[[t('close')]]</paper-button></div></paper-dialog><div class="layout horizontal center-center"><yp-ajax method="DELETE" id="removeOrganizationAjax" on-response="_removeOrganizationResponse"></yp-ajax><yp-ajax method="POST" id="addOrganizationAjax" on-response="_addOrganizationResponse"></yp-ajax></div></template><script>Polymer({is:'yp-organizations-grid',behaviors:[Polymer.appHelpers,Polymer.WordWrap],properties:{organizations:{type:Array,notify:!0},availableOrganizations:{type:Array},headerText:{type:String},selected:{type:Object}},_newOrganization:function(){Polymer.dom(document).querySelector('yp-app').getDialogAsync('organizationEdit',function(a){a.setup(null,!0,null),a.open('new',{})}.bind(this))},_editOrganization:function(a){var b=JSON.parse(a.target.getAttribute('data-args'));Polymer.dom(document).querySelector('yp-app').getDialogAsync('organizationEdit',function(a){a._clear(),a.setup(b,!1,null),a.open('edit',{organizationId:b.id})}.bind(this))},_organizationImageUrl:function(a){return a.OrganizationLogoImages?this.getImageFormatUrl(a.OrganizationLogoImages,2):null},_availableOrganizations:function(){return window.appUser.adminRights&&window.appUser.adminRights.OrganizationAdmins?window.appUser.adminRights.OrganizationAdmins:[]},_addToOrganization:function(a){this.set('userIdForSelectingOrganization',a.target.getAttribute('data-args')),this.$.selectOrganizationDialog.open()},_removeFromOrganization:function(a){var b=a.target.getAttribute('data-args'),c=a.target.getAttribute('data-args-org');this.$.removeOrganizationAjax.body={},this.$.removeOrganizationAjax.url='/api/organizations/'+c+'/'+b+'/remove_user',this.$.removeOrganizationAjax.generateRequest()},_selectOrganization:function(a){this.$.addOrganizationAjax.body={},this.$.addOrganizationAjax.url='/api/organizations/'+a.target.id+'/'+this.userIdForSelectingOrganization+'/add_user',this.$.addOrganizationAjax.generateRequest(),this.$.selectOrganizationDialog.close()},_addOrganizationResponse:function(a,b){window.appGlobals.notifyUserViaToast(this.t('users.organizationUserAdded')+' '+b.response.email),this.$.ajax.generateRequest()},_removeOrganizationResponse:function(a,b){window.appGlobals.notifyUserViaToast(this.t('users.organizationUserRemoved')+' '+b.response.email),this.$.ajax.generateRequest()},open:function(){this.set('availableOrganizations',this._availableOrganizations()),this.$.dialog.open()}});</script></dom-module><dom-module id="paper-checkbox" assetpath="../../bower_components/paper-checkbox/"><template strip-whitespace=""><style>:host{display:inline-block;white-space:nowrap;cursor:pointer;--calculated-paper-checkbox-size:var(--paper-checkbox-size, 18px);--calculated-paper-checkbox-ink-size:var(--paper-checkbox-ink-size, -1px);@apply --paper-font-common-base;line-height:0;-webkit-tap-highlight-color:transparent;}:host([hidden]){display:none !important;}:host(:focus){outline:none;}.hidden{display:none;}#checkboxContainer{display:inline-block;position:relative;width:var(--calculated-paper-checkbox-size);height:var(--calculated-paper-checkbox-size);min-width:var(--calculated-paper-checkbox-size);margin:var(--paper-checkbox-margin, initial);vertical-align:var(--paper-checkbox-vertical-align, middle);background-color:var(--paper-checkbox-unchecked-background-color, transparent);}#ink{position:absolute;top:calc(0px - (var(--calculated-paper-checkbox-ink-size) - var(--calculated-paper-checkbox-size)) / 2);left:calc(0px - (var(--calculated-paper-checkbox-ink-size) - var(--calculated-paper-checkbox-size)) / 2);width:var(--calculated-paper-checkbox-ink-size);height:var(--calculated-paper-checkbox-ink-size);color:var(--paper-checkbox-unchecked-ink-color, var(--primary-text-color));opacity:0.6;pointer-events:none;}:host-context([dir="rtl"]) #ink{right:calc(0px - (var(--calculated-paper-checkbox-ink-size) - var(--calculated-paper-checkbox-size)) / 2);left:auto;}#ink[checked]{color:var(--paper-checkbox-checked-ink-color, var(--primary-color));}#checkbox{position:relative;box-sizing:border-box;height:100%;border:solid 2px;border-color:var(--paper-checkbox-unchecked-color, var(--primary-text-color));border-radius:2px;pointer-events:none;-webkit-transition:background-color 140ms, border-color 140ms;transition:background-color 140ms, border-color 140ms;}#checkbox.checked #checkmark{-webkit-animation:checkmark-expand 140ms ease-out forwards;animation:checkmark-expand 140ms ease-out forwards;}@-webkit-keyframes checkmark-expand{0%{-webkit-transform:scale(0, 0) rotate(45deg);}100%{-webkit-transform:scale(1, 1) rotate(45deg);}}@keyframes checkmark-expand{0%{transform:scale(0, 0) rotate(45deg);}100%{transform:scale(1, 1) rotate(45deg);}}#checkbox.checked{background-color:var(--paper-checkbox-checked-color, var(--primary-color));border-color:var(--paper-checkbox-checked-color, var(--primary-color));}#checkmark{position:absolute;width:36%;height:70%;border-style:solid;border-top:none;border-left:none;border-right-width:calc(2/15 * var(--calculated-paper-checkbox-size));border-bottom-width:calc(2/15 * var(--calculated-paper-checkbox-size));border-color:var(--paper-checkbox-checkmark-color, white);-webkit-transform-origin:97% 86%;transform-origin:97% 86%;box-sizing:content-box;}:host-context([dir="rtl"]) #checkmark{-webkit-transform-origin:50% 14%;transform-origin:50% 14%;}#checkboxLabel{position:relative;display:inline-block;vertical-align:middle;padding-left:var(--paper-checkbox-label-spacing, 8px);white-space:normal;line-height:normal;color:var(--paper-checkbox-label-color, var(--primary-text-color));@apply --paper-checkbox-label;}:host([checked]) #checkboxLabel{color:var(--paper-checkbox-label-checked-color, var(--paper-checkbox-label-color, var(--primary-text-color)));@apply --paper-checkbox-label-checked;}:host-context([dir="rtl"]) #checkboxLabel{padding-right:var(--paper-checkbox-label-spacing, 8px);padding-left:0;}#checkboxLabel[hidden]{display:none;}:host([disabled]) #checkbox{opacity:0.5;border-color:var(--paper-checkbox-unchecked-color, var(--primary-text-color));}:host([disabled][checked]) #checkbox{background-color:var(--paper-checkbox-unchecked-color, var(--primary-text-color));opacity:0.5;}:host([disabled]) #checkboxLabel{opacity:0.65;}#checkbox.invalid:not(.checked){border-color:var(--paper-checkbox-error-color, var(--error-color));}</style><div id="checkboxContainer"><div id="checkbox" class$="[[_computeCheckboxClass(checked, invalid)]]"><div id="checkmark" class$="[[_computeCheckmarkClass(checked)]]"></div></div></div><div id="checkboxLabel"><slot></slot></div></template><script>Polymer({is:'paper-checkbox',behaviors:[Polymer.PaperCheckedElementBehavior],hostAttributes:{role:'checkbox',"aria-checked":!1,tabindex:0},properties:{ariaActiveAttribute:{type:String,value:'aria-checked'}},attached:function(){Polymer.RenderStatus.afterNextRender(this,function(){var a=this.getComputedStyleValue('--calculated-paper-checkbox-ink-size').trim();if('-1px'===a){var b=this.getComputedStyleValue('--calculated-paper-checkbox-size').trim(),c=b.match(/[A-Za-z]+$/)[0]||'px',d=parseFloat(b,10),e=8/3*d;'px'===c&&(e=Math.floor(e),e%2!==d%2&&e++),this.updateStyles({"--paper-checkbox-ink-size":e+c})}})},_computeCheckboxClass:function(a,b){var c='';return a&&(c+='checked '),b&&(c+='invalid'),c},_computeCheckmarkClass:function(a){return a?'':'hidden'},_createRipple:function(){return this._rippleContainer=this.$.checkboxContainer,Polymer.PaperInkyFocusBehaviorImpl._createRipple.call(this)}});</script></dom-module><dom-module id="yp-theme-selector" assetpath="../yp-theme/"><template><style include="iron-flex iron-flex-alignment">paper-dropdown-menu{max-width:250px;width:250px;}</style><lite-signal on-lite-signal-yp-language="_languageEvent"></lite-signal><paper-dropdown-menu label="[[t('theme.choose')]]"><paper-listbox slot="dropdown-content" selected="{{selectedTheme}}"><template is="dom-repeat" items="[[themes]]" as="theme"><paper-item name="[[index]]">[[theme.name]]</paper-item></template></paper-listbox></paper-dropdown-menu></template><script>Polymer({is:'yp-theme-selector',behaviors:[Polymer.appHelpers,Polymer.ypThemeBehavior],properties:{selectedTheme:{type:Number,value:null,notify:!0,observer:'_selectedThemeChanged'},object:{type:Object,observer:'_objectChanged'}},_objectChanged:function(a){a&&null!=a.theme_id&&this.set('selectedTheme',a.theme_id)},_selectedThemeChanged:function(a){a&&this.setTheme(a)}});</script></dom-module><dom-module id="yp-domain-edit" assetpath="../yp-domain/"><template><style include="iron-flex iron-flex-alignment">.additionalSettings{padding-top:8px;margin-top:8px;}yp-theme-selector{padding-top:8px;margin-bottom:8px;}.imageSizeInfo{font-size:13px;}.sectionMargin{margin-top:8px;}.container{width:100%;height:100%;min-height:300px;}</style><lite-signal on-lite-signal-yp-language="_languageEvent"></lite-signal><yp-edit-dialog double-width="" id="editDialog" title="[[editHeaderText]]" icon="cloud-queue" action="[[action]]" method="[[method]]" params="[[params]]" save-text="[[saveText]]" toast-text="[[toastText]]"><paper-tabs selected="{{selected}}" id="paper_tabs" focused=""><paper-tab><span>[[t('domain.info')]]</span></paper-tab><paper-tab>[[t('domain.settings')]]</paper-tab><paper-tab>[[t('domain.apis')]]</paper-tab></paper-tabs><div class="layout vertical wrap container"><neon-animated-pages id="pages" class="layout horizontal flex" selected="[[selected]]"><section><paper-input id="name" name="name" type="text" label="[[t('Name')]]" value="{{domain.name}}" maxlength="60" char-counter="" class="mainInput"></paper-input><paper-textarea id="description" name="description" value="{{domain.description}}" label="[[t('Description')]]" char-counter="" rows="2" max-rows="5" maxlength="300" class="mainInput"></paper-textarea><div class="horizontal end-justified layout"><emoji-selector id="emojiSelectorDescription"></emoji-selector></div><div class="layout vertical"><yp-theme-selector object="[[domain]]" selected-theme="{{themeId}}"></yp-theme-selector></div><div class="layout vertical additionalSettings"><yp-file-upload id="logoImageUpload" raised="true" multi="false" target="/api/images?itemType=domain-logo" method="POST" on-success="_logoImageUploaded"><iron-icon class="icon" icon="photo-camera"></iron-icon><span>[[t('image.logo.upload')]]</span><br><span class="imageSizeInfo">864 x 486</span></yp-file-upload></div><div class="layout vertical additionalSettings"><yp-file-upload id="headerImageUpload" raised="true" multi="false" target="/api/images?itemType=domain-header" method="POST" on-success="_headerImageUploaded"><iron-icon class="icon" icon="photo-camera"></iron-icon><span>[[t('image.header.upload')]]</span><br><span class="imageSizeInfo">1920 x 600</span></yp-file-upload></div><paper-input id="customUserRegistrationText" name="customUserRegistrationText" type="text" label="[[t('customUserRegistrationText')]]" value="{{domain.configuration.customUserRegistrationText}}" maxlength="256" char-counter=""></paper-input><input type="hidden" name="themeId" value="[[themeId]]"> <input type="hidden" name="uploadedLogoImageId" value="[[uploadedLogoImageId]]"> <input type="hidden" name="uploadedHeaderImageId" value="[[uploadedHeaderImageId]]"></section><section class="sectionMargin"><paper-checkbox name="onlyAdminsCanCreateCommunities" checked$="{{domain.only_admins_can_create_communities}}">[[t('domain.onlyAdminsCanCreateCommunities')]]</paper-checkbox><paper-checkbox name="downloadFacebookImagesForUser" checked$="{{domain.configuration.downloadFacebookImagesForUser}}">[[t('downloadFacebookImagesForUser')]]</paper-checkbox><yp-language-selector name="defaultLocale" no-user-events="" selected-locale="{{domain.default_locale}}"></yp-language-selector></section><section><paper-input id="facebookClientId" name="facebookClientId" type="text" label="Facebook Client Id" value="{{domain.secret_api_keys.facebook.client_id}}" maxlength="60" char-counter="" class="mainInput"></paper-input><paper-input id="facebookClientSecret" name="facebookClientSecret" type="text" label="Facebook Client Secret" value="{{domain.secret_api_keys.facebook.client_secret}}" maxlength="60" char-counter="" class="mainInput"></paper-input><paper-input id="googleClientId" name="googleClientId" type="text" label="Google Client Id" value="{{domain.secret_api_keys.google.client_id}}" maxlength="60" char-counter="" class="mainInput"></paper-input><paper-input id="googleClientSecret" name="googleClientSecret" type="text" label="Google Client Secret" value="{{domain.secret_api_keys.google.client_secret}}" maxlength="60" char-counter="" class="mainInput"></paper-input><paper-input id="samlEntryPoint" name="samlEntryPoint" type="text" label="SAML EntryPoint" value="{{domain.secret_api_keys.saml.entryPoint}}" maxlength="100" char-counter="" class="mainInput"></paper-input><paper-input id="samlCallbackUrl" name="samlCallbackUrl" type="text" label="SAML CallbackUrl" value="{{domain.secret_api_keys.saml.callbackUrl}}" maxlength="100" char-counter="" class="mainInput"></paper-input><paper-textarea id="samlCert" name="samlCert" value="{{domain.secret_api_keys.saml.cert}}" label="SAML Verification Certificate Chain" char-counter="" rows="2" max-rows="5" maxlength="20000" class="mainInput"></paper-textarea></section></neon-animated-pages></div></yp-edit-dialog></template></dom-module><script>Polymer({is:'yp-domain-edit',behaviors:[Polymer.appHelpers,Polymer.ypEditDialogBehavior],properties:{action:{type:String,value:'/api/domains'},domain:{type:Object,observer:'_domainChanged',notify:!0},params:{type:String},selected:{type:Number,value:0},method:{type:String},uploadedLogoImageId:{type:String},uploadedHeaderImageId:{type:String},themeId:{type:String,value:null},status:{type:String}},observers:['_setupTranslation(language,t)'],_updateEmojiBindings:function(){this.async(function(){var a=this.$$('#description'),b=this.$$('#emojiSelectorDescription');a&&b?b.inputTarget=a:console.warn('Domain edit: Can\'t bind emojis :(')}.bind(this),500)},_domainChanged:function(){this._updateEmojiBindings()},_customRedirect:function(a){this.new&&this.redirectTo('/domain/'+a.id)},_clear:function(){this.set('domain',{name:'',description:''}),this.set('uploadedLogoImageId',null),this.set('uploadedHeaderImageId',null),this.$.headerImageUpload.clear(),this.$.logoImageUpload.clear()},setup:function(a,b,c){this.set('domain',a),this.set('new',b),this.set('refreshFunction',c),this._setupTranslation()},_setupTranslation:function(){this.new?(this.editHeaderText=this.t('domain.new'),this.toastText=this.t('domainToastCreated'),this.set('saveText',this.t('create'))):(this.set('saveText',this.t('save')),this.editHeaderText=this.t('domain.edit'),this.toastText=this.t('domainToastUpdated'))}});</script><script>Polymer.ypCollectionStatusOptions={properties:{collectionStatusOptions:{type:Object,computed:'_collectionStatusOptions(language)'}},_collectionStatusOptions:function(a){return a?[{name:'active',translatedName:this.t('status.active')},{name:'featured',translatedName:this.t('status.featured')},{name:'archived',translatedName:this.t('status.archived')},{name:'hidden',translatedName:this.t('status.hidden')}]:[]}};</script><dom-module id="yp-community-edit" assetpath="../yp-community/"><template><style include="iron-flex iron-flex-alignment">.access{@apply (--layout-horizontal);@apply (--layout-center-justified);}.accessHeader{color:var(--primary-color,#777);font-weight:normal;margin-bottom:0px;}paper-radio-button{display:block;}.additionalSettings{padding-top:16px;}.half{width:50%;}.hostnameInfo{color:#888;}.config{margin-top:16px;}paper-checkbox{margin-bottom:4px;}</style><lite-signal on-lite-signal-yp-language="_languageEvent"></lite-signal><yp-edit-dialog id="editDialog" title="[[editHeaderText]]" icon="group-work" action="[[action]]" method="[[method]]" params="[[params]]" save-text="[[saveText]]" toast-text="[[toastText]]"><div class="layout vertical"><paper-input id="name" name="name" type="text" label="[[t('name')]]" value="{{community.name}}" maxlength="60" minlength="1" required="" char-counter="" class="mainInput"></paper-input><paper-input id="hostname" name="hostname" type="text" allowed-pattern="[a-z0-9-]" label="[[t('community.hostname')]]" value="{{community.hostname}}" maxlength="80" minlength="1" required="" char-counter="" class="mainInput"></paper-input><div class="hostnameInfo">https://[[hostnameExample]]</div><paper-textarea id="description" name="description" value="{{community.description}}" label="[[t('description')]]" char-counter="" rows="2" max-rows="5" minlength="1" required="" maxlength="300" class="mainInput"></paper-textarea><div class="horizontal end-justified layout"><emoji-selector id="emojiSelectorDescription"></emoji-selector></div></div><div class="layout horizontal"><div class="layout vertical additionalSettings half"><yp-file-upload id="logoImageUpload" raised="true" multi="false" target="/api/images?itemType=community-logo" method="POST" on-success="_logoImageUploaded"><iron-icon class="icon" icon="photo-camera"></iron-icon><span>[[t('image.logo.upload')]]</span></yp-file-upload></div><div class="layout vertical additionalSettings half"><yp-file-upload id="headerImageUpload" raised="true" multi="false" target="/api/images?itemType=community-header" method="POST" on-success="_headerImageUploaded"><iron-icon class="icon" icon="photo-camera"></iron-icon><span>[[t('image.header.upload')]]</span></yp-file-upload></div></div><yp-theme-selector object="[[community]]" selected-theme="{{themeId}}"></yp-theme-selector><div class="layout vertical config"><paper-checkbox name="onlyAdminsCanCreateGroups" checked$="{{community.only_admins_can_create_groups}}">[[t('community.onlyAdminsCanCreateGroups')]]</paper-checkbox><paper-checkbox name="alternativeHeader" checked$="{{community.configuration.alternativeHeader}}">[[t('community.alternativeHeader')]]</paper-checkbox><paper-checkbox name="disableDomainUpLink" checked$="{{community.configuration.disableDomainUpLink}}">[[t('disableCommunityDomainUpLink')]]</paper-checkbox></div><input type="hidden" name="themeId" value="[[themeId]]"> <input type="hidden" name="uploadedLogoImageId" value="[[uploadedLogoImageId]]"> <input type="hidden" name="uploadedHeaderImageId" value="[[uploadedHeaderImageId]]"><div class="layout horizontal config"><paper-dropdown-menu label="[[t('status.select')]]"><paper-listbox slot="dropdown-content" attr-for-selected="name" selected="{{status}}"><template is="dom-repeat" items="[[collectionStatusOptions]]" as="statusOption"><paper-item name="[[statusOption.name]]">[[statusOption.translatedName]]</paper-item></template></paper-listbox></paper-dropdown-menu><input type="hidden" name="status" value="[[status]]"></div><yp-language-selector name="defaultLocale" no-user-events="" selected-locale="{{community.default_locale}}"></yp-language-selector><paper-input id="google_analytics_code" name="google_analytics_code" type="text" label="[[t('analyticsTrackerCode')]]" value="{{community.google_analytics_code}}" maxlength="40" style="width: 200px;"></paper-input><paper-input id="facebookPixelId" name="facebookPixelId" type="text" label="[[t('facebookPixelId')]]" value="{{community.configuration.facebookPixelId}}" maxlength="40" style="width: 200px;"></paper-input><paper-input id="defaultLocationLongLat" name="defaultLocationLongLat" type="text" label="[[t('defaultLocationLongLat')]]" value="{{community.defaultLocationLongLat}}" maxlength="100" style="width: 300px;"></paper-input><h3 class="accessHeader">[[t('access')]]</h3><paper-radio-group id="access" name="access" class="access" selected="{{communityAccess}}"><paper-radio-button name="public">[[t('public')]]</paper-radio-button><paper-radio-button name="closed">[[t('closed')]]</paper-radio-button><paper-radio-button name="secret">[[t('secret')]]</paper-radio-button></paper-radio-group><paper-textarea id="welcomeHTML" name="welcomeHTML" value="{{community.configuration.welcomeHTML}}" label="[[t('welcomeHTML')]]" rows="2" max-rows="5" minlength="1" class="mainInput"></paper-textarea></yp-edit-dialog></template></dom-module><script>Polymer({is:"yp-community-edit",behaviors:[Polymer.appHelpers,Polymer.ypEditDialogBehavior,Polymer.ypCollectionStatusOptions],properties:{action:{type:String,value:"/api/communities"},community:{type:Object,observer:"_communityChanged"},hostnameExample:{type:String,computed:"_getExampleHostname(community.hostname)"},communityAccess:{type:String,value:"public"},params:{type:String},method:{type:String},uploadedLogoImageId:{type:String},uploadedHeaderImageId:{type:String},status:String,themeId:{type:String,value:null}},observers:["_setupTranslation(language,t)"],_updateEmojiBindings:function(){this.async(function(){var a=this.$$("#description"),b=this.$$("#emojiSelectorDescription");a&&b?b.inputTarget=a:console.warn("Community edit: Can't bind emojis :(")}.bind(this),500)},_getExampleHostname:function(a){return a?a+"."+window.appGlobals.domain.domain_name:"your-hostname."+window.appGlobals.domain.domain_name},_customRedirect:function(a){if(a&&a.hostnameTaken){var b=Polymer.dom(document).querySelector("yp-app").getDialog("errorDialog");b.showErrorDialog(this.t("hostnameTaken"))}else a?(window.appUser.recheckAdminRights(),this.redirectTo("/community/"+a.id)):console.warn("No community found on custom redirect")},_communityChanged:function(a){a&&(0===this.community.access?this.communityAccess="public":1===this.community.access?this.communityAccess="closed":2===this.community.access&&(this.communityAccess="secret"),this.community.status&&this.set("status",this.community.status)),this._updateEmojiBindings()},_clear:function(){this.set("community",{name:"",description:"",access:0}),this.set("uploadedLogoImageId",null),this.set("uploadedHeaderImageId",null),this.$.headerImageUpload.clear(),this.$.logoImageUpload.clear()},setup:function(a,b,c){a?this.set("community",a):this.set("community",{name:"",description:"",access:0,status:"active"}),this.set("new",b),this.set("refreshFunction",c),this._setupTranslation()},_setupTranslation:function(){this.t&&(this.new?(this.set("editHeaderText",this.t("community.new")),this.set("toastText",this.t("communityToastCreated")),this.set("saveText",this.t("create"))):(this.set("saveText",this.t("save")),this.set("editHeaderText",this.t("Update community info")),this.set("toastText",this.t("communityToastUpdated"))))}});</script><dom-module id="yp-group-edit" assetpath="../yp-group/"><template><style include="iron-flex iron-flex-alignment">.access{@apply (--layout-horizontal);@apply (--layout-center-justified);}.accessHeader{color:var(--primary-color,#777);font-weight:normal;margin-bottom:0;}paper-radio-button{display:block;}.additionalSettings{padding-top:8px;}yp-file-upload{}.half{width:50%;}.config{padding:8px;vertical-align:top;}paper-checkbox{padding-top:8px;}.icon{padding-right:8px;}paper-dropdown-menu{max-width:250px;width:250px;}.categoryName{padding-left:8px;}[hidden]{display:none !important;}</style><lite-signal on-lite-signal-yp-language="_languageEvent"></lite-signal><yp-edit-dialog id="editDialog" title="[[editHeaderText]]" icon="people" action="[[action]]" method="[[method]]" params="[[params]]" save-text="[[saveText]]" toast-text="[[toastText]]"><paper-input id="name" name="name" type="text" label="[[t('name')]]" value="{{group.name}}" maxlength="50" char-counter=""></paper-input><paper-textarea id="objectives" name="objectives" value="{{group.objectives}}" label="[[t('group.objectives')]]" char-counter="" rows="2" max-rows="5" maxlength="300"></paper-textarea><div class="horizontal end-justified layout"><emoji-selector id="emojiSelectorDescription"></emoji-selector></div><div class="layout horizontal"><div class="layout vertical additionalSettings"><yp-file-upload id="logoImageUpload" raised="true" multi="false" target="/api/images?itemType=group-logo" method="POST" on-success="_logoImageUploaded"><iron-icon class="icon" icon="photo-camera"></iron-icon><span>[[t('image.logo.upload')]]</span></yp-file-upload></div><div class="layout vertical additionalSettings"><yp-file-upload id="headerImageUpload" raised="true" multi="false" target="/api/images?itemType=group-header" method="POST" on-success="_headerImageUploaded"><iron-icon class="icon" icon="photo-camera"></iron-icon><span>[[t('image.header.upload')]]</span></yp-file-upload></div><input type="hidden" name="uploadedLogoImageId" value="[[uploadedLogoImageId]]"> <input type="hidden" name="uploadedHeaderImageId" value="[[uploadedHeaderImageId]]"></div><div class="layout vertical"><div class="layout vertica config"><yp-theme-selector object="[[group]]" selected-theme="{{themeId}}"></yp-theme-selector><div class="layout vertical"><paper-dropdown-menu label="[[t('status.select')]]"><paper-listbox slot="dropdown-content" attr-for-selected="name" selected="{{status}}"><template is="dom-repeat" items="[[collectionStatusOptions]]" as="statusOption"><paper-item name="[[statusOption.name]]">[[statusOption.translatedName]]</paper-item></template></paper-listbox></paper-dropdown-menu><input type="hidden" name="status" value="[[status]]"><div class="layout horizontal"><paper-dropdown-menu label="[[t('endorsementButtons')]]"><paper-listbox slot="dropdown-content" attr-for-selected="name" selected="{{endorsementButtons}}"><template is="dom-repeat" items="[[endorsementButtonsOptions]]" as="buttonsSelection"><paper-item name="[[buttonsSelection.name]]">[[buttonsSelection.translatedName]]</paper-item></template></paper-listbox></paper-dropdown-menu><input type="hidden" name="endorsementButtons" value="[[endorsementButtons]]"></div></div></div><div class="layout vertical config"><paper-checkbox name="canVote" checked$="{{canVote}}">[[t('group.canVote')]]</paper-checkbox><paper-checkbox name="canAddNewPosts" checked$="{{canAddNewPosts}}">[[t('group.canAddNewPosts')]]</paper-checkbox><paper-checkbox name="disableDebate" checked$="{{group.configuration.disableDebate}}">[[t('disableDebate')]]</paper-checkbox><paper-checkbox name="locationHidden" checked$="{{locationHidden}}">[[t('group.locationHidden')]]</paper-checkbox><paper-checkbox name="showWhoPostedPosts" checked$="{{showWhoPostedPosts}}">[[t('group.showWhoPostedPosts')]]</paper-checkbox></div></div><input type="hidden" name="canVote" value$="[[canVote]]"> <input type="hidden" name="canAddNewPosts" value$="[[canAddNewPosts]]"> <input type="hidden" name="locationHidden" value$="[[locationHidden]]"> <input type="hidden" name="showWhoPostedPosts" value$="[[showWhoPostedPosts]]"> <input type="hidden" name="themeId" value="[[themeId]]"><yp-language-selector name="defaultLocale" no-user-events="" selected-locale="{{group.configuration.defaultLocale}}"></yp-language-selector><h3 class="accessHeader">[[t('access')]]</h3><paper-radio-group id="access" name="access" class="access" selected="{{groupAccess}}"><paper-radio-button name="public" hidden$="[[!publicCommunity]]">[[t('group.public')]]</paper-radio-button><paper-radio-button name="open_to_community" hidden$="[[publicCommunity]]">[[t('group.openToCommunity')]]</paper-radio-button><paper-radio-button name="closed">[[t('group.closed')]]</paper-radio-button><paper-radio-button name="secret">[[t('group.secret')]]</paper-radio-button></paper-radio-group><hr><div class="layout horizontal"><div class="layout vertical additionalSettings"><yp-file-upload id="defaultPostImageUpload" raised="true" multi="false" target="/api/images?itemType=group-logo" method="POST" on-success="_defaultPostImageUploaded"><iron-icon class="icon" icon="photo-camera"></iron-icon><span>[[t('defaultPostImage')]]</span></yp-file-upload></div><input type="hidden" name="uploadedDefaultPostImageId" value="[[uploadedDefaultPostImageId]]"></div><div class="layout vertical config"><h2>[[t('additionalGroupConfig')]]</h2><paper-checkbox name="hideAllTabs" checked$="{{hideAllTabs}}">[[t('hideAllTabs')]]</paper-checkbox><paper-checkbox name="hideNewPostOnPostPage" checked$="{{hideNewPostOnPostPage}}">[[t('hideNewPostOnPostPage')]]</paper-checkbox><paper-checkbox name="newPointOptional" checked$="{{newPointOptional}}">[[t('newPointOptional')]]</paper-checkbox><paper-checkbox name="hideHelpIcon" checked$="{{hideHelpIcon}}">[[t('hideHelpIcon')]]</paper-checkbox><paper-checkbox name="hideEmoji" checked$="{{hideEmoji}}">[[t('hideEmoji')]]</paper-checkbox><paper-checkbox name="hideGroupHeader" checked$="{{hideGroupHeader}}">[[t('hideGroupHeader')]]</paper-checkbox><paper-checkbox name="hidePointAuthor" checked$="{{group.configuration.hidePointAuthor}}">[[t('hidePointAuthor')]]</paper-checkbox><paper-checkbox name="hidePostAuthor" checked$="{{group.configuration.hidePostAuthor}}">[[t('hidePostAuthor')]]</paper-checkbox><paper-checkbox name="allowAnonymousUsers" checked$="{{group.configuration.allowAnonymousUsers}}">[[t('allowAnonymousUsers')]]</paper-checkbox><paper-checkbox name="allowAnonymousAutoLogin" checked$="{{group.configuration.allowAnonymousAutoLogin}}">[[t('allowAnonymousAutoLogin')]]</paper-checkbox><paper-checkbox name="disableFacebookLoginForGroup" checked$="{{group.configuration.disableFacebookLoginForGroup}}">[[t('disableFacebookLoginForGroup')]]</paper-checkbox></div><paper-input id="defaultLocationLongLat" name="defaultLocationLongLat" type="text" label="[[t('defaultLocationLongLat')]]" value="{{group.defaultLocationLongLat}}" maxlength="100" style="width: 300px;"></paper-input><input type="hidden" name="hideAllTabs" value$="[[hideAllTabs]]"> <input type="hidden" name="hideNewPostOnPostPage" value$="[[hideNewPostOnPostPage]]"> <input type="hidden" name="newPointOptional" value$="[[newPointOptional]]"> <input type="hidden" name="hideHelpIcon" value$="[[hideHelpIcon]]"> <input type="hidden" name="hideEmoji" value$="[[hideEmoji]]"> <input type="hidden" name="hideGroupHeader" value$="[[hideGroupHeader]]"><paper-input id="alternativePointForHeader" name="alternativePointForHeader" type="text" label="[[t('alternativePointForHeader')]]" value="{{group.configuration.alternativePointForHeader}}" maxlength="100" char-counter=""></paper-input><paper-input id="alternativePointAgainstHeader" name="alternativePointAgainstHeader" type="text" label="[[t('alternativePointAgainstHeader')]]" value="{{group.configuration.alternativePointAgainstHeader}}" maxlength="100" char-counter=""></paper-input><paper-input id="alternativePointForLabel" name="alternativePointForLabel" type="text" label="[[t('alternativePointForLabel')]]" value="{{group.configuration.alternativePointForLabel}}" maxlength="100" char-counter=""></paper-input><paper-input id="alternativePointAgainstLabel" name="alternativePointAgainstLabel" type="text" label="[[t('alternativePointAgainstLabel')]]" value="{{group.configuration.alternativePointAgainstLabel}}" maxlength="100" char-counter=""></paper-input><div class="layout horizontal"><div class="layout vertical additionalSettings"><yp-file-upload id="defaultDataImageUpload" raised="true" multi="false" target="/api/images?itemType=group-logo" method="POST" on-success="_defaultDataImageUploaded"><iron-icon class="icon" icon="photo-camera"></iron-icon><span>[[t('defaultDataImage')]]</span></yp-file-upload></div><input type="hidden" name="uploadedDefaultDataImageId" value="[[uploadedDefaultDataImageId]]"></div><div class="layout vertical config" hidden$="[[!group.Categories]]"><h2>[[t('categories.the_all')]]</h2><template is="dom-repeat" items="[[group.Categories]]" as="category"><paper-item data-category$="[[category]]" data-category-name$="[[category.name]]" on-tap="_openCategoryEdit"><img sizing="cover" height="24" width="24" class="filterIcon" src="[[_categoryImageSrc(category)]]"> <span class="categoryName">[[category.name]]</span></paper-item></template></div></yp-edit-dialog></template></dom-module><script>Polymer({is:"yp-group-edit",behaviors:[Polymer.appHelpers,Polymer.ypEditDialogBehavior,Polymer.ypCollectionStatusOptions],properties:{canVote:{type:Boolean,value:!0},canAddNewPosts:{type:Boolean,value:!0},showWhoPostedPosts:{type:Boolean,value:!1},hideAllTabs:Boolean,hideNewPostOnPostPage:Boolean,newPointOptional:Boolean,hideHelpIcon:Boolean,hideEmoji:Boolean,hideGroupHeader:Boolean,action:{type:String,value:"/api/groups"},group:{type:Object,observer:"_groupChanged"},community:{type:Object},groupAccess:{type:String,value:"public"},uploadedLogoImageId:{type:String},uploadedHeaderImageId:{type:String},uploadedDefaultDataImageId:{type:String},uploadedDefaultPostImageId:{type:String},status:String,publicCommunity:{type:Boolean,value:!1},themeId:{type:String,value:null},locationHidden:Boolean,endorsementButtonsOptions:{type:Object,computed:"_endorsementButtonsOptions(language)"},endorsementButtons:String},observers:["_setupTranslation(language,t)"],_openCategoryEdit:function(a){window.appGlobals.activity("open","category.new"),Polymer.dom(document).querySelector("yp-app").getDialogAsync("categoryEdit",function(b){b.setup(this.group,!1,this._refreshCategories.bind(this),a.model.category),b.open("edit",{categoryId:a.model.category.id})}.bind(this))},_refreshCategories:function(a){var b=[];__.each(this.group.Categories,function(c){c.id===a.id?b.push(a):b.push(c)}),this.set("group.Categories",b)},_categoryImageSrc:function(a){return this.getImageFormatUrl(a.CategoryIconImages,0)},_endorsementButtonsOptions:function(){return this.t?[{name:"hearts",translatedName:this.t("endorsementButtonsHeart")},{name:"arrows",translatedName:this.t("endorsementArrows")},{name:"thumbs",translatedName:this.t("endorsementThumbs")},{name:"hats",translatedName:this.t("endorsementHats")}]:[]},_updateEmojiBindings:function(){this.async(function(){var a=this.$$("#objectives"),b=this.$$("#emojiSelectorDescription");a&&b?b.inputTarget=a:console.warn("Group edit: Can't bind emojis :(")}.bind(this),500)},_publicCommunity:function(a){if(a)return 0==a.Community.access},_customRedirect:function(a){a?(window.appUser.recheckAdminRights(),this.redirectTo("/group/"+a.id)):console.warn("No group found on custom redirect")},_groupChanged:function(){this.group&&(0==this.group.access?this.groupAccess="public":1==this.group.access?this.groupAccess="closed":2==this.group.access?this.groupAccess="secret":3==this.group.access&&(this.groupAccess="open_to_community"),this.group&&this.group.status&&this.set("status",this.group.status),this.group.configuration&&this.group.configuration.canVote!=void 0?(this.set("canVote",this.group.configuration.canVote),this.set("canAddNewPosts",this.group.configuration.canAddNewPosts)):(this.set("canVote",!0),this.set("canAddNewPosts",!0)),this.group.configuration&&this.group.configuration.endorsementButtons!=void 0?this.set("endorsementButtons",this.group.configuration.endorsementButtons):this.set("endorsementButtons","hearts"),this._setFromConfiguration("locationHidden"),this._setFromConfiguration("hideAllTabs"),this._setFromConfiguration("hideNewPostOnPostPage"),this._setFromConfiguration("newPointOptional"),this._setFromConfiguration("hideHelpIcon"),this._setFromConfiguration("hideEmoji"),this._setFromConfiguration("hideGroupHeader"),this._setFromConfiguration("showWhoPostedPosts"),this.community?0==this.community.access?this.set("publicCommunity",!0):this.set("publicCommunity",!1):this.group.Community&&(0==this.group.Community.access?this.set("publicCommunity",!0):this.set("publicCommunity",!1))),this._updateEmojiBindings()},_setFromConfiguration:function(a){this.group.configuration&&this.group.configuration[a]!=void 0&&""!=this.group.configuration[a]?this.set(a,this.group.configuration[a]):this.set(a,!1)},_clear:function(){this.set("group",{name:"",objectives:"",access:0,status:"active"}),this.set("uploadedLogoImageId",null),this.set("uploadedHeaderImageId",null),this.set("uploadedDefaultDataImageId",null),this.$.headerImageUpload.clear(),this.$.logoImageUpload.clear(),this.$.defaultDataImageUpload.clear()},setup:function(a,b,c){if(!a){var d=0;this.community?0!=this.community.access&&(this.set("groupAccess","open_to_community"),d=3):this.group.Community&&0!=this.group.Community.access&&(this.set("groupAccess","open_to_community"),d=3),this.set("group",{name:"",objectives:"",access:d,status:"active"})}else this.set("group",a);this.set("new",b),this.set("refreshFunction",c),this._setupTranslation()},_setupTranslation:function(){this.language&&this.t&&(this.new?(this.editHeaderText=this.t("group.new"),this.toastText=this.t("groupToastCreated"),this.set("saveText",this.t("create"))):(this.set("saveText",this.t("save")),this.editHeaderText=this.t("group.update"),this.toastText=this.t("groupToastUpdated")))}});</script><script>Polymer({is:'google-map-search',properties:{map:{type:Object,value:null},query:{type:String,value:null},latitude:{type:Number,value:null},longitude:{type:Number,value:null},radius:{type:Number,value:null},globalSearch:{type:Boolean,value:!1},types:{type:String,value:null},results:{type:Array,value:function(){return[]},notify:!0},location:{type:Object,value:null,readOnly:!0}},observers:['search(query,map,location,radius,types,globalSearch)','_updateLocation(latitude,longitude)'],search:function(){if(this.query&&this.map){var a=new google.maps.places.PlacesService(this.map);if(this.types&&'string'==typeof this.types)var b=this.types.split(' ');if(this.radius)var c=this.radius,d=this.location?this.location:this.map.getCenter();else if(!this.globalSearch)var e=this.map.getBounds();a.textSearch({query:this.query,types:b,bounds:e,radius:c,location:d},this._gotResults.bind(this))}},getDetails:function(a){var b=new google.maps.places.PlacesService(this.map);return new Promise(function(c,d){b.getDetails({placeId:a},function(a,b){b===google.maps.places.PlacesServiceStatus.OK?(c(a),this.fire('google-map-search-place-detail',a)):d(b)}.bind(this))}.bind(this))},_gotResults:function(a){this.results=a.map(function(a){return a.latitude=a.geometry.location.lat(),a.longitude=a.geometry.location.lng(),a}),this.fire('google-map-search-results',this.results)},_updateLocation:function(){if(this.map){if('number'!==typeof this.latitude||isNaN(this.latitude))throw new TypeError('latitude must be a number');else if('number'!==typeof this.longitude||isNaN(this.longitude))throw new TypeError('longitude must be a number');this._setLocation({lat:this.latitude,lng:this.longitude})}}});</script><dom-module id="yp-post-location" assetpath="../yp-post/"><template><style include="iron-flex iron-flex-alignment">:host{display:block;width:100%;height:100%;}.location-button{@apply (--layout-horizontal);@apply (--layout-flex);}#map{width:100%;height:100%;}@media screen and (-ms-high-contrast: active), (-ms-high-contrast: none){#map{min-height:220px;}}.mapSearchInput{width:100%;margin-top:8px;}paper-input{width:250px;}.searchResultText{width:100%;text-align:right;padding-top:8px;}paper-button{font-size:16px;padding-top:32px;}</style><lite-signal on-lite-signal-yp-language="_languageEvent"></lite-signal><iron-media-query query="(max-width: 1024px)" query-matches="{{narrowPad}}"></iron-media-query><google-map-search id="mapSearch" map="[[map]]" on-google-map-search-results="_mapSearchResults"></google-map-search><google-map id="map" zoom="[[mapZoom]]" api-key="AIzaSyDkF_kak8BVZA5zfp5R4xRnrX8HP3hjiL0" map="{{map}}" libraries="places" on-map-type-changed="_mapTypeChanged" class="map" click-events="" on-zoom-changed="_zoomChanged" on-google-map-click="_setLocation" fit-to-markers=""><google-map-marker latitude="[[defaultLatitude]]" longitude="[[defaultLongitude]]" id="marker"></google-map-marker></google-map><div class="mapSearchInput layout vertical center-center"><div class="layout horizontal center-center wrap"><paper-input max-length="60" label="[[t('maps.searchInput')]]" value="{{mapSearchString}}" on-keydown="_submitOnEnter"></paper-input><paper-button on-tap="_searchMap">[[t('maps.search')]]</paper-button></div><div class="searchResultText layout horizontal center-center">[[mapSearchResultAddress]]</div><paper-spinner id="spinner"></paper-spinner></div></template><script>Polymer({is:'yp-post-location',behaviors:[Polymer.appHelpers],properties:{map:{type:Object},group:{type:Object,observer:'_groupChanged'},defaultLatitude:{type:String,value:'64.13897027178841'},defaultLongitude:{type:String,value:'-21.876912117004395'},mapSearchString:{type:String,value:''},mapSearchResultAddress:{type:String,value:''},location:{type:Object,observer:'_locationChanged',notify:!0},mapZoom:{type:Number,value:13,computed:'_computeMapZoom(location)'},encodedLocation:{type:String,notify:!0},post:{type:Object,observer:'_postChanged'},marker:{type:Object},active:{type:Boolean,value:!1},narrowPad:Boolean},_computeMapZoom:function(a){return a&&a.map_zoom?a.map_zoom:this.mapZoom},_submitOnEnter:function(a){13===a.keyCode&&this._searchMap()},_searchMap:function(){this.$.mapSearch.query=this.mapSearchString,this.$.mapSearch.search(),this.$.spinner.active=!0,this.set('mapSearchResultAddress','')},_mapSearchResults:function(a,b){this.$.spinner.active=!1,b&&0<b.length&&(this.set('location',{latitude:b[0].latitude,longitude:b[0].longitude,map_zoom:15}),this.mapSearchResultAddress=b[0].formatted_address,this.$.map.zoom=15,this.$.map.resize())},ready:function(){this.location||this.async(function(){'geolocation'in navigator&&navigator.geolocation.getCurrentPosition(function(a){this.location||(this.location={latitude:a.coords.latitude,longitude:a.coords.longitude,map_zoom:13})}.bind(this))},50)},_zoomChanged:function(a,b){b&&b.value&&this.set('location.map_zoom',b.value),this.set('encodedLocation',JSON.stringify(this.location))},_mapTypeChanged:function(a,b){b&&b.value&&this.set('location.mapType',b.value),this.set('encodedLocation',JSON.stringify(this.location))},_locationChanged:function(a){a&&(this.$.marker.setAttribute('latitude',a.latitude),this.$.marker.setAttribute('longitude',a.longitude),a.map_zoom&&(this.$.map.zoom=a.map_zoom),a.mapType&&(this.$.map.mapType=a.mapType),this.$.map.resize(),this.set('encodedLocation',JSON.stringify(a)))},_setLocation:function(a,b){this.set('location',{latitude:b.latLng.lat(),longitude:b.latLng.lng(),mapType:this.$.map.mapType,map_zoom:this.$.map.zoom})},_groupChanged:function(a){if(a){var b;a.configuration&&a.configuration.defaultLocationLongLat&&''!=a.configuration.defaultLocationLongLat&&1<a.configuration.defaultLocationLongLat.split(',').length?(b=a.configuration.defaultLocationLongLat.trim().split(','),this.set('defaultLongitude',b[0]),this.set('defaultLatitude',b[1])):a.Community&&a.Community.configuration&&a.Community.configuration.defaultLocationLongLat&&''!=a.Community.configuration.defaultLocationLongLat&&1<a.Community.configuration.defaultLocationLongLat.split(',').length&&(b=a.Community.configuration.defaultLocationLongLat.trim().split(','),this.set('defaultLongitude',b[0]),this.set('defaultLatitude',b[1]))}},_postChanged:function(a){a||this.set('location',null)}});</script></dom-module><dom-module id="yp-post-edit" assetpath="../yp-post/"><template><style include="iron-flex iron-flex-alignment">.access{@apply (--layout-horizontal);@apply (--layout-center-justified);}paper-button{background-color:var(--accent-color);color:#FFF;}yp-file-upload{margin-top:16px;}.accessHeader{color:var(--primary-color,#777);font-weight:normal;margin-bottom:0;}paper-radio-button{display:block;}.container{width:100%;height:100%;min-height:300px;}@media (max-width: 600px){.container{padding-right:16px;}.subContainer{}paper-tab{font-size:12px;}}yp-post-location{}section{margin-top:32px;}.imageSizeInfo{font-size:12px;padding-bottom:16px;color:#444;}paper-dropdown-menu{max-width:250px;}.optional{font-size:12px;}.icon{padding-right:8px;}[hidden]{display:none !important;}</style><lite-signal on-lite-signal-yp-language="_languageEvent"></lite-signal><yp-edit-dialog double-width="" id="editDialog" icon="lightbulb-outline" action="[[action]]" use-next-tab-action="[[newPost]]" on-next-tab-action="_nextTab" method="[[method]]" title="[[editHeaderText]]" save-text="[[saveText]]" next-action-text="[[t('next')]]" toast-text="[[toastText]]" params="[[params]]"><paper-tabs selected="{{selected}}" id="paperTabs" focused=""><paper-tab><span>[[t('post.yourPost')]]</span></paper-tab><template is="dom-if" restamp="" if="[[newPost]]"><paper-tab><div class="layout vertical center-center"><div>[[t('post.yourPoint')]]</div><div class="optional" hidden$="[[!group.configuration.newPointOptional]]">[[t('optional')]]</div></div></paper-tab></template><template is="dom-if" if="[[!locationHidden]]" restamp=""><paper-tab>[[t('post.location')]]</paper-tab></template><paper-tab>[[t('post.photo')]]</paper-tab></paper-tabs><div class="layout vertical wrap container"><neon-animated-pages id="pages" class="layout horizontal flex" selected="[[selected]]"><section><div class="layout vertical"><paper-input id="name" required="" minlength="3" name="name" type="text" label="[[t('title')]]" value="{{post.name}}" maxlength="60" char-counter=""></paper-input><template is="dom-if" if="[[_showCategories(group)]]" restamp=""><paper-dropdown-menu label="[[t('category.select')]]"><paper-listbox slot="dropdown-content" selected="{{selectedCategoryArrayId}}"><template is="dom-repeat" items="[[group.Categories]]" as="category"><paper-item data-category-id$="[[category.id]]">[[category.name]]</paper-item></template></paper-listbox></paper-dropdown-menu><input type="hidden" name="categoryId" value="[[selectedCategoryId]]"></template><paper-textarea id="description" required="" minlength="3" name="description" value="{{post.description}}" label="[[t('post.description')]]" char-counter="" rows="2" max-rows="5" maxlength="500"></paper-textarea><div class="horizontal end-justified layout" hidden$="[[group.configuration.hideEmoji]]"><emoji-selector id="emojiSelectorDescription"></emoji-selector></div></div></section><template is="dom-if" restamp="" if="[[newPost]]"><section class="subContainer"><paper-textarea id="pointFor" required$="[[!group.configuration.newPointOptional]]" minlength="3" name="pointFor" value="{{post.pointFor}}" label="[[t('point.for')]]" char-counter="" rows="2" max-rows="5" maxlength="500"></paper-textarea><div class="horizontal end-justified layout" hidden$="[[group.configuration.hideEmoji]]"><emoji-selector id="emojiSelectorPointFor"></emoji-selector></div></section></template><template is="dom-if" if="[[!locationHidden]]" restamp=""><section><template is="dom-if" if="[[mapActive]]" restamp=""><yp-post-location encoded-location="{{encodedLocation}}" location="{{location}}" group="[[group]]" post="[[post]]"></yp-post-location></template></section></template><section><div class="layout vertical center-center"><yp-file-upload id="imageFileUpload" raised="true" multi="true" target="/api/images?itemType=post-header" method="POST" on-success="_imageUploaded"><iron-icon class="icon" icon="photo-camera"></iron-icon><span>[[t('image.upload')]]</span></yp-file-upload><div class="imageSizeInfo layout horizontal"><div>864 x 486 (16/9 widescreen)</div></div><div>[[t('post.cover.imageInfo')]]</div><br><h3 class="accessHeader">[[t('post.cover.media')]]</h3><paper-radio-group id="coverMediaType" name="coverMediaType" class="coverMediaType layout horizontal wrap" selected="{{selectedCoverMediaType}}"><paper-radio-button name="none">[[t('post.cover.none')]]</paper-radio-button><paper-radio-button name="image" hidden$="[[!uploadedHeaderImageId]]">[[t('post.cover.image')]]</paper-radio-button><template is="dom-if" if="[[location]]"><paper-radio-button name="map">[[t('post.cover.map')]]</paper-radio-button><paper-radio-button name="streetView">[[t('post.cover.streetview')]]</paper-radio-button></template></paper-radio-group></div></section></neon-animated-pages><input type="hidden" name="location" value="[[encodedLocation]]"> <input type="hidden" name="coverMediaType" value="[[selectedCoverMediaType]]"> <input type="hidden" name="uploadedHeaderImageId" value="[[uploadedHeaderImageId]]"></div></yp-edit-dialog></template></dom-module><script>Polymer({is:"yp-post-edit",behaviors:[Polymer.appHelpers,Polymer.ypEditDialogBehavior],properties:{action:{type:String,value:"/api/posts"},newPost:{type:Boolean,value:!1},post:{type:Object,observer:"_postChanged"},group:{type:Object},locationHidden:{type:Boolean,value:!1,observer:"_locationHiddenChanged"},location:{type:Object,observer:"_locationChanged"},encodedLocation:{type:String,observer:"_encodedLocationChanged"},selectedCategoryArrayId:{type:Number,observer:"_selectedCategoryChanged"},selectedCategoryId:{type:Number},selectedCoverMediaType:{type:String,value:"none",observer:"_coverMediaTypeValueChanged"},uploadedHeaderImageId:{type:String,observer:"_uploadedHeaderImageIdChanged"},selected:{type:Number,value:0,observer:"_selectedChanged"},mapActive:{type:Boolean,value:!1}},listeners:{"iron-form-invalid":"_formInvalid"},observers:["_setupTranslation(language,t)"],customFormResponse:function(){document.dispatchEvent(new CustomEvent("lite-signal",{bubbles:!0,compose:!0,detail:{name:"yp-refresh-group-posts",data:{id:4}}}))},_updateEmojiBindings:function(){this.async(function(){var a=this.$$("#description"),b=this.$$("#emojiSelectorDescription");a&&b?b.inputTarget=a:console.warn("Post edit: Can't bind emojis :(");var c=this.$$("#emojiSelectorPointFor"),d=this.$$("#pointFor");c&&d&&(c.inputTarget=d)}.bind(this),500)},_locationHiddenChanged:function(){this.async(function(){var a=this.$$("#pages");a&&a.forceSynchronousItemUpdate();var b=this.$$("#paperTabs");b&&b.forceSynchronousItemUpdate(),console.log("Location hidden changed")},10)},_formInvalid:function(){this.newPost&&this.$$("#name").validate()&&this.$$("#description").validate()?this.set("selected",1):this.set("selected",0),this.$$("#name").autoValidate=!0,this.$$("#description").autoValidate=!0,this.newPost&&(this.$$("#pointFor").autoValidate=!0)},_encodedLocationChanged:function(){},_locationChanged:function(a){a&&(!this.selectedCoverMediaType||""==this.selectedCoverMediaType||"none"==this.selectedCoverMediaType)&&this.set("selectedCoverMediaType","map")},_uploadedHeaderImageIdChanged:function(a){a&&this.set("selectedCoverMediaType","image")},_nextOnEnter:function(a){13===a.keyCode&&this._searchMap()},_nextTab:function(){var a=3;this.newPost||(a=2),this.locationHidden&&(a-=1),this.selected<a&&this.set("selected",this.selected+1)},_selectedChanged:function(a){this.locationHidden||a!=(this.newPost?2:1)?this.set("mapActive",!1):this.set("mapActive",!0);var b=this.locationHidden?2:3;if(this.$$("#editDialog").useNextTabAction=!this.newPost||this.newPost&&a==b?!1:!0,0==a){var c=this.$$("#name");c&&c.focus()}if(1==a){var d=this.$$("#pointFor");d&&d.focus()}},_selectedCategoryChanged:function(a){null!=a&&a!=void 0&&(this.selectedCategoryId=this.group.Categories[a].id)},_showCategories:function(a){return a&&a.Categories&&0<a.Categories.length},getPositionInArrayFromId:function(a,b){for(var c=0;c<a.length;c++)if(a[c].id==b)return c;return null},_postChanged:function(a){a&&(a.location&&(this.set("location",a.location),this.set("encodedLocation",JSON.stringify(this.location))),a.cover_media_type&&(this.selectedCoverMediaType=a.cover_media_type),a.category_id&&(this.selectedCategoryId=a.category_id,this.selectedCategoryArrayId=this.getPositionInArrayFromId(this.group.Categories,a.category_id))),this._updateEmojiBindings()},_imageUploaded:function(a,b){var c=JSON.parse(b.xhr.response);this.set("uploadedHeaderImageId",c.id)},_coverMediaTypeValueChanged:function(){},_coverMediaTypeChanged:function(){},_customRedirect:function(a){a?(a.newEndorsement&&window.appUser&&window.appUser.endorsementPostsIndex&&(window.appUser.endorsementPostsIndex[a.id]=a.newEndorsement),this.redirectTo("/post/"+a.id)):console.warn("No post found on custom redirect")},_clear:function(){this.newPost&&(this.set("post",{name:"",description:"",pointFor:"",categoryId:null}),this.set("location",null),this.set("selectedCategoryArrayId",null),this.set("selectedCategoryId",null),this.set("selected",0),this.set("uploadedHeaderImageId",null),this.$$("#imageFileUpload").clear(),this.set("selectedCoverMediaType","none"))},setup:function(a,b,c,d){b?(this.set("group",b),this.group.configuration&&this.group.configuration.locationHidden?!0==this.group.configuration.locationHidden?this.set("locationHidden",!0):this.set("locationHidden",!1):this.set("locationHidden",!1)):this.set("group",null),a?this.set("post",a):this.set("post",null),this.set("newPost",c),this.set("refreshFunction",d),this._setupTranslation(),this._clear(),this.async(function(){var a=this.$$("#name");a&&a.focus()}.bind(this),250)},_setupTranslation:function(){this.async(function(){this.t&&(this.newPost?(this.editHeaderText=this.t("post.new"),this.toastText=this.t("post.toast.created"),this.set("saveText",this.t("create"))):(this.set("saveText",this.t("save")),this.editHeaderText=this.t("post.edit"),this.toastText=this.t("post.toast.updated")))}.bind(this),20)}});</script><dom-module id="yp-post-user-image-edit" assetpath="../yp-post/"><template><style include="iron-flex iron-flex-alignment"></style><lite-signal on-lite-signal-yp-language="_languageEvent"></lite-signal><yp-edit-dialog double-width="" id="editDialog" icon="photo-camera" action="[[action]]" title="[[editHeaderText]]" method="[[method]]" save-text="[[saveText]]" next-action-text="[[t('next')]]" toast-text="[[toastText]]" params="[[params]]"><div class="layout vertical center-center"><yp-file-upload id="imageFileUpload" raised="true" multi="false" method="POST" on-success="_imageUploaded"><iron-icon class="icon" icon="photo-camera"></iron-icon><span>[[t('image.upload')]]</span></yp-file-upload></div><paper-input id="photographerName" name="photographerName" type="text" label="[[t('post.photographerName')]]" value="{{image.photographer_name}}" maxlength="60" char-counter=""></paper-input><paper-textarea id="description" required="" minlength="15" name="description" value="{{image.description}}" label="[[t('post.description')]]" char-counter="" rows="2" max-rows="5" maxlength="200"></paper-textarea><input type="hidden" name="uploadedPostUserImageId" value="[[uploadedPostUserImageId]]"> <input type="hidden" name="oldUploadedPostUserImageId" value="[[oldUploadedPostUserImageId]]"></yp-edit-dialog></template><script>(function(){Polymer({is:'yp-post-user-image-edit',behaviors:[Polymer.appHelpers,Polymer.ypEditDialogBehavior],properties:{new:{type:Boolean,value:!1},image:{type:Object,observer:'_imageChanged'},post:{type:Object,observer:'_postChange'},action:{type:String,value:'/api/images'},imageUploadTarget:{type:String,notify:!0},uploadedPostUserImageId:{type:String},oldUploadedPostUserImageId:{type:String},editHeaderText:{type:String},saveText:{type:String},method:{type:String}},_postChange:function(a){a&&(this.$.imageFileUpload.target='/api/images?itemType=post-user-image&postId='+a.id)},listeners:{"iron-form-invalid":'_formInvalid'},_imageChanged:function(a){a&&this.set('oldUploadedPostUserImageId',a.id)},_formInvalid:function(){this.set('selected',0),this.$$('#photographerName').autoValidate=!0,this.$$('#description').autoValidate=!0},_imageUploaded:function(a,b){var c=JSON.parse(b.xhr.response);this.set('uploadedPostUserImageId',c.id)},_clear:function(){this.set('uploadedPostUserImageId',null),this.$$('#imageFileUpload').clear()},setup:function(a,b,c,d){b?this.set('image',b):this.set('image',{description:'',photographerName:''}),a?this.set('post',a):this.set('post',null),this.set('new',c),this.set('refreshFunction',d),this._setupTranslation()},_setupTranslation:function(){this.new?(this.editHeaderText=this.t('post.newPhoto'),this.toastText=this.t('post.photo.toast.added')):(this.editHeaderText=this.t('post.photoUpdate'),this.toastText=this.t('post.photo.toast.updated'))}})})();</script></dom-module><dom-module id="yp-post-status-change-edit" assetpath="../yp-post/"><template><style include="iron-flex iron-flex-alignment">.additionalSettings{padding-top:16px;}paper-textarea{padding-top:16px;}</style><lite-signal on-lite-signal-yp-language="_languageEvent"></lite-signal><yp-edit-dialog id="editDialog" title="[[editHeaderText]]" double-width="" icon="language" confirmation-text="[[t('post.statusChangeConfirmText')]]" action="[[action]]" method="[[method]]" params="[[params]]" save-text="[[saveText]]" toast-text="[[toastText]]"><div class="layout horizontal center-center"><paper-dropdown-menu label="[[t('post.statusChangeSelectNewStatus')]]"><paper-listbox slot="dropdown-content" attr-for-selected="name" selected="{{officialStatus}}"><template is="dom-repeat" items="[[officialStatusOptions]]" as="statusOption"><paper-item name="[[statusOption.official_value]]">[[statusOption.translatedName]]</paper-item></template></paper-listbox></paper-dropdown-menu><input type="hidden" name="official_status" value="[[officialStatus]]"></div><div class="layout vertical"><paper-textarea id="content" name="content" value="{{postStatusChange.content}}" label="[[t('post.statusChangeContent')]]" char-counter="" rows="10" max-rows="10" maxlength="100000" class="mainInput"></paper-textarea></div></yp-edit-dialog></template></dom-module><script>Polymer({is:"yp-post-status-change-edit",behaviors:[Polymer.appHelpers,Polymer.ypEditDialogBehavior,Polymer.ypOfficialStatusOptions],properties:{action:{type:String,value:"/api/posts"},post:{type:Object,observer:"_postChanged"},params:{type:String},method:{type:String},officialStatus:Number,postStatusChange:Object},_postChanged:function(a){a&&this.set("officialStatus",this.post.official_status)},_clear:function(){this.set("postStatusChange",{content:""}),this.set("post",null)},setup:function(a,b,c){this.set("post",a),b?this.set("postStatusChange",b):this.set("postStatusChange",{content:""}),this.set("refreshFunction",c),this._setupTranslation()},_setupTranslation:function(){this.set("editHeaderText",this.t("post.statusChange")),this.set("toastText",this.t("post.statusChangeSent")),this.set("saveText",this.t("post.statusChange"))}});</script><dom-module id="yp-post-move" assetpath="../yp-post/"><template><style include="iron-flex iron-flex-alignment">.additionalSettings{padding-top:16px;}paper-textarea{padding-top:16px;}.groupName{cursor:pointer;}</style><lite-signal on-lite-signal-yp-language="_languageEvent"></lite-signal><yp-edit-dialog id="editDialog" title="[[editHeaderText]]" icon="language" confirmation-text="[[t('post.statusChangeConfirmText')]]" action="[[action]]" method="[[method]]" params="[[params]]" save-text="[[saveText]]" toast-text="[[toastText]]"><template is="dom-repeat" items="[[availableGroups]]" as="group"><div class="groupName" on-tap="_selectGroup" data-args$="[[group.id]]" data-args-name$="[[group.name]]">[[group.name]]</div></template><div class="layout horizontal center-center"><yp-ajax method="GET" id="getAvailableGroupsAjax" url="/api/users/available/groups" on-response="_getGroupsResponse"></yp-ajax><yp-ajax method="PUT" id="movePostAjax" on-response="_movePostResponse"></yp-ajax></div></yp-edit-dialog></template></dom-module><script>Polymer({is:'yp-post-move',behaviors:[Polymer.appHelpers,Polymer.ypEditDialogBehavior,Polymer.AccessHelpers,Polymer.ypPostMoveBehavior],properties:{action:{type:String,value:'/api/posts'},post:{type:Object},selectedGroupId:Number},_selectGroup:function(a){this.set('selectedGroupId',a.target.getAttribute('data-args'));var b=a.target.getAttribute('data-args-name'),c=Polymer.dom(document).querySelector('yp-app').getDialog('confirmationDialog');c.open(this.t('post.confirmMove')+' "'+this.post.name+'" '+this.t('to')+' "'+b+'"',this._reallyMove.bind(this))},_reallyMove:function(){this.$.movePostAjax.url='/api/posts/'+this.post.id+'/'+this.selectedGroupId+'/move',this.$.movePostAjax.body={},this.$.movePostAjax.generateRequest()},_movePostResponse:function(){location.reload()},_clear:function(){this.set('selectedGroupId',null),this.set('post',null)},setupAndOpen:function(a,b){this.set('post',a),this.set('refreshFunction',b),this._setupTranslation(),this.$.getAvailableGroupsAjax.generateRequest(),this.open()},_setupTranslation:function(){this.set('editHeaderText',this.t('post.move')),this.set('toastText',this.t('post.haveMovedPost')),this.set('saveText',this.t('post.move'))}});</script></div></body></html>