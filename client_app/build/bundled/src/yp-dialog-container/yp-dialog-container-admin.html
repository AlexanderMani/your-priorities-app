<div hidden="" by-polymer-bundler=""><dom-module id="yp-category-edit" assetpath="../yp-category/"><template><lite-signal on-lite-signal-yp-language="_languageEvent"></lite-signal><yp-edit-dialog id="editDialog" title="[[editHeaderText]]" icon="add" action="[[action]]" method="[[method]]" params="[[params]]" save-text="[[saveText]]" toast-text="[[toastText]]"><paper-input id="name" name="name" type="text" label="[[t('Name')]]" value="{{category.name}}" maxlength="60" char-counter=""></paper-input><paper-textarea id="description" name="description" value="{{category.description}}" always-float-label="[[category.description]]" label="[[t('Description')]]" char-counter="" rows="2" max-rows="5" maxlength="300"></paper-textarea><div class="layout vertical additionalSettings"><yp-file-upload id="iconImageUpload" droppable="true" raised="true" multi="false" target="/api/images?itemType=category-icon" method="POST" on-success="_iconImageUploaded"><iron-icon class="icon" icon="photo-camera"></iron-icon><span>[[t('image.icon.upload')]]</span></yp-file-upload></div><div class="layout vertical additionalSettings" hidden=""><yp-file-upload id="headerImageUpload" droppable="true" raised="true" multi="false" target="/api/images?itemType=category-header" method="POST" on-success="_headerImageUploaded"><iron-icon class="icon" icon="photo-camera"></iron-icon><span>[[t('image.header.upload')]]</span></yp-file-upload></div><input type="hidden" name="uploadedIconImageId" value="[[uploadedIconImageId]]"> <input type="hidden" name="uploadedHeaderImageId" value="[[uploadedHeaderImageId]]"></yp-edit-dialog></template></dom-module><script>Polymer({is:"yp-category-edit",behaviors:[Polymer.ypLanguageBehavior,Polymer.ypEditDialogBehavior],properties:{action:{type:String,value:"/api/categories"},category:{type:Object},group:{type:Object},categoryAccess:{type:String},params:{type:String},method:{type:String},uploadedIconImageId:{type:String},uploadedHeaderImageId:{type:String}},_iconImageUploaded:function(e,t){var a=JSON.parse(t.xhr.response);this.set("uploadedIconImageId",a.id)},_headerImageUploaded:function(e,t){var a=JSON.parse(t.xhr.response);this.set("uploadedHeaderImageId",a.id)},setup:function(e,t,a,i){this.set("group",e),this.set("new",t),this.set("refreshFunction",a),i&&this.set("category",i),this._setupTranslation(),this._setupNewUpdateState()},_clear:function(){this.set("category",{name:"",description:""}),this.set("uploadedIconImageId",null),this.set("uploadedHeaderImageId",null),this.$.headerImageUpload.clear(),this.$.iconImageUpload.clear()},_setupTranslation:function(){this.new?(this.editHeaderText=this.t("New category"),this.toastText=this.t("category.toast.created")):(this.editHeaderText=this.t("Update category info"),this.toastText=this.t("category.toast.updated"))}});</script><dom-module id="yp-users-grid" assetpath="../yp-user/"><template><style include="iron-flex iron-flex-alignment">#dialog{width:800px;background-color:#FFF}iron-list{color:#000;height:500px;width:100%}.userItem{padding-right:16px}.id{width:40px}.name{width:200px}.email{width:190px;overflow-wrap:break-word}.organization{width:150px}.addRemoveButtons{width:150px}#selectOrganizationDialog{background-color:#FFF}[hidden]{display:none!important}</style><lite-signal on-lite-signal-yp-language="_languageEvent"></lite-signal><paper-dialog id="selectOrganizationDialog" modal=""><h2>[[t('users.selectOrganization')]]</h2><paper-dialog-scrollable><paper-listbox><template is="dom-repeat" items="[[availableOrganizations]]"><paper-item on-tap="_selectOrganization" id="[[item.id]]">[[item.name]]</paper-item></template></paper-listbox></paper-dialog-scrollable><div class="buttons"><paper-button dialog-dismiss="">[[t('Close')]]</paper-button></div></paper-dialog><paper-dialog id="dialog"><h2>[[headerText]]</h2><paper-dialog-scrollable><iron-list items="[[users]]" as="user"><template><div class="layout horizontal"><div class="userItem id">[[user.id]]</div><div class="userItem name">[[user.name]]</div><div class="userItem email">[[user.email]]</div><template is="dom-if" if="[[!_userOrganizationName(user)]]"><div class="organization"><paper-button data-args$="[[user.id]]" on-tap="_addToOrganization">[[t('users.addToOrganization')]]</paper-button></div></template><div class="organization" hidden$="[[!_userOrganizationName(user)]]"><div class="organizationName">[[_userOrganizationName(user)]]</div><paper-button data-args$="[[user.id]]" data-args-org$="[[_userOrganizationId(user)]]" on-tap="_removeFromOrganization">[[t('users.removeFromOrganization')]]</paper-button></div><div hidden$="[[!adminUsers]]" class="addRemoveButtons"><paper-button data-args$="[[user.id]]" on-tap="_removeAdmin">[[t('users.removeAdmin')]]</paper-button></div><div hidden$="[[adminUsers]]"><paper-button data-args$="[[user.id]]" on-tap="_removeUser">[[t('users.removeUser')]]</paper-button></div></div></template></iron-list></paper-dialog-scrollable><div hidden$="[[!adminUsers]]" class="layout horizontal"><paper-input label="[[t('users.email')]]" value="{{addAdminEmail}}"></paper-input><paper-button on-tap="_addAdmin">[[t('users.addAdmin')]]</paper-button></div><div hidden$="[[adminUsers]]" class="layout horizontal"><paper-input label="[[t('users.email')]]" value="{{inviteUserEmail}}"></paper-input><paper-button on-tap="_inviteUser">[[t('users.inviteUser')]]</paper-button></div><div class="buttons"><paper-button dialog-dismiss="">[[t('close')]]</paper-button></div></paper-dialog><div class="layout horizontal center-center"><yp-ajax id="ajax" on-response="_usersResponse"></yp-ajax><yp-ajax method="DELETE" id="removeAdminAjax" on-response="_removeAdminResponse"></yp-ajax><yp-ajax method="DELETE" id="removeUserAjax" on-response="_removeUserResponse"></yp-ajax><yp-ajax method="DELETE" id="removeOrganizationAjax" on-response="_removeOrganizationResponse"></yp-ajax><yp-ajax method="POST" id="inviteUserAjax" on-response="_inviteUserResponse"></yp-ajax><yp-ajax method="POST" id="addAdminAjax" on-response="_addAdminResponse"></yp-ajax><yp-ajax method="POST" id="addOrganizationAjax" on-response="_addOrganizationResponse"></yp-ajax></div></template><script>Polymer({is:"yp-users-grid",behaviors:[Polymer.ypLanguageBehavior],properties:{addAdminEmail:{type:String},inviteUserEmail:{type:String},users:{type:Array,notify:!0},headerText:{type:String},groupId:{type:Number,observer:"_groupIdChanged"},domainId:{type:Number,observer:"_domainIdChanged"},communityId:{type:Number,observer:"_communityIdChanged"},adminUsers:{type:Boolean,value:!1},selected:{type:Object},modelType:{type:String},opened:{type:Boolean,value:!1},availableOrganizations:{type:Array},userIdForSelectingOrganization:Number},_userOrganizationId:function(e){return e&&e.OrganizationUsers&&e.OrganizationUsers.length>0?e.OrganizationUsers[0].id:null},_userOrganizationName:function(e){return e&&e.OrganizationUsers&&e.OrganizationUsers.length>0?e.OrganizationUsers[0].name:null},_availableOrganizations:function(){return window.appUser.adminRights&&window.appUser.adminRights.OrganizationAdmins?window.appUser.adminRights.OrganizationAdmins:[]},_addToOrganization:function(e){this.set("userIdForSelectingOrganization",e.target.getAttribute("data-args")),this.set("availableOrganizations",this._availableOrganizations()),this.$.selectOrganizationDialog.open()},_removeFromOrganization:function(e){var t=e.target.getAttribute("data-args"),i=e.target.getAttribute("data-args-org");this.$.removeOrganizationAjax.body={},this.$.removeOrganizationAjax.url="/api/organizations/"+i+"/"+t+"/remove_user",this.$.removeOrganizationAjax.generateRequest()},_selectOrganization:function(e,t){this.$.addOrganizationAjax.body={},this.$.addOrganizationAjax.url="/api/organizations/"+e.target.id+"/"+this.userIdForSelectingOrganization+"/add_user",this.$.addOrganizationAjax.generateRequest(),this.$.selectOrganizationDialog.close()},_removeAdmin:function(e){var t=e.target.getAttribute("data-args");this.$.removeAdminAjax.body={},"groups"==this.modelType&&this.groupId?(this.$.removeAdminAjax.url="/api/"+this.modelType+"/"+this.groupId+"/"+t+"/remove_admin",this.$.removeAdminAjax.generateRequest()):"communities"==this.modelType&&this.communityId?(this.$.removeAdminAjax.url="/api/"+this.modelType+"/"+this.communityId+"/"+t+"/remove_admin",this.$.removeAdminAjax.generateRequest()):console.warn("Can't find model type or ids")},_removeUser:function(e){var t=e.target.getAttribute("data-args");this.$.removeUserAjax.body={},"groups"==this.modelType&&this.groupId?(this.$.removeUserAjax.url="/api/"+this.modelType+"/"+this.groupId+"/"+t+"/remove_user",this.$.removeUserAjax.generateRequest()):"communities"==this.modelType&&this.communityId?(this.$.removeUserAjax.url="/api/"+this.modelType+"/"+this.communityId+"/"+t+"/remove_user",this.$.removeUserAjax.generateRequest()):console.warn("Can't find model type or ids")},_addAdmin:function(e){this.$.addAdminAjax.body={},"groups"==this.modelType&&this.groupId?(this.$.addAdminAjax.url="/api/"+this.modelType+"/"+this.groupId+"/"+this.addAdminEmail+"/add_admin",this.$.addAdminAjax.generateRequest()):"communities"==this.modelType&&this.communityId?(this.$.addAdminAjax.url="/api/"+this.modelType+"/"+this.communityId+"/"+this.addAdminEmail+"/add_admin",this.$.addAdminAjax.generateRequest()):console.warn("Can't find model type or ids")},_inviteUser:function(e){this.$.inviteUserAjax.body={},"groups"==this.modelType&&this.groupId?(this.$.inviteUserAjax.url="/api/"+this.modelType+"/"+this.groupId+"/"+this.inviteUserEmail+"/invite_user",this.$.inviteUserAjax.generateRequest()):"communities"==this.modelType&&this.communityId?(this.$.inviteUserAjax.url="/api/"+this.modelType+"/"+this.communityId+"/"+this.inviteUserEmail+"/invite_user",this.$.inviteUserAjax.generateRequest()):console.warn("Can't find model type or ids")},_removeAdminResponse:function(){window.appGlobals.notifyUserViaToast(this.t("users.adminRemoved")),this.$.ajax.generateRequest()},_removeUserResponse:function(){window.appGlobals.notifyUserViaToast(this.t("users.userRemoved")),this.$.ajax.generateRequest()},_addAdminResponse:function(){window.appGlobals.notifyUserViaToast(this.t("users.adminAdded")+" "+this.addAdminEmail),this.set("addAdminEmail",null),this.$.ajax.generateRequest()},_addOrganizationResponse:function(e,t){window.appGlobals.notifyUserViaToast(this.t("users.organizationUserAdded")+" "+t.response.email),this.$.ajax.generateRequest()},_removeOrganizationResponse:function(e,t){window.appGlobals.notifyUserViaToast(this.t("users.organizationUserRemoved")+" "+t.response.email),this.$.ajax.generateRequest()},_inviteUserResponse:function(){window.appGlobals.notifyUserViaToast(this.t("users.userInvited")+" "+this.inviteUserEmail),this.set("inviteUserEmail",null),this.$.ajax.generateRequest()},_domainIdChanged:function(e){e&&(this.set("modelType","domains"),this._generateRequest(e))},_groupIdChanged:function(e){e&&(this.set("modelType","groups"),this._generateRequest(e))},_communityIdChanged:function(e){e&&(this.set("modelType","communities"),this._generateRequest(e))},_generateRequest:function(e){var t=this.adminUsers?"admin_users":"users";this.$.ajax.url="/api/"+this.modelType+"/"+e+"/"+t,this.$.ajax.generateRequest()},_usersResponse:function(e,t){this.set("users",t.response)},setup:function(e,t,i,s){this.set("groupId",null),this.set("communityId",null),this.set("domainId",null),this.set("users",null),this.set("adminUsers",s),e&&this.set("groupId",e),t&&this.set("communityId",t),i&&this.set("domainId",i),this._setupHeaderText()},open:function(){this.set("opened",!0),this.$.dialog.open()},_setupHeaderText:function(){this.groupId?this.adminUsers?this.set("headerText",this.t("group.admins")):this.set("headerText",this.t("group.users")):this.communityId?this.adminUsers?this.set("headerText",this.t("community.admins")):this.set("headerText",this.t("community.users")):this.domainId&&(this.adminUsers?this.set("headerText",this.t("domain.admins")):this.set("headerText",this.t("domain.users")))},ready2:function(){},_adminActionRenderer:function(e){e.element.innerHTML="";var t=document.createElement("progress");t.setAttribute("value",e.data),e.element.appendChild(t)},_onSelect:function(){0===this.$.grid.selection.selected().length?this.selected=null:this.selected=this.users[this.$.grid.selection.selected()]}});</script></dom-module><dom-module id="yp-pages-grid" assetpath="../yp-page/"><template><style include="iron-flex iron-flex-alignment">#dialog{width:90%;max-height:90%;background-color:#FFF}iron-list{color:#000;height:500px;width:100%}.pageItem{padding-right:16px}.id{width:60px}.title{width:200px}.email{width:240px}#editPageLocale{width:80%;max-height:80%;background-color:#FFF}.locale{width:30px;cursor:pointer}paper-textarea{height:60%}.localeInput{width:26px}.pageItem{padding-top:8px}[hidden]{display:none!important}</style><lite-signal on-lite-signal-yp-language="_languageEvent"></lite-signal><paper-dialog id="editPageLocale" modal="" class="layout vertical"><h2>[[t('pages.editPageLocale')]]</h2><paper-dialog-scrollable><paper-input id="title" name="title" type="text" label="[[t('pages.title')]]" value="{{currentlyEditingTitle}}" maxlength="60" char-counter="" class="mainInput"></paper-input><paper-textarea id="content" name="content" value="{{currentlyEditingContent}}" always-float-label="[[currentlyEditingContent]]" label="[[t('pages.content')]]" rows="7" max-rows="10"></paper-textarea></paper-dialog-scrollable><div class="buttons"><paper-button on-tap="_closePageLocale" dialog-dismiss="">[[t('close')]]</paper-button><paper-button on-tap="_updatePageLocale" dialog-dismiss="">[[t('save')]]</paper-button></div></paper-dialog><paper-dialog id="dialog"><h2>[[headerText]]</h2><iron-list items="[[pages]]" as="page"><template><div class="layout horizontal"><div class="pageItem id">[[page.id]]</div><div class="pageItem title">[[page.title.en]]</div><template is="dom-repeat" items="[[_toLocaleArray(page.title)]]" class="pageItem"><div class="layout vertical center-center"><a class="locale" data-args-page$="[[page]]" data-args-locale$="[[item.locale]]" on-tap="_editPageLocale">[[item.locale]]</a></div></template><paper-input no-label-float="" class="localeInput" length="2" maxlength="2" value="{{newLocaleValue}}"></paper-input><paper-button data-args$="[[page.id]]" on-tap="_addLocale">[[t('pages.addLocale')]]</paper-button><div hidden$="[[page.published]]"><paper-button data-args$="[[page.id]]" on-tap="_publishPage">[[t('pages.publish')]]</paper-button></div><div hidden$="[[!page.published]]"><paper-button data-args$="[[page.id]]" on-tap="_unPublishPage">[[t('pages.unPublish')]]</paper-button></div><paper-button data-args$="[[page.id]]" on-tap="_deletePage">[[t('pages.deletePage')]]</paper-button></div></template></iron-list><div class="layout horizontal"><paper-button id="addPageButton" on-tap="_addPage">[[t('pages.addPage')]]</paper-button></div><div class="buttons"><paper-button dialog-dismiss="">[[t('close')]]</paper-button></div></paper-dialog><div class="layout horizontal center-center"><yp-ajax id="ajax" on-response="_pagesResponse"></yp-ajax><yp-ajax method="POST" id="newPageAjax" on-response="_newPageResponse"></yp-ajax><yp-ajax method="DELETE" id="deletePageAjax" on-response="_deletePageResponse"></yp-ajax><yp-ajax method="PUT" id="updatePageAjax" on-response="_updatePageResponse"></yp-ajax><yp-ajax method="PUT" id="publishPageAjax" on-response="_publishPageResponse"></yp-ajax><yp-ajax method="PUT" id="unPublishPageAjax" on-response="_unPublishPageResponse"></yp-ajax></div></template><script>Polymer({is:"yp-pages-grid",behaviors:[Polymer.ypLanguageBehavior,Polymer.WordWrap],properties:{pages:{type:Array,notify:!0},headerText:{type:String},groupId:{type:Number,observer:"_groupIdChanged"},domainId:{type:Number,observer:"_domainIdChanged"},communityId:{type:Number,observer:"_communityIdChanged"},selected:{type:Object},modelType:{type:String},newLocaleValue:{type:String},currentlyEditingLocale:{type:String},currentlyEditingPage:{type:Object},currentlyEditingTitle:{type:String},currentlyEditingContent:{type:String}},_toLocaleArray:function(e){var t=Object.keys(e).map(function(t){return{locale:t,value:e[t]}});return __.sortBy(t,function(e){return e.item})},_editPageLocale:function(e){this.set("currentlyEditingPage",JSON.parse(e.target.getAttribute("data-args-page"))),this.set("currentlyEditingLocale",e.target.getAttribute("data-args-locale")),this.set("currentlyEditingContent",this.wordwrap(120)(this.currentlyEditingPage.content[this.currentlyEditingLocale])),this.set("currentlyEditingTitle",this.currentlyEditingPage.title[this.currentlyEditingLocale]),this.$.editPageLocale.open()},_closePageLocale:function(){this.set("currentlyEditingPage",null),this.set("currentlyEditingLocale",null),this.set("currentlyEditingContent",null),this.set("currentlyEditingTitle",null)},_dispatchAjax:function(e,t,a){var i;i=t?"/"+t+"/"+a:"/"+a,"groups"==this.modelType&&this.groupId?(e.url="/api/"+this.modelType+"/"+this.groupId+i,e.generateRequest()):"communities"==this.modelType&&this.communityId?(e.url="/api/"+this.modelType+"/"+this.communityId+i,e.generateRequest()):"domains"==this.modelType&&this.domainId?(e.url="/api/"+this.modelType+"/"+this.domainId+i,e.generateRequest()):console.warn("Can't find model type or ids")},_updatePageLocale:function(){this.$.updatePageAjax.body={locale:this.currentlyEditingLocale,content:this.currentlyEditingContent,title:this.currentlyEditingTitle},this._dispatchAjax(this.$.updatePageAjax,this.currentlyEditingPage.id,"update_page_locale"),this._closePageLocale()},_publishPage:function(e){this.$.updatePageAjax.body={};var t=e.target.getAttribute("data-args");this._dispatchAjax(this.$.updatePageAjax,t,"publish_page")},_publishPageResponse:function(){window.appGlobals.notifyUserViaToast(this.t("pages.pagePublished")),this.$.ajax.generateRequest()},_unPublishPage:function(e){this.$.updatePageAjax.body={};var t=e.target.getAttribute("data-args");this._dispatchAjax(this.$.updatePageAjax,t,"un_publish_page")},_unPublishPageResponse:function(){window.appGlobals.notifyUserViaToast(this.t("pages.pageUnPublished")),this.$.ajax.generateRequest()},_deletePage:function(e){this.$.deletePageAjax.body={};var t=e.target.getAttribute("data-args");this._dispatchAjax(this.$.deletePageAjax,t,"delete_page")},_deletePageResponse:function(){window.appGlobals.notifyUserViaToast(this.t("pages.pageDeleted")),this.$.ajax.generateRequest()},_addLocale:function(e){if(this.newLocaleValue&&this.newLocaleValue.length>1){var t=e.target.getAttribute("data-args");this.$.updatePageAjax.body={locale:this.newLocaleValue.toLowerCase(),content:"",title:""},this._dispatchAjax(this.$.updatePageAjax,t,"update_page_locale"),this.set("newLocaleValue",null)}},_addPage:function(e){this.$.newPageAjax.body={},this.$.addPageButton.disabled=!0,this._dispatchAjax(this.$.newPageAjax,null,"add_page")},_newPageResponse:function(){window.appGlobals.notifyUserViaToast(this.t("pages.newPageCreated")),this.$.ajax.generateRequest(),this.$.addPageButton.disabled=!1},_updatePageResponse:function(){window.appGlobals.notifyUserViaToast(this.t("posts.updated")),this.$.ajax.generateRequest()},_domainIdChanged:function(e){e&&(this.set("modelType","domains"),this._generateRequest(e))},_groupIdChanged:function(e){e&&(this.set("modelType","groups"),this._generateRequest(e))},_communityIdChanged:function(e){e&&(this.set("modelType","communities"),this._generateRequest(e))},_generateRequest:function(e){this.$.ajax.url="/api/"+this.modelType+"/"+e+"/pages_for_admin",this.$.ajax.generateRequest()},_pagesResponse:function(e,t){this.set("pages",t.response)},setup:function(e,t,a,i){this.set("groupId",null),this.set("communityId",null),this.set("domainId",null),this.set("pages",null),e&&this.set("groupId",e),t&&this.set("communityId",t),a&&this.set("domainId",a),this._setupHeaderText()},open:function(){this.$.dialog.open()},_setupHeaderText:function(){this.groupId?this.set("headerText",this.t("group.pages")):this.communityId?this.set("headerText",this.t("community.pages")):this.domainId&&this.set("headerText",this.t("domain.pages"))}});</script></dom-module><dom-module id="yp-organization-edit" assetpath="../yp-organization/"><template><style include="iron-flex iron-flex-alignment">.access{@apply --layout-horizontal;@apply --layout-center-justified;}.accessHeader{color:var(--primary-color,#777);font-weight:400;margin-bottom:0}paper-radio-button{display:block}.additionalSettings{padding-top:16px}.half{width:50%}</style><lite-signal on-lite-signal-yp-language="_languageEvent"></lite-signal><yp-edit-dialog id="editDialog" title="[[editHeaderText]]" icon="business-center" action="[[action]]" method="[[method]]" params="[[params]]" save-text="[[saveText]]" toast-text="[[toastText]]"><h2 slot="h2">[[editHeaderText]]</h2><div class="layout vertical"><paper-input id="name" name="name" type="text" label="[[t('name')]]" value="{{organization.name}}" maxlength="60" char-counter="" class="mainInput"></paper-input><paper-textarea id="description" name="description" value="{{organization.description}}" always-float-label="[[organization.description]]" label="[[t('description')]]" char-counter="" rows="2" max-rows="5" maxlength="300" class="mainInput"></paper-textarea><paper-input id="website" name="website" type="text" label="[[t('website')]]" value="{{organization.website}}" maxlength="256" char-counter="" class="mainInput"></paper-input></div><div class="layout horizontal"><div class="layout vertical additionalSettings half"><yp-file-upload id="logoImageUpload" raised="true" multi="false" target="/api/images?itemType=organization-logo" method="POST" on-success="_logoImageUploaded"><iron-icon class="icon" icon="photo-camera"></iron-icon><span>[[t('image.logo.upload')]]</span></yp-file-upload></div><div class="layout vertical additionalSettings half"><yp-file-upload id="headerImageUpload" raised="true" multi="false" target="/api/images?itemType=organization-header" method="POST" on-success="_headerImageUploaded"><iron-icon class="icon" icon="photo-camera"></iron-icon><span>[[t('image.header.upload')]]</span></yp-file-upload></div></div><input type="hidden" name="uploadedLogoImageId" value="[[uploadedLogoImageId]]"> <input type="hidden" name="uploadedHeaderImageId" value="[[uploadedHeaderImageId]]"><h3 class="accessHeader">[[t('Access')]]</h3><paper-radio-group id="access" name="access" class="access" selected="{{organizationAccess}}"><paper-radio-button name="public">[[t('public')]]</paper-radio-button><paper-radio-button name="closed">[[t('closed')]]</paper-radio-button><paper-radio-button name="secret">[[t('secret')]]</paper-radio-button></paper-radio-group></yp-edit-dialog></template></dom-module><script>Polymer({is:"yp-organization-edit",behaviors:[Polymer.ypLanguageBehavior,Polymer.ypEditDialogBehavior,Polymer.ypGotoBehavior],properties:{action:{type:String,value:"/api/organizations"},organization:{type:Object,observer:"_organizationChanged"},organizationAccess:{type:String,value:"public"},params:{type:String},method:{type:String},uploadedLogoImageId:{type:String},uploadedHeaderImageId:{type:String}},_customRedirect:function(t){t||console.warn("No organization found on custom redirect")},_organizationChanged:function(t,e){0===this.organization.access?this.organizationAccess="public":1===this.organization.access?this.organizationAccess="closed":2===this.organization.access&&(this.organizationAccess="secret")},_clear:function(){this.set("organization",{name:"",description:"",access:0}),this.set("uploadedLogoImageId",null),this.set("uploadedHeaderImageId",null),this.$.headerImageUpload.clear(),this.$.logoImageUpload.clear()},setup:function(t,e,i){t?this.set("organization",t):this.set("organization",{name:"",description:"",access:0}),this.set("new",e),this.set("refreshFunction",i),this._setupTranslation()},_setupTranslation:function(){this.new?(this.set("editHeaderText",this.t("organization.new")),this.set("toastText",this.t("organization.toast.created")),this.set("saveText",this.t("create"))):(this.set("editHeaderText",this.t("Update organization info")),this.set("toastText",this.t("organization.toast.updated")),this.set("saveText",this.t("update")))}});</script><dom-module id="yp-organizations-grid" assetpath="../yp-organization/"><template><style include="iron-flex iron-flex-alignment">#dialog{width:90%;max-height:90%;background-color:#FFF}iron-list{color:#000;height:500px;width:100%}.pageItem{padding-right:16px}.id{width:60px}.title{width:200px}.email{width:240px}#editPageLocale{width:80%;max-height:80%;background-color:#FFF}.locale{width:30px;cursor:pointer}paper-textarea{height:60%}.localeInput{width:26px}.pageItem{padding-top:8px}[hidden]{display:none!important}</style><lite-signal on-lite-signal-yp-language="_languageEvent"></lite-signal><paper-dialog id="selectOrganizationDialog" modal=""><h2>[[t('users.selectOrganization')]]</h2><paper-dialog-scrollable><paper-listbox><template is="dom-repeat" items="[[availableOrganizations]]"><paper-item on-tap="_selectOrganization" id="[[item.id]]">[[item.name]]</paper-item></template></paper-listbox></paper-dialog-scrollable><div class="buttons"><paper-button dialog-dismiss="">[[t('Close')]]</paper-button></div></paper-dialog><paper-dialog id="dialog"><h2>[[headerText]]</h2><paper-dialog-scrollable><iron-list items="[[availableOrganizations]]" as="organization"><template><div class="layout horizontal"><div class="pageItem id">[[organization.name]]</div><div class="pageItem title">[[_organizationImageUrl(organization)]]</div><paper-button data-args$="[[organization]]" on-tap="_editOrganization">[[t('update')]]</paper-button></div></template></iron-list><iron-list items="[[users]]" as="user"><template><div class="layout horizontal"><div class="userItem id">[[user.id]]</div><div class="userItem name">[[user.name]]</div><div class="userItem email">[[user.email]]</div><template is="dom-if" if="[[!_userOrganizationName(user)]]"><div class="organization"><paper-button data-args$="[[user.id]]" on-tap="_addToOrganization">[[t('users.addToOrganization')]]</paper-button></div></template><div class="organization" hidden$="[[!_userOrganizationName(user)]]"><div class="organizationName">[[_userOrganizationName(user)]]</div><paper-button data-args$="[[user.id]]" data-args-org$="[[_userOrganizationId(user)]]" on-tap="_removeFromOrganization">[[t('users.removeFromOrganization')]]</paper-button></div></div></template></iron-list></paper-dialog-scrollable><div class="buttons"><paper-button dialog-dismiss="">[[t('close')]]</paper-button></div></paper-dialog><div class="layout horizontal center-center"><yp-ajax method="DELETE" id="removeOrganizationAjax" on-response="_removeOrganizationResponse"></yp-ajax><yp-ajax method="POST" id="addOrganizationAjax" on-response="_addOrganizationResponse"></yp-ajax></div></template><script>Polymer({is:"yp-organizations-grid",behaviors:[Polymer.ypLanguageBehavior,Polymer.WordWrap,Polymer.ypImageFormatsBehavior],properties:{organizations:{type:Array,notify:!0},availableOrganizations:{type:Array},headerText:{type:String},selected:{type:Object}},_newOrganization:function(){Polymer.dom(document).querySelector("yp-app").getDialogAsync("organizationEdit",function(a){a.setup(null,!0,null),a.open("new",{})}.bind(this))},_editOrganization:function(a){var i=JSON.parse(a.target.getAttribute("data-args"));Polymer.dom(document).querySelector("yp-app").getDialogAsync("organizationEdit",function(a){a._clear(),a.setup(i,!1,null),a.open("edit",{organizationId:i.id})}.bind(this))},_organizationImageUrl:function(a){return a.OrganizationLogoImages?this.getImageFormatUrl(a.OrganizationLogoImages,2):null},_availableOrganizations:function(){return window.appUser.adminRights&&window.appUser.adminRights.OrganizationAdmins?window.appUser.adminRights.OrganizationAdmins:[]},_addToOrganization:function(a){this.set("userIdForSelectingOrganization",a.target.getAttribute("data-args")),this.$.selectOrganizationDialog.open()},_removeFromOrganization:function(a){var i=a.target.getAttribute("data-args"),t=a.target.getAttribute("data-args-org");this.$.removeOrganizationAjax.body={},this.$.removeOrganizationAjax.url="/api/organizations/"+t+"/"+i+"/remove_user",this.$.removeOrganizationAjax.generateRequest()},_selectOrganization:function(a,i){this.$.addOrganizationAjax.body={},this.$.addOrganizationAjax.url="/api/organizations/"+a.target.id+"/"+this.userIdForSelectingOrganization+"/add_user",this.$.addOrganizationAjax.generateRequest(),this.$.selectOrganizationDialog.close()},_addOrganizationResponse:function(a,i){window.appGlobals.notifyUserViaToast(this.t("users.organizationUserAdded")+" "+i.response.email),this.$.ajax.generateRequest()},_removeOrganizationResponse:function(a,i){window.appGlobals.notifyUserViaToast(this.t("users.organizationUserRemoved")+" "+i.response.email),this.$.ajax.generateRequest()},open:function(){this.set("availableOrganizations",this._availableOrganizations()),this.$.dialog.open()}});</script></dom-module><dom-module id="yp-domain-edit" assetpath="../yp-domain/"><template><style include="iron-flex iron-flex-alignment">.additionalSettings{padding-top:8px;margin-top:8px}yp-theme-selector{padding-top:8px;margin-bottom:8px}.imageSizeInfo{font-size:13px}.sectionMargin{margin-top:8px}.container{width:100%;height:100%}yp-language-selector{margin-top:8px}paper-checkbox{margin-top:4px}</style><lite-signal on-lite-signal-yp-language="_languageEvent"></lite-signal><yp-edit-dialog double-width="" id="editDialog" title="[[editHeaderText]]" icon="cloud-queue" action="[[action]]" method="[[method]]" params="[[params]]" save-text="[[saveText]]" toast-text="[[toastText]]"><div><paper-input id="name" name="name" type="text" label="[[t('Name')]]" value="{{domain.name}}" maxlength="60" char-counter="" class="mainInput"></paper-input><paper-textarea id="description" name="description" value="{{domain.description}}" always-float-label="[[domain.description]]" label="[[t('Description')]]" char-counter="" rows="2" max-rows="5" maxlength="300" class="mainInput"></paper-textarea><div class="horizontal end-justified layout"><emoji-selector id="emojiSelectorDescription"></emoji-selector></div><div class="layout vertical"><yp-theme-selector object="[[domain]]" selected-theme="{{themeId}}"></yp-theme-selector></div><div class="layout vertical additionalSettings"><yp-file-upload id="logoImageUpload" raised="true" multi="false" target="/api/images?itemType=domain-logo" method="POST" on-success="_logoImageUploaded"><iron-icon class="icon" icon="photo-camera"></iron-icon><span>[[t('image.logo.upload')]] - 864 x 486</span><br></yp-file-upload></div><div class="layout vertical additionalSettings"><yp-file-upload id="headerImageUpload" raised="true" multi="false" target="/api/images?itemType=domain-header" method="POST" on-success="_headerImageUploaded"><iron-icon class="icon" icon="photo-camera"></iron-icon><span>[[t('image.header.upload')]] - 1920 x 600</span><br></yp-file-upload></div><paper-input id="customUserRegistrationText" name="customUserRegistrationText" type="text" label="[[t('customUserRegistrationText')]]" value="{{domain.configuration.customUserRegistrationText}}" maxlength="256" char-counter=""></paper-input><paper-input id="appHomeScreenShortName" name="appHomeScreenShortName" type="text" label="[[t('appHomeScreenShortName')]]" value="{{domain.configuration.appHomeScreenShortName}}" maxlength="12" style="width:200px"></paper-input><div class="layout vertical additionalSettings half"><yp-file-upload id="appHomeScreenIconImageUpload" raised="true" multi="false" target="/api/images?itemType=app-home-screen-icon" method="POST" on-success="_appHomeScreenIconImageUploaded"><iron-icon class="icon" icon="photo-camera"></iron-icon><span>[[t('appHomeScreenIconImageUpload')]]</span></yp-file-upload></div><input type="hidden" name="themeId" value="[[themeId]]"> <input type="hidden" name="uploadedLogoImageId" value="[[uploadedLogoImageId]]"> <input type="hidden" name="uploadedHeaderImageId" value="[[uploadedHeaderImageId]]"> <input type="hidden" name="appHomeScreenIconImageId" value="[[appHomeScreenIconImageId]]"><br><yp-language-selector name="defaultLocale" no-user-events="" selected-locale="{{domain.default_locale}}"></yp-language-selector><paper-checkbox name="onlyAdminsCanCreateCommunities" checked$="{{domain.only_admins_can_create_communities}}">[[t('domain.onlyAdminsCanCreateCommunities')]]</paper-checkbox><paper-input id="facebookClientId" name="facebookClientId" type="text" label="Facebook Client Id" value="{{domain.secret_api_keys.facebook.client_id}}" maxlength="60" char-counter="" class="mainInput"></paper-input><paper-input id="facebookClientSecret" name="facebookClientSecret" type="text" label="Facebook Client Secret" value="{{domain.secret_api_keys.facebook.client_secret}}" maxlength="60" char-counter="" class="mainInput"></paper-input><paper-input id="googleClientId" name="googleClientId" type="text" label="Google Client Id" value="{{domain.secret_api_keys.google.client_id}}" maxlength="60" char-counter="" class="mainInput"></paper-input><paper-input id="googleClientSecret" name="googleClientSecret" type="text" label="Google Client Secret" value="{{domain.secret_api_keys.google.client_secret}}" maxlength="60" char-counter="" class="mainInput"></paper-input><paper-input id="samlEntryPoint" name="samlEntryPoint" type="text" label="SAML EntryPoint" value="{{domain.secret_api_keys.saml.entryPoint}}" maxlength="100" char-counter="" class="mainInput"></paper-input><paper-input id="samlCallbackUrl" name="samlCallbackUrl" type="text" label="SAML CallbackUrl" value="{{domain.secret_api_keys.saml.callbackUrl}}" maxlength="100" char-counter="" class="mainInput"></paper-input><paper-textarea id="samlCert" name="samlCert" value="{{domain.secret_api_keys.saml.cert}}" always-float-label="[[domain.secret_api_keys.saml.cert]]" label="SAML Verification Certificate Chain" char-counter="" rows="2" max-rows="5" maxlength="20000" class="mainInput"></paper-textarea><div class="layout vertical"><paper-checkbox name="downloadFacebookImagesForUser" checked$="{{domain.configuration.downloadFacebookImagesForUser}}">[[t('downloadFacebookImagesForUser')]]</paper-checkbox><paper-checkbox name="disableNameAutoTranslation" checked$="{{domain.configuration.disableNameAutoTranslation}}">[[t('disableNameAutoTranslation')]]</paper-checkbox></div></div></yp-edit-dialog></template></dom-module><script>Polymer({is:"yp-domain-edit",behaviors:[Polymer.ypLanguageBehavior,Polymer.ypEditDialogBehavior,Polymer.ypGotoBehavior],properties:{action:{type:String,value:"/api/domains"},domain:{type:Object,observer:"_domainChanged",notify:!0},params:{type:String},selected:{type:Number,value:0},method:{type:String},uploadedLogoImageId:{type:String},uploadedHeaderImageId:{type:String},themeId:{type:String,value:null},status:{type:String},appHomeScreenIconImageId:String},observers:["_setupTranslation(language,t)"],_appHomeScreenIconImageUploaded:function(e,t){var i=JSON.parse(t.xhr.response);this.set("appHomeScreenIconImageId",i.id)},_updateEmojiBindings:function(){this.async(function(){var e=this.$$("#description"),t=this.$$("#emojiSelectorDescription");e&&t?t.inputTarget=e:console.warn("Domain edit: Can't bind emojis :(")}.bind(this),500)},_domainChanged:function(e){this._updateEmojiBindings()},_customRedirect:function(e){this.new&&this.redirectTo("/domain/"+e.id)},_clear:function(){this.set("domain",{name:"",description:""}),this.set("uploadedLogoImageId",null),this.set("uploadedHeaderImageId",null),this.set("appHomeScreenIconImageId",null),this.$.headerImageUpload.clear(),this.$.logoImageUpload.clear()},setup:function(e,t,i){this.set("domain",e),this.set("new",t),this.set("refreshFunction",i),this._setupTranslation()},_setupTranslation:function(){this.new?(this.editHeaderText=this.t("domain.new"),this.toastText=this.t("domainToastCreated"),this.set("saveText",this.t("create"))):(this.set("saveText",this.t("save")),this.editHeaderText=this.t("domain.edit"),this.toastText=this.t("domainToastUpdated"))}});</script><dom-module id="yp-post-status-change-edit" assetpath="../yp-post/"><template><style include="iron-flex iron-flex-alignment">.additionalSettings{padding-top:16px}paper-textarea{padding-top:16px}</style><lite-signal on-lite-signal-yp-language="_languageEvent"></lite-signal><yp-edit-dialog id="editDialog" title="[[editHeaderText]]" double-width="" icon="language" confirmation-text="[[t('post.statusChangeConfirmText')]]" action="[[action]]" method="[[method]]" params="[[params]]" save-text="[[saveText]]" toast-text="[[toastText]]"><div class="layout horizontal center-center"><paper-dropdown-menu label="[[t('post.statusChangeSelectNewStatus')]]"><paper-listbox slot="dropdown-content" attr-for-selected="name" selected="{{officialStatus}}"><template is="dom-repeat" items="[[officialStatusOptions]]" as="statusOption"><paper-item name="[[statusOption.official_value]]">[[statusOption.translatedName]]</paper-item></template></paper-listbox></paper-dropdown-menu><input type="hidden" name="official_status" value="[[officialStatus]]"></div><div class="layout vertical"><paper-textarea id="content" name="content" value="{{postStatusChange.content}}" always-float-label="[[postStatusChange.content]]" label="[[t('post.statusChangeContent')]]" char-counter="" rows="10" max-rows="10" maxlength="100000" class="mainInput"></paper-textarea></div></yp-edit-dialog></template></dom-module><script>Polymer({is:"yp-post-status-change-edit",behaviors:[Polymer.ypLanguageBehavior,Polymer.ypEditDialogBehavior,Polymer.ypOfficialStatusOptions],properties:{action:{type:String,value:"/api/posts"},post:{type:Object,observer:"_postChanged"},params:{type:String},method:{type:String},officialStatus:Number,postStatusChange:Object},_postChanged:function(t,s){t&&this.set("officialStatus",this.post.official_status)},_clear:function(){this.set("postStatusChange",{content:""}),this.set("post",null)},setup:function(t,s,e){this.set("post",t),s?this.set("postStatusChange",s):this.set("postStatusChange",{content:""}),this.set("refreshFunction",e),this._setupTranslation()},_setupTranslation:function(){this.set("editHeaderText",this.t("post.statusChange")),this.set("toastText",this.t("post.statusChangeSent")),this.set("saveText",this.t("post.statusChange"))}});</script><dom-module id="yp-post-move" assetpath="../yp-post/"><template><style include="iron-flex iron-flex-alignment">.additionalSettings{padding-top:16px}paper-textarea{padding-top:16px}.groupName{cursor:pointer}</style><lite-signal on-lite-signal-yp-language="_languageEvent"></lite-signal><yp-edit-dialog id="editDialog" title="[[editHeaderText]]" icon="language" confirmation-text="[[t('post.statusChangeConfirmText')]]" action="[[action]]" method="[[method]]" params="[[params]]" save-text="[[saveText]]" toast-text="[[toastText]]"><template is="dom-repeat" items="[[availableGroups]]" as="group"><div class="groupName" on-tap="_selectGroup" data-args$="[[group.id]]" data-args-name$="[[group.name]]">[[group.name]]</div></template><div class="layout horizontal center-center"><yp-ajax method="GET" id="getAvailableGroupsAjax" url="/api/users/available/groups" on-response="_getGroupsResponse"></yp-ajax><yp-ajax method="PUT" id="movePostAjax" on-response="_movePostResponse"></yp-ajax></div></yp-edit-dialog></template></dom-module><script>Polymer({is:"yp-post-move",behaviors:[Polymer.ypLanguageBehavior,Polymer.ypEditDialogBehavior,Polymer.AccessHelpers,Polymer.ypPostMoveBehavior],properties:{action:{type:String,value:"/api/posts"},post:{type:Object},selectedGroupId:Number},_selectGroup:function(t){this.set("selectedGroupId",t.target.getAttribute("data-args"));var e=t.target.getAttribute("data-args-name");Polymer.dom(document).querySelector("yp-app").getDialogAsync("confirmationDialog",function(t){t.open(this.t("post.confirmMove")+' "'+this.post.name+'" '+this.t("to")+' "'+e+'"',this._reallyMove.bind(this))}.bind(this))},_reallyMove:function(){this.$.movePostAjax.url="/api/posts/"+this.post.id+"/"+this.selectedGroupId+"/move",this.$.movePostAjax.body={},this.$.movePostAjax.generateRequest()},_movePostResponse:function(){location.reload()},_clear:function(){this.set("selectedGroupId",null),this.set("post",null)},setupAndOpen:function(t,e){this.set("post",t),this.set("refreshFunction",e),this._setupTranslation(),this.$.getAvailableGroupsAjax.generateRequest(),this.open()},_setupTranslation:function(){this.set("editHeaderText",this.t("post.move")),this.set("toastText",this.t("post.haveMovedPost")),this.set("saveText",this.t("post.move"))}});</script></div>