<html><head><link rel="import" href="../../bower_components/polymer/polymer.html"><link rel="import" href="../../bower_components/iron-flex-layout/iron-flex-layout-classes.html"><link rel="import" href="../../bower_components/iron-signals/iron-signals.html"><link rel="import" href="../../bower_components/paper-input/paper-input.html"><link rel="import" href="../../bower_components/paper-input/paper-textarea.html"><link rel="import" href="../yp-file-upload/yp-file-upload.html"><link rel="import" href="../yp-behaviors/app-helpers.html"><link rel="import" href="../yp-edit-dialog/yp-edit-dialog.html"><link rel="import" href="../yp-edit-dialog/yp-edit-dialog-behavior.html"></head><body><dom-module id="yp-post-user-image-edit"><template><style include="iron-flex iron-flex-alignment"></style><iron-signals on-iron-signal-yp-language="_languageEvent"></iron-signals><yp-edit-dialog double-width="" id="editDialog" icon="photo-camera" action="[[action]]" method="[[method]]" save-text="[[saveText]]" next-action-text="[[t('next')]]" toast-text="[[toastText]]" params="[[params]]"><h2 slot="h2">[[editHeaderText]]</h2><div class="layout vertical center-center"><yp-file-upload id="imageFileUpload" raised="true" multi="false" method="POST" on-success="_imageUploaded"><iron-icon class="icon" icon="photo-camera"></iron-icon><span>[[t('image.upload')]]</span></yp-file-upload></div><paper-input id="photographerName" name="photographerName" type="text" label="[[t('post.photographerName')]]" value="{{image.photographer_name}}" maxlength="60" char-counter=""></paper-input><paper-textarea id="description" required="" minlength="15" name="description" value="{{image.description}}" label="[[t('post.description')]]" char-counter="" rows="2" max-rows="5" maxlength="200"></paper-textarea><input type="hidden" name="uploadedPostUserImageId" value="[[uploadedPostUserImageId]]"> <input type="hidden" name="oldUploadedPostUserImageId" value="[[oldUploadedPostUserImageId]]"></yp-edit-dialog></template><script>(function(){Polymer({is:'yp-post-user-image-edit',behaviors:[Polymer.appHelpers,Polymer.ypEditDialogBehavior],properties:{new:{type:Boolean,value:!1},image:{type:Object,observer:'_imageChanged'},post:{type:Object,observer:'_postChange'},action:{type:String,value:'/api/images'},imageUploadTarget:{type:String,notify:!0},uploadedPostUserImageId:{type:String},oldUploadedPostUserImageId:{type:String},editHeaderText:{type:String},saveText:{type:String},method:{type:String}},_postChange:function(a){a&&(this.$.imageFileUpload.target='/api/images?itemType=post-user-image&postId='+a.id)},listeners:{"iron-form-invalid":'_formInvalid'},_imageChanged:function(a){a&&this.set('oldUploadedPostUserImageId',a.id)},_formInvalid:function(){this.set('selected',0),this.$$('#photographerName').autoValidate=!0,this.$$('#description').autoValidate=!0},_imageUploaded:function(a,b){var c=JSON.parse(b.xhr.response);this.set('uploadedPostUserImageId',c.id)},_clear:function(){this.set('uploadedPostUserImageId',null),this.$$('#imageFileUpload').clear()},setup:function(a,b,c,d){b?this.set('image',b):this.set('image',{description:'',photographerName:''}),a?this.set('post',a):this.set('post',null),this.set('new',c),this.set('refreshFunction',d),this._setupTranslation()},_setupTranslation:function(){this.new?(this.editHeaderText=this.t('post.newPhoto'),this.toastText=this.t('post.photo.toast.added')):(this.editHeaderText=this.t('post.photoUpdate'),this.toastText=this.t('post.photo.toast.updated'))}})})();</script></dom-module></body></html>