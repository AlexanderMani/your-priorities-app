<body><dom-module id="yp-dialog-ratings"><template><style include="iron-flex iron-flex-alignment">paper-dialog{background-color:#fff;width:400px}.ratingName{font-weight:700;font-size:16px;margin-bottom:8px;margin-top:8px}.itemHeader{font-size:22px;color:#fff;background-color:var(--accent-color);margin-top:0;margin-bottom:0;padding:0;text-align:center;padding-bottom:10px;padding-top:10px;width:100%}.itemName{font-size:18px;font-weight:700;color:#000;margin-top:0;margin-bottom:0;text-align:center;padding:16px;padding-bottom:10px;padding-top:16px;text-decoration:underline}.evalIcon{margin-right:8px;padding-top:8px;width:40px;height:40px}.itemContainer{margin-bottom:8px}paper-dialog-scrollable{margin-top:2px}@media (max-width:600px){#ratingsDialog{width:100%;height:100%;margin:0}}paper-button{margin-bottom:16px;margin-top:32px}</style><lite-signal on-lite-signal-yp-language="_languageEvent"></lite-signal><paper-dialog id="ratingsDialog"class="layout vertical"><template is="dom-if"if="[[isOpen]]"restamp=""><div class="itemHeader layout horizontal center-center"><iron-icon class="evalIcon"icon="rate-review"></iron-icon>[[t('evaluate')]]</div><div class="itemName">[[post.name]]</div><paper-dialog-scrollable class="layout vertical center-center"><div class="ratingContainer"><template is="dom-repeat"items="[[post.Group.configuration.customRatings]]"as="rating"><div class="layout vertical self-start itemContainer"><yp-magic-text content-id="[[post.id]]"extra-id="[[index]]"text-only=""content="[[rating.name]]"content-language="[[post.Group.language]]"class="ratingName"text-type="customRatingName"></yp-magic-text><yp-rating post-id="[[post.id]]"class="layout horizontal self-start"rating-index="[[index]]"emoji="[[rating.emoji]]"number-of="[[rating.numberOf]]"rate="[[getRating(index)]]"on-yp-rating-add="_addRating"on-yp-rating-delete="_deleteRating"></yp-rating></div></template></div></paper-dialog-scrollable></template><div class="buttons layout horizontal center-center"><paper-button raised=""elevation="1"dialog-confirm=""on-tap="_close">[[t('close')]]</paper-button></div></paper-dialog><yp-ajax id="ajax"></yp-ajax></template><script>Polymer({is:"yp-dialog-ratings",behaviors:[Polymer.ypLanguageBehavior],properties:{itemName:{type:String},isOpen:{type:Boolean,value:!1},post:Object,refreshFunction:Function},getRating:function(t){return window.appUser.loggedIn()&&window.appUser.ratingPostsIndex[this.post.id]&&window.appUser.ratingPostsIndex[this.post.id][t]?window.appUser.ratingPostsIndex[this.post.id][t].value:null},_close:function(){this.refreshFunction()},_addRating:function(t,e){window.appUser.updateRatingForPost(e.postId,e.ratingIndex,{post_id:e.postId,type_index:e.ratingIndex,value:e.rate}),this.$.ajax.method="POST",this.$.ajax.url="/api/ratings/"+e.postId+"/"+e.ratingIndex,this.$.ajax.body={value:e.rate},this.$.ajax.generateRequest()},_deleteRating:function(t,e){window.appUser.updateRatingForPost(e.postId,e.ratingIndex,null),this.$.ajax.method="DELETE",this.$.ajax.url="/api/ratings/"+e.postId+"/"+e.ratingIndex,this.$.ajax.body={},this.$.ajax.generateRequest()},open:function(t,e){this.set("refreshFunction",e),this.set("post",t),this.set("isOpen",!1),this.async(function(){this.set("isOpen",!0),this.$.ratingsDialog.open()})}})</script></dom-module>