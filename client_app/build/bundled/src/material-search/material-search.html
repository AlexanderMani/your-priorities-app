<html><head><link rel="import" href="../../bower_components/polymer/polymer.html">
<link rel="import" href="../../bower_components/paper-toolbar/paper-toolbar.html">
<link rel="import" href="../../bower_components/paper-menu/paper-menu.html">
<link rel="import" href="../../bower_components/paper-item/paper-item.html">
<link rel="import" href="../../bower_components/paper-ripple/paper-ripple.html">
<link rel="import" href="../../bower_components/paper-header-panel/paper-header-panel.html">
<link rel="import" href="../../bower_components/paper-icon-button/paper-icon-button.html">
<link rel="import" href="../../bower_components/iron-icons/av-icons.html">

</head><body><dom-module id="material-search">
  <template>

    <style>
      :host {
        display: none;
        margin: 0;
        background: rgba(255, 255, 255, 0.9);
        color: #757575;
        z-index: 20;
      }

      :host([active]) {
        display: block;
      }

      paper-menu {
        margin-left: 0;
        margin-right: 0;
        overflow: auto;
      }

      paper-toolbar {
        background-color: white;
      }

      input {
        border: none;
        background: transparent;
        font: inherit;
        font-size: 16px;
        outline: none;
      }

      @media (min-width: 600px) {
        paper-menu {
          max-width: 50%;
          margin: 0 auto;
          max-height: 50vh;
        }
      }

      :host {
        --paper-icon-button: {
          color: var(--paper-grey-500);
        };
      }

      paper-item iron-icon {
        margin-right: 24px !important;
      }
    </style>
    <div class$="{{_computeHeaderClass(narrow)}}">
      <paper-icon-button icon="arrow-back" on-tap="toggle"></paper-icon-button>
      <input id="searchbox" placeholder="[[placeHolder]]" class="flex" value="{{searchValue}}" on-keyup="doSearch">
      <paper-icon-button icon="av:mic" on-tap="getSpeechInput"></paper-icon-button>
    </div>
    <paper-menu on-iron-activate="onSelect">
      <template is="dom-repeat" items="{{previousSearches}}">
        <paper-item class="relative" data-value$="{{item}}">
          <iron-icon icon="history"></iron-icon>
          <span>{{item}}</span>
          <paper-ripple></paper-ripple>
        </paper-item>
      </template>
    </paper-menu>
  </template>
  <script>Polymer({is:"material-search",properties:{previousSearches:{type:Array,value:function(){return[]},notify:!0},narrow:{type:Boolean,value:!1},active:{type:Boolean,value:!1,reflectToAttribute:!0,notify:!0},searchValue:{type:String,value:null,observer:"_searchValueChanged"},placeHolder:{type:String,value:"search"}},onSelect:function(e,t){this.async(function(){this.searchValue=t.item.dataset.value},250)},toggle:function(){this.active=!this.active,this.active&&this.$.searchbox.focus()},getSpeechInput:function(e){var t="SpeechRecognition"in window?new SpeechRecognition:"webkitSpeechRecognition"in window?new webkitSpeechRecognition:null;t&&(t.continuous=!1,t.interimResults=!1,t.onresult=function(e){var t=e.results[0][0].transcript;this.searchValue=t}.bind(this),t.start())},doSearch:function(e){13==e.keyCode&&this._searchValueChanged()},_searchValueChanged:function(){this.searchValue&&(this.fire("search-change",{value:this.searchValue}),this.searchValue="")},_computeHeaderClass:function(e){return e?"core-narrow":""}});</script>
</dom-module>
</body></html>