<html><head></head><body><div hidden="" by-polymer-bundler=""><dom-module id="yp-post-card-add" assetpath="../yp-post/"><template><style include="iron-flex iron-flex-alignment">:host{margin-top:8px;}.postCard{width:280px;min-height:80px;height:100%;margin-top:8px;padding:8px;background-color:var(--accent-color);color:#FFF;font-size:16px;cursor:pointer;margin-bottom:8px;}paper-icon-button{height:80px;width:80px;color:#FFF;}.header{padding:0;margin:0;padding-top:16px;}.icon{--iron-icon-height:140px;--iron-icon-width:140px;}.half{width:50%;}paper-fab{}.addText{padding-left:0;}iron-icon{width:64px;height:64px;padding-right:64px;}.addNewIdeaText{font-size:26px;width:100%;color:#FFF;}@media (max-width: 832px){.postCard{width:100%;margin-left:64px;margin-right:64px;}}@media (max-width: 420px){.postCard{max-width:250px;width:250px;minx-height:68px;margin-left:0;margin-right:0;margin-bottom:4px;}.addNewIdeaText{font-size:20px;width:100%;}paper-icon-button{height:68px;width:68px;}}</style><lite-signal on-lite-signal-yp-language="_languageEvent"></lite-signal><div class="layout vertical center-center"><paper-card elevation="[[elevation]]" class="postCard" on-tap="_newPost"><div class="layout horizontal center-center addNewIdeaText"><paper-icon-button icon="lightbulb-outline"></paper-icon-button><div class="flex addText">[[t('post.add_new')]]</div></div></paper-card></div></template><script>Polymer({is:'yp-post-card-add',properties:{elevation:{type:Number}},_newPost:function(){this.fire('new-post')},behaviors:[Polymer.appHelpers]});</script></dom-module><dom-module id="yp-posts-filter" assetpath="../yp-posts-filter/"><template><style include="iron-flex iron-flex-alignment">:host{padding-bottom:0 !important;margin-bottom:0 !important;}paper-menu-button{padding:0;margin:0;}.filterIcon{padding-right:8px;}.filterIconTransform{-moz-transform:scaleY(-1);-o-transform:scaleY(-1);-webkit-transform:scaleY(-1);transform:scaleY(-1);filter:FlipV;-ms-filter:"FlipV";}.dropdown-trigger{margin-bottom:16px;margin-left:16px;}.clear-search-trigger{width:55px;height:55px;margin-bottom:16px;}paper-item{min-height:32px;}.subTitle{font-size:22px;margin-top:10px;margin-right:8px;}#filterDropdown{padding-left:0;margin-left:0;}@media (max-width: 600px){.subTitle{font-size:17px;padding-top:0;margin-top:16px;}.dropdown-trigger{padding-left:0;margin-left:0;margin-bottom:0;margin-top:0;}.clear-search-trigger{width:50px;height:50px;margin-top:5px;margin-bottom:0;margin-top:0;}}paper-dropdown-menu{padding-left:8px;padding-right:8px;background-color:var(--primary-background-color);}.filterHeader{margin-top:16px;padding-bottom:0;margin-bottom:0;font-weight:bold;font-size:18px;}.categoriesDropdownMenu{padding-left:16px;parring-right:16px;}#dropDownTrigger{background-color:var(--accent-color);margin-left:16px;color:#FFF;}.dropdownIcon{color:#FFF;margin-right:8px;margin-left:8px;}.catImage{width:24px;height:24px;margin-right:8px;}</style><lite-signal on-lite-signal-yp-language="_languageEvent"></lite-signal><template is="dom-if" if="[[group]]"><div class="layout horizontal center-center mainContainer wrap"><template is="dom-if" if="[[showFilter]]"><paper-menu-button id="filterDropdown" class="selected-items" icon="sort" vertical-align="auto" horizontal-align="right"><paper-button raised="" title$="[[t('filterIdeas')]]" id="dropDownTrigger" icon="sort" slot="dropdown-trigger"><iron-icon icon="sort" class="dropdownIcon"></iron-icon>{{t('filterIdeas')}}</paper-button><div slot="dropdown-content" class="layout vertical"><div><div class="filterHeader layout horizontal center-center">[[t('filterIdeas')]]</div><template is="dom-if" if="[[categoriesWithCount]]" restamp=""><div class="layout vertical"><paper-dropdown-menu class="dropdown-content wrap categoriesDropdownMenu"><paper-listbox slot="dropdown-content" id="categoryMenu" attr-for-selected="data-category-id" on-iron-select="_changeCategory"><paper-item data-category-id="-1" name="-1"><iron-icon icon="select-all" class="filterIcon"></iron-icon><span>[[t('categories.the_all')]] ([[allPostCount]])</span></paper-item><template is="dom-repeat" items="[[categoriesWithCount]]" as="category"><paper-item data-category-id$="[[category.id]]" data-category-name$="[[category.name]]"><iron-image sizing="cover" class="catImage" height="24" width="24" src="[[_categoryImageSrc(category)]]"></iron-image>[[category.name]] ([[category.count]])</paper-item></template></paper-listbox></paper-dropdown-menu></div></template><div class="layout horizontal center-center"><yp-ajax id="categoriesWithCountAjax" on-response="_categoriesCountResponse"></yp-ajax></div><paper-listbox slot="dropdown-content" id="mainListMenu" on-iron-select="_changeFilter"><paper-item data-filter="top"><iron-icon icon="trending-up" class="filterIcon"></iron-icon><span>[[t('post.top')]]</span></paper-item><paper-item data-filter="newest"><iron-icon icon="new-releases" class="filterIcon"></iron-icon><span>[[t('post.newest')]]</span></paper-item><paper-item data-filter="most_debated"><iron-icon icon="chat-bubble-outline" class="filterIcon"></iron-icon><span>[[t('post.most_debated')]]</span></paper-item><paper-item data-filter="random"><iron-icon icon="cached" class="filterIcon"></iron-icon><span>[[t('post.random')]]</span></paper-item></paper-listbox></div></div></paper-menu-button></template><template is="dom-if" if="[[searchingFor]]"><paper-icon-button icon="clear" on-tap="_clearSearch" class="clear-search-trigger"></paper-icon-button></template></div></template></template><script>Polymer({is:"yp-posts-filter",behaviors:[Polymer.appHelpers],properties:{filter:{type:String,value:"newest",notify:!0,observer:"_filterChanged"},filterName:{type:String},categoryId:{type:String,notify:!0,observer:"_categoryIdChanged"},categoryName:{type:String},group:{type:Object,observer:"_groupChanged"},subTitle:{type:String,value:"",notify:!0},searchingFor:{type:String,value:null,notify:!0,observer:"_searchingForChanged"},showFilter:{type:Boolean,value:!0},postsCount:{type:Number,notify:!0},tabName:{type:String,observer:"_tabNameChanged"},categoriesWithCount:{type:Array,value:null},allPostCount:{type:Number,value:0}},observers:["_listLanguageChanged(language)"],_getCategoryCount:function(a,b){var c=__.find(b,function(b){return b.category_id==a});return c?c.count:0},_oldCategory:function(a){return!a||804>a.id},_categoriesCountResponse:function(a,b){var c=b.response.categoriesCount;this.set("allPostCount",b.response.allPostCount);var d=[];__.each(this.group.Categories,function(a){a.count=this._getCategoryCount(a.id,c),0<a.count&&d.push(a)}.bind(this)),1<d.length?(this.set("categoriesWithCount",d),this.async(function(){var a=this.$$("#categoryMenu");a?a.selected="-1":console.error("Cant set category menu")})):console.error("Unexpected categories count")},_openDropDown:function(){var a=this.$$("#dropDownTrigger");a&&a.click()},_searchingForChanged:function(a){this.showFilter=!!a||!0},_clearSearch:function(){this.set("searchingFor",null),this.set("filter","newest"),this._updateAfterFiltering()},openFilter:function(){window.appGlobals.activity("open","filter")},_filterChanged:function(a){a&&(this.filterName="post."+this.filter,this._updateTitle())},_categoryIdChanged:function(a){a&&this._updateTitle()},_listLanguageChanged:function(a){a&&this.t&&this._updateTitle()},searchFor:function(a){this.set("searchingFor",a);var b="/group/"+this.group.id+"/open/"+this.group.name+"/search/"+this.searchingFor;window.appGlobals.activity("change","filter",b),this.redirectTo(b),this.fire("refresh-group")},_updateTitle:function(){if(this.searchingFor)this.set("subTitle",this.t("post.searchingFor")+this.searchingFor);else{var a,b=this.t(this.filterName);a=this.categoryName?this.categoryName:this.t("categories.the_all");this.t("short_word.in");this._ifCategories()?this.set("subTitle",b+" - "+a):this.set("subTitle",b)}},_changeFilter:function(a,b){this.set("filter",b.item.dataset.filter),this._updateAfterFiltering()},_changeCategory:function(a,b){var c=this.categoryId,d=b.item.dataset.categoryId;"-1"==d?(this.set("categoryId",null),this.categoryName=null,this.$$("#categoryMenu").selected=null):(this.set("categoryId",d),this.categoryName=b.item.dataset.categoryName),this._updateTitle(),c!==this.categoryId&&this._updateAfterFiltering()},buildPostsUrlPath:function(){var a="/group/"+this.group.id+"/"+this.tabName;return this.filter&&(a+="/posts/"+this.filter),this.categoryId&&(a+="/"+this.categoryId+"/"+this.categoryName),a},_updateAfterFiltering:function(){this.filter||this.set("filter","newest");var a=this.buildPostsUrlPath();window.appGlobals.activity("change","filter",a),this.fire("refresh-group")},_ifCategories:function(){return!!this.group&&this.group.Categories&&0<this.group.Categories.length},resetSelection:function(){this.async(function(){var a=this.$$("#categoryMenu");a&&(this.$$("#categoryMenu").selected=null);var b=this.$$("#mainListMenu");b?this.$$("#mainListMenu").selected=null:console.error("Cant find mainListMenu menu")},100)},_tabNameChanged:function(){},_setupCategories:function(a,b){this.set("categoriesWithCount",null),this.async(function(){var c=this.$$("#categoriesWithCountAjax");c?(c.url="/api/groups/"+a.id+"/categories_count/"+b,c.generateRequest()):console.error("Can't find categories ajax.")},100)},_groupChanged:function(a){this.set("categoriesWithCount",null),this.set("allPostCount",0),this.set("categoryId",null),a&&(this._updateTitle(),a.Categories&&0<a.Categories.length&&this._setupCategories(a,this.tabName),this.resetSelection())},_categoryItems:function(){return this.group.Categories?this.splitArray(this.group.Categories,7):[]},_categoryImageSrc:function(a){return this.getImageFormatUrl(a.CategoryIconImages,0)}});</script></dom-module><dom-module id="yp-post-list" assetpath="../yp-post/"><template><style include="iron-flex iron-flex-alignment">:host{}.container{@apply (--layout-horizontal);@apply (--layout-wrap);}.postsFilter{padding-left:16px;height:36px;}.objectives{padding-bottom:40px;max-width:432px;}.description{padding:12px;}yp-post-card{padding-bottom:52px;}#outerRegion{position:relative;@apply (--layout-vertical);}#scrollableRegion{}iron-list{}yp-ajax{padding-top:48px;}yp-posts-filter{margin-bottom:8px;margin-left:8px;margin-top:16px;}#ironList{}.searchButton{padding:8px;margin:8px;}.searchContainer{margin-top:8px;}yp-posts-filter{padding-right:16px;}.half{width:50%;}.searchBox{--paper-input-container-label:{font-size:22px;color:#555;};margin-bottom:22px;margin-right:8px;}@media (max-width: 800px){.searchBox{--paper-input-container-label:{font-size:17px;};margin-bottom:8px;}.half{width:100%;}.searchContainer{@apply (--layout-center-center);}}.noIdeas{background-color:#FFF;max-width:200px;padding:16px;margin:16px;margin-top:32px;}.noIdeasText{font-weight:bold;}.card{padding:0;padding-top:8px;}.card[wide-padding]{padding:16px !important;}#searchInput{margin-left:8px;}[hidden]{display:none !important;}</style><lite-signal on-lite-signal-yp-language="_languageEvent"></lite-signal><iron-media-query query="(min-width: 600px)" query-matches="{{wide}}"></iron-media-query><iron-a11y-keys id="a11y" target="[[searchTarget]]" keys="enter" on-keys-pressed="_search"></iron-a11y-keys><div class="layout vertical center-center"><div class="searchContainer layout horizontal wrap"><div class="layout horizontal center-center"><yp-posts-filter on-tap="_tapOnFilter" sub-title="{{subTitle}}" class="filter" id="postsFilter" tab-name="[[statusFilter]]" on-refresh-group="_refreshGroupFromFilter" group="[[group]]" filter="{{filter}}" searching-for="{{searchingFor}}" category-id="{{categoryId}}" category-name="{{categoryName}}" posts-count="{{postsCount}}"></yp-posts-filter></div><div class="layout horizontal center-center"><paper-input id="searchInput" label$="[[t('searchFor')]]" value="{{searchingFor}}" class="searchBox"></paper-input><paper-icon-button icon="search" on-tap="_search" hidsden$="[[!showSearchIcon]]"></paper-icon-button></div></div><template is="dom-if" if="[[noPosts]]" restamp=""><div class="layout horiztonal center-center"><paper-material class="noIdeas layout horizontal center-center" elevation="2"><div class="noIdeasText">[[t('noIdeasHere')]]</div></paper-material></div></template></div><div class="layout horizontal center-center"><iron-list id="ironList" scroll-offset="550" items="[[posts]]" as="post" scroll-target="document" grid=""><template><div wide-padding$="[[wide]]" class="card layout vertical center-center"><yp-post-card tabindex$="[[tabIndex]]" class="card" post="[[post]]" on-mouseover="cardMouseOver" on-mouseout="cardMouseOut"></yp-post-card></div></template></iron-list></div><div class="layout horizontal center-center"><yp-ajax id="ajax" large-spinner="" on-response="_postsResponse"></yp-ajax></div></template><script>Polymer({is:"yp-post-list",behaviors:[Polymer.appHelpers,Polymer.YpScrollTabBehavior,Polymer.ypIronListBehavior],properties:{categories:{type:Array},subTitle:{type:String,notify:!0},defaultCategories:{type:Boolean,value:!1},posts:{type:Array,value:null,notify:!0},groupId:{type:Number,observer:"_groupIdChanged"},userId:{type:Number},group:{type:Object,notify:!0,observer:"_groupChanged"},filter:{type:String,value:"newest",observer:"_filterChanged"},statusFilter:{type:String,value:"open",notify:!0},categoryId:{type:String,observer:"_categoryIdChanged"},postsCount:{type:Number,notify:!0},searchTarget:{type:Object,computed:"_searchTarget(noPosts)"},categoryName:{type:String},searchingFor:{type:String,value:null,observer:"_searchingForChanged"},selectedCategoryName:{type:String},selectedTab:{type:String,observer:"_selectedTabChanged"},tabCounterId:{type:String},oldestPostAt:{type:Date},noPosts:{type:Boolean,value:!1},wideListOffset:{type:Number,value:610},listOffset:{type:String,value:"500px"},showSearchIcon:{type:Boolean,value:!1},randomSeed:{type:Number,value:null}},_tapOnFilter:function(){window.appGlobals.activity("click","filter")},_searchTarget:function(a){a||this.async(function(){return this.$$("#searchInput")})},_selectedTabChanged:function(a){this.statusFilter==a},_search:function(){window.appGlobals.activity("click","search"),this.searchingFor&&""!=this.searchingFor&&this._refreshGroupFromFilter()},cardMouseOver:function(a){a.currentTarget.elevation=4},cardMouseOut:function(a){a.currentTarget.elevation=1},buildPostsUrlPath:function(){return this.$.postsFilter.buildPostsUrlPath()},_searchingForChanged:function(a){this.set("moreToLoad",!0),a&&""!=a?this.set("showSearchIcon",!0):this.set("showSearchIcon",!1)},_filterChanged:function(){this.set("moreToLoad",!0)},_categoryIdChanged:function(){this.set("moreToLoad",!0)},ready:function(){},_groupIdChanged:function(){},_groupChanged:function(a){this.set("posts",null),this.set("noPosts",!1),this.set("randomSeed",Math.random()),a&&(this.set("moreToLoad",!0),a.configuration&&a.configuration.canAddNewPosts!=void 0?!0===a.configuration.canAddNewPosts?this.set("filter","newest"):!1===a.configuration.canAddNewPosts&&!1===a.configuration.canVote?this.set("filter","top"):this.set("filter","random"):!this.filter&&this.set("filter","newest"),this._loadMoreData())},_refreshGroupFromFilter:function(){this.set("posts",null),this.set("moreToLoad",!0),this._loadMoreData()},_loadMoreData:function(){if(this.moreToLoad&&this.group){console.info("_loadMoreData for groupId: "+this.groupId+" statusFilter: "+this.statusFilter),this.set("moreToLoad",!1),this.set("noPosts",!1);var a,b;this.userId?(a=this.userId+"/posts",b="users"):(a=this.groupId,b="groups"),this.searchingFor?this.$$("#ajax").url="/api/"+b+"/"+a+"/search/"+this.searchingFor:(this.$$("#ajax").url="/api/"+b+"/"+a+"/posts/"+this.filter,this.$$("#ajax").url+=this.categoryId?"/"+this.categoryId:"/null",this.$$("#ajax").url+="/"+this.statusFilter),this.$$("#ajax").url+="?offset="+(null==this.posts?0:this.posts.length),this.randomSeed&&(this.$$("#ajax").url+="&randomSeed="+this.randomSeed),this.$$("#ajax").generateRequest()}},_postsResponse:function(a,b){var c=b.response.posts;if(this.set("postsCount",b.response.totalPostsCount),this.fire("yp-post-count",{tabCounterId:this.tabCounterId,count:this.postsCount}),!this.posts)this.set("posts",c);else for(var d=0;d<c.length;d++)this.push("posts",c[d]);0==c.length&&(null==this.posts||0==this.posts.length)&&this.set("noPosts",!0),0<c.length?this.set("noPosts",!1):this.searchingFor&&""!=this.searchingFor&&this.set("noPosts",!1),this.async(function(){var a=this.$$("#postsFilter");a&&a._updateTitle()},20),this.async(function(){this.$$("#ironList").fire("iron-resize")}),0<c.length&&c.length!=this.postsCount&&this.setMoreToLoad(),document.dispatchEvent(new CustomEvent("lite-signal",{bubbles:!0,compose:!0,detail:{name:"yp-refresh-activities-scroll-threshold",data:{}}})),this._processCategories()},_processCategories:function(){if(this.categoryId&&this.group)for(var a=0;a<this.group.Categories.length;a++)this.group.Categories[a].id==this.categoryId&&(this.selectedCategoryName=this.group.Categories[a].name);else this.selectedCategoryName="categories.all"}});</script></dom-module><dom-module id="yp-group-card-large"><template><style include="iron-flex iron-flex-alignment">:host{}.groupAccess{padding-bottom:8px;}.group-name{padding-bottom:4px;margin:0;}.group-name[admin]{padding-right:16px;}.objectives{line-height:var(--objectives-line-height, 1.3);}.groupCard{background-color:#fefefe;color:#333;height:243px;width:432px;padding:0 !important;margin-top:0 !important;}.stats{position:absolute;bottom:0px;right:8px;}.edit{color:#FFF;position:absolute;top:0;left:384px;padding-right:0;margin-right:0;}.description-and-stats{width:100%;}.newCategory{color:var( --primary-background-color,#F2F2F2);position:absolute;top:64px;right:0;}iron-image{width:432px;height:243px;}.description{padding:0;margin:0;}.groupDescription{padding-left:16px;padding-right:16px;padding-top:16px;font-size:var(--group-description-font-size, 16px);}.group-name{background-color:var(--primary-color-800, #000);color:#fafafa;padding-left:16px;padding-top:16px;padding-bottom:16px;}.textBox{margin-left:32px;position:relative;}@media (max-width: 945px){:host{width:306px;}.groupCard{margin-bottom:16px;width:306px;height:100%;}.top-card{margin-top:16px !important;}.edit{left:265px;}iron-image{width:306px;height:172px !important;}.imageCard{height:172px !important;}.group-name{font-size:20px;}.groupDescription{padding-top:6px;padding-bottom:42px;}.stats{}.textBox{margin-left:0;}}[hidden]{display:none !important;}</style><lite-signal on-lite-signal-yp-language="_languageEvent"></lite-signal><div class="layout horizontal center-center wrap"><paper-material id="cardImage" elevation="3" animated="" class="groupCard imageCard top-card"><iron-image class="logo" sizing="cover" preload="" src="[[groupLogoImagePath]]"></iron-image></paper-material><paper-material id="card" elevation="3" animated-shadow="" class="groupCard textBox"><div class="layout vertical"><div class="layout horizontal wrap"><div class="layout vertical description-and-stats"><div class="description"><h2 class="group-name" admin$="[[hasGroupAccess]]">[[groupName]]</h2><div hidden="" class="groupAccess">[[groupAccessText]]</div><div id="objectives" class="groupDescription"></div></div></div></div><div hidden$="[[!hasGroupAccess]]"><paper-menu-button class="edit" horizontal-align="[[editMenuAlign]]"><paper-icon-button icon="more-vert" slot="dropdown-trigger"></paper-icon-button><paper-listbox slot="dropdown-content" on-iron-select="_menuSelection" selected="{{selectedMenuItem}}"><paper-item id="editMenuItem">[[t('group.edit')]]</paper-item><paper-item id="newCategoryMenuItem">[[t('category.new')]]</paper-item><paper-item id="usersMenuItem">[[t('group.users')]]</paper-item><paper-item id="adminsMenuItem">[[t('group.admins')]]</paper-item><paper-item id="pagesMenuItem">[[t('pages.managePages')]]</paper-item><paper-item id="deleteMenuItem">[[t('group.delete')]]</paper-item></paper-listbox></paper-menu-button></div></div><yp-group-stats class="stats" group="[[group]]"></yp-group-stats></paper-material></div><iron-media-query query="(max-width: 800px)" query-matches="{{narrowScreen}}"></iron-media-query><lite-signal on-lite-signal-got-admin-rights="_gotAdminRights"></lite-signal></template><script>Polymer({is:'yp-group-card-large',behaviors:[Polymer.appHelpers,Polymer.GroupBehaviors,Polymer.LargeCardBehaviors,Polymer.AccessHelpers,Polymer.ypGotAdminRightsBehavior,Polymer.YpLinkifyAndEmjoi],properties:{group:{type:Object,observer:'_groupChanged'},hasGroupAccess:{type:Boolean,value:!1,computed:'_hasGroupAccess(group, gotAdminRights)'},groupAccessText:{type:String,computed:'_groupAccessText(group, language)'}},_hasGroupAccess:function(a,b){return a&&b&&null!=this.checkGroupAccess(a)},resetGroup:function(){this.set('group',null)},_groupChanged:function(a){if(a&&a.objectives)this.async(function(){var b=this.$$('#objectives');b?b.innerHTML=this.addLinksAndEmjois(a.objectives):console.error('Can\'t find group objectives element')});else{var b=this.$$('#objectives');b&&(b.innerHTML='')}},_groupAccessText:function(a,b){if(a&&b)switch(a.access){case 0:return this.t('group.public');break;case 1:return this.t('group.closed');break;case 2:return this.t('group.secret');}else return''},_menuSelection:function(a,b){'editMenuItem'==b.item.id?this._openEdit():'newCategoryMenuItem'==b.item.id?this._openCategoryEdit():'deleteMenuItem'==b.item.id?this._openDelete():'usersMenuItem'==b.item.id?this._openUsersDialog():'adminsMenuItem'==b.item.id?this._openAdminsDialog():'pagesMenuItem'==b.item.id&&this._openPagesDialog(),this.selectedMenuItem=null},_openPagesDialog:function(){window.appGlobals.activity('open','group.pagesAdmin'),Polymer.dom(document).querySelector('yp-app').getDialogAsync('pagesGrid',function(a){a.setup(this.group.id,null,null,!1),a.open()}.bind(this))},_openUsersDialog:function(){window.appGlobals.activity('open','group.users'),Polymer.dom(document).querySelector('yp-app').getDialogAsync('usersGrid',function(a){a.setup(this.group.id,null,null,!1),a.open()}.bind(this))},_openAdminsDialog:function(){window.appGlobals.activity('open','group.admins'),Polymer.dom(document).querySelector('yp-app').getDialogAsync('usersGrid',function(a){a.setup(this.group.id,null,null,!0),a.open()}.bind(this))},_openEdit:function(){window.appGlobals.activity('open','group.new'),Polymer.dom(document).querySelector('yp-app').getDialogAsync('groupEdit',function(a){a.setup(this.group,!1,this._refresh.bind(this)),a.open('edit',{groupId:this.group.id})}.bind(this))},_openDelete:function(){window.appGlobals.activity('open','group.delete');Polymer.dom(document).querySelector('yp-app').getDialogAsync('apiActionDialog',function(a){a.setup('/api/groups/'+this.group.id,this.t('group.deleteConfirmation'),this._onDeleted.bind(this)),a.open()}.bind(this))},_openCategoryEdit:function(){window.appGlobals.activity('open','category.new'),Polymer.dom(document).querySelector('yp-app').getDialog('categoryEdit',function(a){a.setup(this.group,!0,this._refreshCategory.bind(this)),a.open('new',{groupId:this.group.id})})},_refreshCategory:function(){this.fire('update-group')},_onDeleted:function(){this.dispatchEvent(new CustomEvent('yp-refresh-community',{bubbles:!0,composed:!0})),this.redirectTo('/community/'+this.group.community_id)},_newCategory:function(){this.$$('#newCategory').open('new',{groupId:this.group.id})},_refresh:function(a){a&&this.set('group',a),this.fire('update-group')}});</script></dom-module></div><dom-module id="yp-group"><template><style include="iron-flex iron-flex-alignment">.objectives{padding-bottom:40px;max-width:432px;}.description{padding:12px;}yp-ajax{background-color:var(--primary-background-color);}.counterInfo{font-size:11px;}.topContainer{margin-top:16px;}.createFab{position:fixed;bottom:24px;right:28px;background-color:var(--accent-color);color:#FFF;--paper-fab-iron-icon:{color:var(--icon-general-color, #FFF);height:40px;width:40px;};}.createFab[wide-layout]{width:72px;height:72px;--paper-fab-iron-icon:{color:var(--icon-general-color, #FFF);width:72px;height:72px;};}.createFabContainer[wide-layout] .createFab{}.topArea{background-color:var(--primary-background-color);background-image:var(--top-area-background-image, none);height:300px;}.tabs{width:1100px;padding-top:8px;padding-bottom:8px;}.tabs .tab{width:250px;}.largeAddButton{margin-bottom:4px;}@media (max-width: 1024px){.tabs{max-width:920px;}.tabs .tab{width:200px;}}@media (max-width: 900px){.tabs{max-width:550px;width:550px;font-size:14px;word-wrap:break-word !important;}.tabs[has-non-open-posts]{font-size:10px;}.counterInfo[has-non-open-posts]{font-size:9px;}.tabs .tab{width:120px;word-wrap:break-word !important;}.topArea{height:auto;}.largeAddButton[is-apple]{margin-top:32px;}.largeAddButton[is-ipad]{margin-top:48px;}}@media (max-width: 380px){.tabs{max-width:360px;font-size:12px;width:360px;}paper-tab{width:170px;}}@media (max-width: 320px){.tabs{max-width:320px;font-size:12px;width:320px;}paper-tab{width:160px;}}.tabSubTitle{font-size:13px;}.minHeightSection{min-height:450px;}.tabContainer[hide]{display:none;}[hidden]{display:none !important;}</style><div id="topContainer"><div id="topArea" class="large-card-wrapper layout horizontal center-center topArea" hidden$="[[group.configuration.hideGroupHeader]]"><yp-group-card-large id="groupCard" class="largeCard" group="[[group]]" on-update-group="_refreshAjax"></yp-group-card-large></div><template is="dom-if" if="[[!disableNewPosts]]" restamp=""><div class="largeAddButton layout horizontal center-center" is-apple$="[[isOldiOs]]" is-ipad$="[[isIpad]]"><yp-post-card-add on-new-post="_newPost" elevation="2"></yp-post-card-add></div></template><div class="layout horizontal center-center tabContainer" hide$="[[group.configuration.hideAllTabs]]"><paper-tabs scrollable$="[[!wideWidth]]" id="paperTabs" has-non-open-posts$="[[hasNonOpenPosts]]" class="tabs" selected="{{selectedTab}}" attr-for-selected="name" focused=""><paper-tab id="tab1" name="open"><div class="layout vertical center-center tabCounterContainer"><div hidden$="[[isTabOpen]]">[[t('posts.open')]]</div><div hidden$="[[!isTabOpen]]" class="tabSubTitsle">[[tabOpenSubTitle]]</div><div class="counterInfo" has-non-open-posts$="[[hasNonOpenPosts]]" id="tabCountOpen"></div></div></paper-tab><template is="dom-if" if="[[hasNonOpenPosts]]"><paper-tab name="in_progress"><div class="layout vertical center-center tabCounterContainer"><div>[[t('posts.inProgress')]]</div><div hidden$="[[!isTabInProgress]]" class="tabSubTitle">[[tabInProgressSubTitle]]</div><div hidden$="[[isTabInProgress]]" has-non-open-posts$="[[hasNonOpenPosts]]" class="counterInfo" id="tabCountInProgress"></div></div></paper-tab><paper-tab name="successful"><div class="layout vertical center-center tabCounterContainer"><div>[[t('posts.successful')]]</div><div hidden$="[[!isTabSuccessful]]" class="tabSubTitle">[[tabSuccessfulSubTitle]]</div><div hidden$="[[isTabSuccessful]]" has-non-open-posts$="[[hasNonOpenPosts]]" class="counterInfo" id="tabCountSuccessful"></div></div></paper-tab><paper-tab name="failed"><div class="layout vertical center-center tabCounterContainer"><div>[[t('posts.failed')]]</div><div hidden$="[[!isTabFailed]]" class="tabSubTitle">[[tabFailedSubTitle]]</div><div hidden$="[[isTabFailed]]" has-non-open-posts$="[[hasNonOpenPosts]]" class="counterInfo" id="tabCountFailed"></div></div></paper-tab></template><paper-tab name="news">[[t('news')]]</paper-tab><paper-tab name="map" hidden$="[[locationHidden]]">[[t('posts.map')]]</paper-tab></paper-tabs></div><iron-pages id="tabPages" class="tabPages" selected="{{selectedTab}}" attr-for-selected="name" entry-animation="fade-in-animation" exit-animation="fade-out-animation"><section name="open"><div class="layout horizontal center-center"><yp-post-list id="openPostList" sub-title="{{tabOpenSubTitle}}" selected-tab="[[selectedTab]]" list-route="[[listRoute]]" status-filter="open" tab-counter-id="tabCountOpen" searching-for="[[searchingFor]]" group="[[group]]" group-id="[[lastValidGroupId]]"></yp-post-list></div></section><section name="news" class="minHeightSection"><template is="dom-if" if="[[newsTabSelected]]"><ac-activities id="groupActivities" disable-new-posts="[[disableNewPosts]]" selected-tab="[[selectedTab]]" list-route="[[listRoute]]" group-id="[[group.id]]"></ac-activities></template></section><template is="dom-if" if="[[hasNonOpenPosts]]"><section name="in_progress"><div class="layout horizontal center-center"><yp-post-list id="inProgressPostList" sub-title="{{tabInProgressSubTitle}}" selected-tab="[[selectedTab]]" list-route="[[listRoute]]" status-filter="in_progress" tab-counter-id="tabCountInProgress" searching-for="[[searchingFor]]" group="[[group]]" group-id="[[lastValidGroupId]]"></yp-post-list></div></section><section name="successful"><div class="layout horizontal center-center"><yp-post-list id="successfulPostList" sub-title="{{tabSuccessfulSubTitle}}" selected-tab="[[selectedTab]]" list-route="[[listRoute]]" status-filter="successful" tab-counter-id="tabCountSuccessful" searching-for="[[searchingFor]]" group="[[group]]" group-id="[[lastValidGroupId]]"></yp-post-list></div></section><section name="failed"><div class="layout horizontal center-center"><yp-post-list id="failedPostList" sub-title="{{tabFailedSubTitle}}" selected-tab="[[selectedTab]]" list-route="[[listRoute]]" status-filter="failed" tab-counter-id="tabCountFailed" searching-for="[[searchingFor]]" group="[[group]]" group-id="[[lastValidGroupId]]"></yp-post-list></div></section></template><section name="map" hidden$="[[locationHidden]]" class="minHeightSection"><template is="dom-if" if="[[mapActive]]" restamp=""><yp-post-map group-id="[[group.id]]"></yp-post-map></template></section></iron-pages></div><template is="dom-if" if="[[!disableNewPosts]]" restamp=""><div class="create-fab-wrapper layout horizontal end-justified createFabContainer" hidden$="[[disableNewPosts]]"><paper-fab class="createFab" icon="[[createFabIcon]]" elevation="5" wide-layout$="{{wideWidth}}" title="[[createFabTitle]]" on-tap="_newPost"></paper-fab></div></template><iron-scroll-threshold id="scrollTheshold" lower-threshold="150" on-lower-threshold="_loadMoreData" scroll-target="document"></iron-scroll-threshold><lite-signal on-lite-signal-yp-language="_languageEvent"></lite-signal><lite-signal on-lite-signal-yp-refresh-group-posts="_refreshGroupPosts"></lite-signal><lite-signal on-lite-signal-yp-refresh-activities-scroll-threshold="_clearScrollThreshold"></lite-signal><iron-media-query query="(min-width: 1024px)" query-matches="{{wideWidth}}"></iron-media-query><app-route route="{{idRoute}}" pattern="/:id" data="{{idRouteData}}" tail="{{tabRoute}}"></app-route><app-route route="{{tabRoute}}" pattern="/:tabName" data="{{tabRouteData}}" tail="{{listRoute}}"></app-route><div class="layout horizontal center-center"><yp-ajax large-spinner="" id="ajax" on-response="_groupsResponse"></yp-ajax><yp-ajax id="pagesAjax" on-response="_pagesResponse"></yp-ajax></div></template><script>Polymer({is:'yp-group',behaviors:[Polymer.appHelpers,Polymer.ypThemeBehavior,Polymer.YpNewsTabSelected,Polymer.ypDetectOldiOs],listeners:{"yp-post-count":'_updateTabPostCount'},properties:{idRoute:Object,tabRoute:Object,idRouteData:Object,tabRouteData:Object,listRoute:Object,createFabIcon:{type:String,value:'lightbulb-outline'},groupId:{type:Number,observer:'_groupIdChanged'},group:{type:Object,notify:!0,value:null},searchingFor:{type:String,value:null},selectedTab:{type:String,value:'open',observer:'_selectedTabChanged'},hasNonOpenPosts:{type:Boolean,value:!1,observer:'_refreshTabsAndPages'},mapActive:{type:Boolean,value:!1},lastValidGroupId:{type:String},disableNewPosts:{type:Boolean,value:!1},locationHidden:{type:Boolean,value:!1},haveGotTabCountInfoCount:{type:Number,value:0},tabCounters:{type:Object,value:{}},tabOpenSubTitle:String,tabInProgressSubTitle:String,tabSuccessfulSubTitle:String,tabFailedSubTitle:String,isTabOpen:{type:Boolean,computed:'_isTabOpen(selectedTab)'},isTabInProgress:{type:Boolean,computed:'_isTabInProgress(selectedTab)'},isTabSuccessful:{type:Boolean,computed:'_isTabSuccessful(selectedTab)'},isTabFailed:{type:Boolean,computed:'_isTabFailed(selectedTab)'},isOldiOs:{type:Boolean,computed:'_isOldiOs(groupId)'},isIpad:{type:Boolean,computed:'_isIpad(groupId)'}},observers:['_routeIdChanged(idRouteData.id)','_routeTabChanged(tabRouteData.tabName)'],_isTabOpen:function(a){return'open'===a},_isTabInProgress:function(a){return'in_progress'===a},_isTabFailed:function(a){return'failed'===a},_isTabSuccessful:function(a){return'successful'===a},_clearScrollThreshold:function(){this.$$('#scrollTheshold').clearTriggers(),console.warn('Clearing scrolling triggers for group')},_loadDataOnTab:function(a){var b=this.$$('#'+a);b?b._loadMoreData():console.error('Cant find tab '+a)},_isIpad:function(){return /iPad/.test(navigator.userAgent)&&!window.MSStream},_loadMoreData:function(){'open'==this.selectedTab?this._loadDataOnTab('openPostList'):'in_progress'==this.selectedTab?this._loadDataOnTab('inProgressPostList'):'successful'==this.selectedTab?this._loadDataOnTab('successfulPostList'):'failed'==this.selectedTab&&this._loadDataOnTab('failedPostList')},_refreshGroupPosts:function(){this.$$('#openPostList')._refreshGroupFromFilter()},_routeIdChanged:function(a){a&&this.set('groupId',a)},_routeTabChanged:function(a){a&&this.set('selectedTab',a)},_selectedTabChanged:function(a){'config'==a?this.async(function(){var a=this.listRoute.path,b=this.idRoute.path.split('/')[1],c=a.substring(1,a.length);b&&c&&''!=c&&window.appGlobals.setupGroupConfigOverride(b,c),this.set('selectedTab','open')}):(this.group&&this.redirectTo('/group/'+this.group.id+'/'+a),'map'==a?this.set('mapActive',!0):this.set('mapActive',!1),a&&window.appGlobals&&window.appGlobals.activity('open','group_tab_'+a),this.async(function(){var a=this.$$('#groupActivities');a&&a.fireResize()},300))},_refreshTabsAndPages:function(){this.async(function(){var a=this.$$('#tabPages');a&&a.forceSynchronousItemUpdate();var b=this.$$('#paperTabs');b&&(b.forceSynchronousItemUpdate(),b.notifyResize())},10)},_updateTabPostCount:function(a,b){var c=this.$$('#'+b.tabCounterId);c&&(c.innerHTML=this.formatNumber(b.count),this.tabCounters[b.tabCounterId]=b.count),this.haveGotTabCountInfoCount+=1,this.hasNonOpenPosts&&4==this.haveGotTabCountInfoCount&&(this.tabCounters.tabCountOpen&&0<this.tabCounters.tabCountOpen?this.set('selectedTab','open'):this.tabCounters.tabCountInProgress&&0<this.tabCounters.tabCountInProgress?this.set('selectedTab','in_progress'):this.tabCounters.tabCountSuccessful&&0<this.tabCounters.tabCountSuccessful?this.set('selectedTab','successful'):this.tabCounters.tabCountFailed&&0<this.tabCounters.tabCountFailed&&this.set('selectedTab','failed'))},_searchingForChanged:function(){},_filterChanged:function(){},_categoryIdChanged:function(){},_openEdit:function(){this.$$('#groupEdit').open('edit',{groupId:this.group.id})},_refreshAjax:function(){this.$.ajax.generateRequest();var a=this.$$('#groupActivities');a&&this.$$('#groupActivities').loadNewData()},ready:function(){},_groupIdChanged:function(a){a&&a!=this.lastValidGroupId&&(this.set('lastValidGroupId',a),this.set('group',null),this.$.groupCard.resetGroup(),this.$.tabCountOpen.innerHTML='',this.hasNonOpenPosts&&(this.$$('#tabCountInProgress').innerHTML='',this.$$('#tabCountSuccessful').innerHTML='',this.$$('#tabCountFailed').innerHTML=''),this.set('selectedTab','open'),this.set('hasNonOpenPosts',!1),this.set('haveGotTabCountInfoCount',0),this.set('tabCounters',{}),this._getGroup())},_getGroup:function(){this.$.ajax.url='/api/groups/'+this.groupId,this.$.ajax.retryMethodAfter401Login=this._getGroup.bind(this),this.$.ajax.generateRequest()},_pagesResponse:function(a,b){this.fire('yp-set-pages',b.response)},_groupsResponse:function(a,b){this.set('group',b.response.group),this.set('group.configuration',window.appGlobals.overrideGroupConfigIfNeeded(this.group.id,this.group.configuration)),this.refresh(),this.group.configuration.canAddNewPosts==void 0?this.set('disableNewPosts',!1):!0===this.group.configuration.canAddNewPosts?this.set('disableNewPosts',!1):this.set('disableNewPosts',!0),this.set('hasNonOpenPosts',b.response.hasNonOpenPosts),'edit'==this.selectedTab&&(this.set('tabName','open'),this.$$('#groupCard')._openEdit())},setupTopHeaderImage:function(a){if(this.wideWidth){var b;b=a?'url('+this.getImageFormatUrl(a,0)+')':'none',this.updateStyles({"--top-area-background-image":b})}},refresh:function(){this.group&&(this.fire('yp-set-home-link',{type:'group',id:this.group.id,name:this.group.name}),null!=this.group.configuration.defaultLocale&&this.changeLocaleIfNeeded(this.group.configuration.defaultLocale),window.appGlobals.setCommunityAnalyticsTracker(this.group.Community.google_analytics_code),this.group.Community.configuration&&this.group.Community.configuration.facebookPixelId&&window.appGlobals.setCommunityPixelTracker(this.group.Community.configuration.facebookPixelId),null==this.group.theme_id?null==this.group.Community.theme_id?null!=this.group.Community.Domain.theme_id&&this.setTheme(this.group.Community.Domain.theme_id):this.setTheme(this.group.Community.theme_id):this.setTheme(this.group.theme_id),this.group.configuration.locationHidden?!0==this.group.configuration.locationHidden?this.set('locationHidden',!0):this.set('locationHidden',!1):this.set('locationHidden',!1),this._refreshTabsAndPages(),this.group.GroupHeaderImages&&0<this.group.GroupHeaderImages.length?this.setupTopHeaderImage(this.group.GroupHeaderImages):this.setupTopHeaderImage(null),this.fire('change-header',{headerTitle:this.group.configuration.fixedReturnUrlName?this.group.configuration.fixedReturnUrlName:this.group.Community.name,headerDescription:this.group.Community.description,headerIcon:'social:group',documentTitle:this.group.name,enableSearch:!0,hideHelpIcon:!!this.group.configuration.hideHelpIcon||null,useHardBack:!!this.group.configuration.fixedReturnUrl,backPath:this.group.configuration.fixedReturnUrl?this.group.configuration.fixedReturnUrl:'/community/'+this.group.community_id}),this.$.pagesAjax.url='/api/groups/'+this.group.id+'/pages',this.$.pagesAjax.generateRequest(),window.appGlobals.setAnonymousGroupStatus(this.group),window.appGlobals.disableFacebookLoginForGroup=this.group.configuration&&!0===this.group.configuration.disableFacebookLoginForGroup)},_newPost:function(){window.appGlobals.activity('open','newPost'),Polymer.dom(document).querySelector('yp-app').getDialogAsync('postEdit',function(a){a.setup(null,this.group,!0,null),a.open('new',{groupId:this.groupId})}.bind(this))}});</script></dom-module></body></html>