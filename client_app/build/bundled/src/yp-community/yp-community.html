<div hidden="" by-polymer-bundler=""><dom-module id="yp-group-card" assetpath="../yp-group/"><template><style include="iron-flex iron-flex-alignment">:host{display:block;@apply --layout-vertical;width:416px}.description{color:var(--primary-color-more-darker,#424242);line-height:var(--description-line-height,1.3)}.groupCard{height:445px;background-color:#fff}.objectives{@apply --layout-vertical;color:var(--primary-color-more-darker,#424242);line-height:var(--objectives-line-height,1.3);padding:16px}.stats{position:absolute;bottom:0;right:8px}.group-name[archived]{background-color:#aaa}iron-image[archived]{opacity:.85;filter:alpha(opacity=85)}iron-image{width:416px;height:234px;display:block}yp-group-stats{color:var(--primary-color-more-darker,#424242)}paper-card{background-color:red;vertical-align:text-top}.informationText{vertical-align:text-top}.group-name{margin:0;font-size:var(--large-heading-size,26px);padding:8px;padding-top:16px;padding-bottom:16px;background-color:var(--primary-color-800);color:#FFF;font-weight:700;cursor:pointer;vertical-align:middle;width:auto}.group-name[featured]{font-size:25px;background-color:var(--accent-color)}yp-membership-button[archived]{display:none}yp-membership-button{position:absolute;right:16px;top:214px;width:32px;height:32px;color:var(--icon-general-color,#FFF)}.objectives{padding:8px}@media (max-width:960px){:host{max-width:423px;width:100%;padding-top:0!important}.groupCard{margin-left:0;margin-right:0;padding-left:0;padding-right:0;width:100%;height:100%;padding-bottom:38px}yp-membership-button{top:205px}iron-image{width:100%;height:230px}.group-name{width:auto}}@media (max-width:420px){iron-image{height:225px}yp-membership-button{top:205px}}@media (max-width:375px){iron-image{height:207px}yp-membership-button{top:185px}}@media (max-width:360px){iron-image{height:200px}}@media (max-width:320px){iron-image{height:180px}yp-membership-button{top:155px}}.withPointer{cursor:pointer}[hidden]{display:none!important}</style><iron-media-query query="(min-width: 600px)" query-matches="{{wide}}"></iron-media-query><paper-card class="groupCard" animated="" elevation="[[elevation]]"><iron-image hidden$="[[!noImage]]" header-mode$="[[headerMode]]" archived$="[[archived]]" sizing="cover" class="main-image withPointer" src="https://i.imgur.com/sdsFAoT.png" on-tap="_goToGroup"></iron-image><iron-image hidden$="[[noImage]]" archived$="[[archived]]" class="logo withPointer" sizing="cover" on-tap="_goToGroup" preload="" src="[[groupLogoImagePath]]"></iron-image><div id="groupName" class="group-name" archived$="[[archived]]" featured$="[[featured]]" on-tap="_goToGroup"><yp-magic-text text-type="groupName" content-language="[[group.language]]" disable-translation="[[group.configuration.disableNameAutoTranslation]]" text-only="" content="[[groupName]]" content-id="[[group.id]]"></yp-magic-text><span hidden$="[[!archived]]">- [[t('archived')]]</span></div><yp-magic-text id="objectives" class="objectives withPointer" on-tap="_goToGroup" text-type="groupContent" content-language="[[group.language]]" text-only="" content="[[groupObjectives]]" content-id="[[group.id]]" truncate="200"></yp-magic-text><yp-group-stats class="stats" group="[[group]]"></yp-group-stats><yp-membership-button archived$="[[archived]]" group="[[group]]"></yp-membership-button></paper-card></template><script>Polymer({is:"yp-group-card",behaviors:[Polymer.ypLanguageBehavior,Polymer.GroupBehaviors,Polymer.ypTruncateBehavior,Polymer.ypMediaFormatsBehavior,Polymer.ypGotoBehavior]});</script></dom-module><dom-module id="yp-group-grid" assetpath="../yp-group/"><template><style include="iron-flex iron-flex-alignment">.groupCard{padding:0;padding-top:16px}.groupCard[wide-padding]{padding:16px!important}iron-list{height:100vh}[hidden]{display:none!important}:focus{outline:0}</style><lite-signal on-lite-signal-yp-language="_languageEvent"></lite-signal><iron-media-query query="(min-width: 1024px)" query-matches="{{wide}}"></iron-media-query><div class="layout horizontal center-center"><iron-list id="ironList" scroll-offset="[[scrollOffset]]" items="[[activeGroups]]" as="group" scroll-target="document" grid$="[[wide]]"><template><div class="groupCard layout vertical center-center" tabindex$="[[tabIndex]]" wide-padding$="[[wide]]"><yp-group-card wide-padding$="[[wide]]" group="[[group]]" on-mouseover="cardMouseOver" on-mouseout="cardMouseOut"></yp-group-card></div></template></iron-list></div></template><script>Polymer({is:"yp-group-grid",behaviors:[Polymer.ypLanguageBehavior,Polymer.ypIronListBehavior,Polymer.ypCardMouseBehavior],properties:{featuredGroups:Array,archivedGroups:Array,activeGroups:Array,hideAdd:{type:Boolean,value:!1},wide:{type:Boolean,value:!1},scrollOffset:{type:Number,computed:"_scrollOffset(wide, featuredGroups, activeGroups)"}},_scrollOffset:function(o,e){var r=this.$.ironList;if(r){var s=r.offsetTop;return s-=75,r.offsetTop>0&&s>0?(console.info("Group list scroll offset: "+s),s):(s=o?390:450,console.info("Group list (manual) scroll offset: "+s),s)}return console.warn("No group list for scroll offset"),null},scrollToItem:function(o){console.log("Group grid scrolling to item"),this.$.ironList.scrollToItem(o),document.dispatchEvent(new CustomEvent("lite-signal",{bubbles:!0,compose:!0,detail:{name:"yp-refresh-activities-scroll-threshold",data:{}}}))},_newGroup:function(){this.fire("add-new-group")}});</script></dom-module></div><dom-module id="yp-community"><template><style include="iron-flex iron-flex-alignment">.card-container{@apply --layout-horizontal;@apply --layout-wrap;}.card{padding:16px}yp-ajax{background-color:var(--primary-background-color)!important}.archivedText{font-size:26px;color:#333}.minHeightSection{min-height:450px}#paper_tabs[apple]{margin-top:42px;margin-bottom:8px}[hidden]{display:none!important}</style><yp-page id="page" create-fab-icon="[[createFabIcon]]" create-fab-title="[[t('group.add')]]" on-yp-create-fab-tap="_newGroup" hide-all-tabs="[[community.configuration.hideAllTabs]]"><template is="dom-if" if="[[useAlternativeHeader]]"><yp-community-header id="communityCard" slot="largeCard" class="largeCard card" community="[[community]]" on-update-community="_refreshAjax"></yp-community-header></template><template is="dom-if" if="[[useNormalHeader]]"><yp-community-large-card id="communityCard" slot="largeCard" class="largeCard card" community="[[community]]" on-update-community="_refreshAjax"></yp-community-large-card></template><paper-tabs id="paper_tabs" apple$="[[isOldiOs]]" slot="tabs" class="tabs" selected="{{selectedTab}}" attr-for-selected="name" focused="" hidden$="[[community.configuration.hideAllTabs]]"><paper-tab name="groups" class="tab"><span>[[t('groups')]]</span> &nbsp; (<span>[[groupsLength]]</span>)</paper-tab><paper-tab name="news" class="tab">[[t('news')]]</paper-tab><paper-tab name="map" class="tab" hidden$="[[locationHidden]]">[[t('posts.map')]]</paper-tab></paper-tabs><iron-pages class="tabPages" slot="tabPages" selected="{{selectedTab}}" attr-for-selected="name" entry-animation="fade-in-animation" exit-animation="fade-out-animation"><section name="groups"><div class="layout horizontal center-center"><yp-group-grid id="groupGrid" featured-groups="[[featuredGroups]]" active-groups="[[activeGroups]]" archived-groups="[[archivedGroups]]" hide-add$="[[!createFabIcon]]" on-add-new-group="_newGroup"></yp-group-grid></div></section><section class="minHeightSection" name="news"><template is="dom-if" if="[[newsTabSelected]]"><ac-activities id="communityNews" selected-tab="[[selectedTab]]" community-id="[[community.id]]"></ac-activities></template></section><section class="minHeightSection" name="map" hidden$="[[locationHidden]]"><template is="dom-if" if="[[mapActive]]" restamp=""><yp-post-map community-id="[[community.id]]"></yp-post-map></template></section></iron-pages></yp-page><lite-signal on-lite-signal-yp-language="_languageEvent"></lite-signal><lite-signal on-lite-signal-logged-in="_userLoggedIn"></lite-signal><lite-signal on-lite-signal-got-admin-rights="_gotAdminRights"></lite-signal><app-route route="{{idRoute}}" pattern="/:id" data="{{idRouteData}}" tail="{{tabRoute}}"></app-route><app-route route="{{tabRoute}}" pattern="/:tabName" data="{{tabRouteData}}"></app-route><yp-ajax id="ajax" url="/api/communities" on-response="_response"></yp-ajax><yp-ajax id="pagesAjax" on-response="_pagesResponse"></yp-ajax></template><script>Polymer({is:"yp-community",behaviors:[Polymer.ypLanguageBehavior,Polymer.GroupCollectionBehaviors,Polymer.ypThemeBehavior,Polymer.CollectionHelpers,Polymer.AccessHelpers,Polymer.YpNewsTabSelected,Polymer.ypLoggedInUserBehavior,Polymer.ypDetectOldiOs,Polymer.ypGotoBehavior,Polymer.ypMediaFormatsBehavior],properties:{idRoute:Object,tabRoute:Object,idRouteData:Object,tabRouteData:Object,createFabIcon:{type:String,value:null,notify:!0},communityId:{type:Number,value:null,observer:"_communityIdChanged"},community:{type:Object},selectedTab:{type:String,value:"groups",observer:"_selectedTabChanged"},mapActive:{type:Boolean,value:!1},locationHidden:{type:Boolean,value:!1},useAlternativeHeader:{type:Boolean,value:!1},isOldiOs:{type:Boolean,computed:"_isOldiOs(communityId)"},useNormalHeader:{type:Boolean,value:!0}},observers:["_routeIdChanged(idRouteData.id)","_routeTabChanged(tabRouteData.tabName)"],listeners:{"yp-new-group":"_newGroup"},_userLoggedIn:function(t){t&&this.community&&window.location.href.indexOf("/community/")>-1&&this.$$("#ajax").generateRequest()},_newPostForGroup:function(t){window.appGlobals.activity("open","newPost"),Polymer.dom(document).querySelector("yp-app").getDialogAsync("postEdit",function(e){e.setup(null,!0,null),e.open("new",{groupId:t.id,group:t})}.bind(this))},_refreshTabsAndPages:function(){this.async(function(){var t=this.$$("#tabPages");t&&t.forceSynchronousItemUpdate();var e=this.$$("#paper_tabs");e&&(e.forceSynchronousItemUpdate(),e.notifyResize())},10)},scrollToGroupItem:function(){if("news"===this.selectedTab&&null!==window.appGlobals.cachedActivityItem){var t=this.$$("#communityNews");t?(t.scrollToItem(window.appGlobals.cachedActivityItem),window.appGlobals.cachedActivityItem=null):console.warn("No community activities for scroll to item")}else"groups"===this.selectedTab&&window.appGlobals.backToCommunityGroupItems&&window.appGlobals.backToCommunityGroupItems[this.community.id]&&(this.$.groupGrid.scrollToItem(window.appGlobals.backToCommunityGroupItems[this.community.id]),window.appGlobals.backToCommunityGroupItems[this.community.id]=null)},_routeIdChanged:function(t){t&&this.set("communityId",t)},_routeTabChanged:function(t){t&&this.set("selectedTab",t)},_selectedTabChanged:function(t){this.community&&this.redirectTo("/community/"+this.community.id+"/"+t),"map"==t?this.set("mapActive",!0):this.set("mapActive",!1),t&&window.appGlobals&&window.appGlobals.activity("open","community_tab_"+t,"",{id:this.communityId}),this.async(function(){var t=this.$$("#communityNews");t&&t.fireResize()},300)},_hideEdit:function(){return!this.community||(!window.appUser.loggedIn()||window.appUser.user.id!=this.community.user_id)},_communityHeaderUrl:function(t){return this.getImageFormatUrl(t.CommunityHeaderImages,2)},_communityIdChanged:function(t,e){t&&(this.set("community",null),this.set("featuredGroups",null),this.set("activeGroups",null),this.set("archivedGroups",null),this.set("selectedTab","groups"),this._getCommunity())},_getCommunity:function(){this.$$("#ajax").url="/api/communities/"+this.communityId,this.$$("#ajax").retryMethodAfter401Login=this._getCommunity.bind(this),this.$$("#ajax").generateRequest()},_newGroup:function(){window.appGlobals.activity("open","newGroup"),Polymer.dom(document).querySelector("yp-app").getDialogAsync("groupEdit",function(t){t.setup(null,!0,this._refreshAjax.bind(this)),t.open("new",{communityId:this.communityId,community:this.community})}.bind(this))},_pagesResponse:function(t,e){this.fire("yp-set-pages",e.response)},_response:function(t,e,i){if(this.set("community",e.response),this.community.is_community_folder)this.redirectTo("/community_folder/"+this.community.id);else{this.refresh(),this.community.is_community_folder||this.community.only_admins_can_create_groups&&!this.checkCommunityAccess(this.community)||this.set("createFabIcon","add");this._communityHeaderUrl(this.community);this.setupGroups(this.community.Groups),this._setLocationHidden(this.community.Groups),this.async(function(){var t=this.$$("#communityCard");t&&(t.setElevation(5),t.lowerCardLater())},20)}},_gotAdminRights:function(t,e){e&&e>0&&this.checkCommunityAccess(this.community)&&this.set("createFabIcon","add")},_setLocationHidden:function(t){var e=!0;t.forEach(function(t){t.configuration&&t.configuration.locationHidden?1!=t.configuration.locationHidden&&(e=!1):e=!1}.bind(this)),this.set("locationHidden",e),this._refreshTabsAndPages()},refresh:function(){if(this.community){var t,e,i;if(this.fire("yp-set-home-link",{type:"community",id:this.community.id,name:this.community.name}),window.appGlobals.setCommunityAnalyticsTracker(this.community.google_analytics_code),this.community.configuration&&window.appGlobals.setCommunityPixelTracker(this.community.configuration.facebookPixelId),null!=this.community.theme_id?this.setTheme(this.community.theme_id):null!=this.community.Domain.theme_id&&this.setTheme(this.community.Domain.theme_id),null!=this.community.default_locale&&window.appGlobals.changeLocaleIfNeeded(this.community.default_locale),this.community.configuration&&this.community.configuration.alternativeHeader&&""!=this.community.configuration.alternativeHeader?(this.set("useAlternativeHeader",!0),this.set("useNormalHeader",!1)):(this.set("useAlternativeHeader",!1),this.set("useNormalHeader",!0)),this.community.CommunityHeaderImages&&this.community.CommunityHeaderImages.length>0?this.$.page.setupTopHeaderImage(this.community.CommunityHeaderImages):this.$.page.setupTopHeaderImage(null),window.location.href.indexOf("/community")>-1)this.community.CommunityFolder?(t="/community_folder/"+this.community.CommunityFolder.id,e=this.community.CommunityFolder.name,i=this.community.CommunityFolder.description):(t="/domain/"+this.community.domain_id,e=this.community.Domain.name,i=this.community.Domain.description),this.fire("change-header",{headerTitle:e,headerDescription:i,headerIcon:"group-work",disableDomainUpLink:this.community.configuration&&!0===this.community.configuration.disableDomainUpLink,documentTitle:this.community.name,backPath:t});this.$.pagesAjax.url="/api/communities/"+this.community.id+"/pages",this.$.pagesAjax.generateRequest(),window.appGlobals.setAnonymousGroupStatus(null),window.appGlobals.disableFacebookLoginForGroup=!1,window.appGlobals.externalGoalTriggerUrl=null,window.appGlobals.currentGroupForceSaml=!1,this.community.configuration&&this.community.configuration.signupTermsPageId&&-1!=this.community.configuration.signupTermsPageId?window.appGlobals.signupTermsPageId=this.community.configuration.signupTermsPageId:window.appGlobals.signupTermsPageId=null}},defaultGroupFirst:function(t){for(var e=[],i=null,o=0;o<t.length;o++){var n=t[o];"default"!=n.short_name?e.push(n):i=n}return e.unshift(i),e},noTestGroup:function(t){for(var e=[],i=0;i<t.length;i++){var o=t[i];"test"!=o.short_name&&"ac-posts"!=o.short_name&&"development"!=o.short_name&&-1==o.short_name.indexOf("2012")&&-1==o.short_name.indexOf("2013")&&e.push(o)}return e},_refreshAjax:function(){this.async(function(){this.$$("#ajax").generateRequest()},100)},ready:function(){}});</script></dom-module>