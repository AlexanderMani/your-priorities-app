<html><head><link rel="import" href="../../bower_components/polymer/polymer.html">

<link rel="import" href="../../bower_components/iron-flex-layout/iron-flex-layout.html">
<link rel="import" href="../../bower_components/iron-list/iron-list.html">
<link rel="import" href="../../bower_components/iron-signals/iron-signals.html">

<link rel="import" href="../../bower_components/neon-animation/neon-animated-pages.html">
<link rel="import" href="../../bower_components/neon-animation/neon-animatable.html">
<link rel="import" href="../../bower_components/neon-animation/neon-animation.html">

<link rel="import" href="../../bower_components/paper-tabs/paper-tab.html">
<link rel="import" href="../../bower_components/paper-fab/paper-fab.html">
<link rel="import" href="../../bower_components/neon-animation/neon-animated-pages.html">

<link rel="import" href="../yp-behaviors/app-helpers.html">
<link rel="import" href="../yp-behaviors/collection-helpers.html">

<link rel="import" href="../yp-behaviors/yp-scroll-tab-behavior.html">
<link rel="import" href="../yp-theme/yp-theme-behavior.html">

<link rel="import" href="../ac-activities/ac-activities.html">

<link rel="import" href="../yp-ajax/yp-ajax.html">
<link rel="import" href="../yp-community/yp-community-card.html">
<link rel="import" href="../yp-community/yp-community-card-add.html">
<link rel="import" href="../yp-community/yp-community-collection-behaviors.html">
<link rel="import" href="../yp-group/yp-group-collection-behaviors.html">
<link rel="import" href="../yp-page/yp-page.html">
<link rel="import" href="../yp-other-social-media/yp-other-social-media.html">
<link rel="import" href="../yp-user/yp-user-large-card.html">

</head><body><dom-module id="yp-user">
  <template>
    <style>

      ac-activities {
        @apply(--layout-vertical);
        @apply(--layout-flex);
      }

      .card-container {
        @apply(--layout-horizontal);
        @apply(--layout-wrap);
      }

      @media (max-width: 330px) {
        .card {
          padding-left: 0;
          padding-right: 0;
          padding-bottom: 8px;
          padding-top: 8px;
        }

        .card-container {
          padding: 0;
          margin: 0;
        }
      }

      yp-ajax {
        background-color: var(--primary-background-color);
      }

      .twitterFeed {
        margin-top: 24px;
      }

      .archivedText {
        font-size: 26px;
        color: #333;
      }
    </style>
    <iron-signals on-iron-signal-yp-language="_languageEvent"></iron-signals>

    <yp-page id="page">

      <yp-user-large-card id="userCard" class="largeCard card" user="[[user]]" on-update-domain="_refresh"></yp-user-large-card>

      <paper-tabs id="paper_tabs" class="tabs" selected="{{selected}}" focused="">
        <paper-tab class="tab">[[t('news')]]</paper-tab>
        <paper-tab class="tab"><span>[[t('communities')]]</span> &nbsp; (<span>[[communitiesLength]]</span>)</paper-tab>
        <paper-tab class="tab"><span>[[t('groups')]]</span> &nbsp; (<span>[[groupsLength]]</span>)</paper-tab>
        <paper-tab class="tab">
          <div class="layout vertical center-center tabCounterContainer">
            <span>[[t('posts.posts')]]</span><div class="counterInfo" id="tabCount"></div>
          </div>
        </paper-tab>
      </paper-tabs>

      <iron-pages class="tabPages" selected="{{selected}}" entry-animation="fade-in-animation" exit-animation="fade-out-animation">
        <section>
          <div class="card-container layout center-center wrap">
          </div>
        </section>
        <section>
          <ac-activities user-id="[[user.id]]"></ac-activities>
        </section>
        <section>
          <template>
            <div class="layout horizontal center-center">
              <yp-post-list id="postList" selected-tab="[[selected]]" status-filter="open" tab-counter-id="tabCount" searching-for="[[searchingFor]]" group="[[group]]" group-id="[[groupId]]"></yp-post-list>
            </div>

          </template>
        </section>
      </iron-pages>
    </yp-page>

    <yp-ajax id="ajax" url="[[url]]" on-response="_response"></yp-ajax>
    <yp-ajax id="pagesAjax" on-response="_pagesResponse"></yp-ajax>

  </template>

  <script>Polymer({is:"yp-user",behaviors:[Polymer.appHelpers,Polymer.ypThemeBehavior,Polymer.CollectionHelpers,Polymer.CommunityCollectionBehaviors,Polymer.GroupCollectionBehaviors],properties:{userId:{type:Number,value:null,observer:"_userIdChanged"},url:{type:String},domainEmpty:{type:Boolean,value:!1},user:{type:Object},selected:{type:Number,value:0,observer:"_selectedChanged"},userTabName:{type:String,value:null,observer:"_tabNameChanged"}},openResetPasswordDialog:function(){page("/user/reset_password/:resetPasswordToken",scrollToTop,function(e){window.app.route="home",window.app.params=e.params,Polymer.Base.async(function(){var s=Polymer.dom(document).querySelector("yp-app").getDialog("resetPassword");s.open(e.params.resetPasswordToken)},500)})},openAcceptInvitationDialog:function(){page("/user/accept/invite/:inviteToken",scrollToTop,function(e){window.app.route="home",window.app.params=e.params,Polymer.Base.async(function(){var s=Polymer.dom(document).querySelector("yp-app").getDialog("acceptInvite");s.open(e.params.inviteToken)},500)})},_tabNameChanged:function(e){e&&("communities"==e?this.set("selected",0):"news"==e?this.set("selected",1):"other_social_media"==e&&this.set("selected",2))},_selectedChanged:function(e){this.user&&(0==e?this.redirectTo("/user/"+this.user.id+"/news"):1==e?this.redirectTo("/user/"+this.user.id+"/communities"):2==e?this.redirectTo("/user/"+this.user.id+"/groups"):3==e&&this.redirectTo("/user/"+this.user.id+"/posts"))},_userIdChanged:function(e,s){e&&(this.set("featuredCommunities",null),this.set("activeCommunities",null),this.set("archivedCommunities",null),this.set("featuredGroups",null),this.set("activeGroups",null),this.set("archivedGroups",null),this.$.ajax.url="/api/users/"+this.userId,this.$.ajax.generateRequest())},_refresh:function(){this.$.ajax.generateRequest()},_response:function(e,s,t){this.set("user",s.response),null!=this.user.theme_id&&this.setTheme(this.user.theme_id),this.user.UserHeaderImages&&this.user.UserHeaderImages.length>0&&this.$.page.setupTopHeaderImage(this.user.UserHeaderImages),this.setupCommunities(this.user.CommunityUsers),this.setupGroups(this.user.GroupUsers),this.fire("change-header",{historyBack:!0})}});</script>
</dom-module>
</body></html>