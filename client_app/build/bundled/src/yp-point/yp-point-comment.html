<html><head><link rel="import" href="../../bower_components/polymer/polymer.html"><link rel="import" href="../../bower_components/iron-flex-layout/iron-flex-layout-classes.html"><link rel="import" href="../../bower_components/iron-image/iron-image.html"><link rel="import" href="../yp-app-globals/yp-app-icons.html"><link rel="import" href="../yp-behaviors/app-helpers.html"><link rel="import" href="../yp-user/yp-user-image.html"><link rel="import" href="../yp-behaviors/access-helpers.html"><link rel="import" href="../yp-behaviors/yp-got-admin-rights-behavior.html"><link rel="import" href="../yp-behaviors/yp-logged-in-user-behavior.html"></head><body><dom-module id="yp-point-comment"><template><style include="iron-flex iron-flex-alignment">.userName{color:#777;}yp-user-image{padding-top:16px;padding-right:8px;}.userName{padding-bottom:4px;}.comment{margin-left:8px;margin-right:8px;padding-bottom:4px;margin-bottom:8px;padding-top:16px;}.commentDash{border-bottom:dashed #ddd;border-bottom-width:1px;}yp-point-actions{padding-top:8px;}#reportPointIconButton{color:#ddd;width:36px;height:36px;}</style><iron-signals on-iron-signal-got-admin-rights="_gotAdminRights"></iron-signals><iron-signals on-iron-signal-logged-in="_userLoggedIn"></iron-signals><iron-signals on-iron-signal-yp-language="_languageEvent"></iron-signals><div class="layout horizontal"><div class="layout horizontal"><yp-user-image user="[[user]]"></yp-user-image></div><div class="layout vertical"><div class="comment">[[point.content]]<div class="layout horizontal" hidden$="[[!point]]"><yp-point-actions point="[[point]]"></yp-point-actions><paper-icon-button hidden="" hiddedn$="[[!loggedInUser]]" title$="[[t('point.report')]]" id="reportPointIconButton" icon="warning" on-tap="_reportPoint"></paper-icon-button><template is="dom-if" if="[[hasPointAccess]]"><div class="layout horizontal self-end" hidden$=""><yp-ajax id="deletePointAjax" method="DELETE" on-response="_deleteResponse"></yp-ajax><paper-icon-button title$="[[t('delete')]]" icon="clear" on-tap="_deletePoint"></paper-icon-button></div></template></div></div></div></div></template><script>Polymer({is:'yp-point-comment',properties:{point:{type:Object,notify:!0,observer:'_pointChanged'},user:{type:Object},hideUser:{type:Boolean,value:!1},hasPointAccess:{type:Boolean,computed:'_hasPointAccess(point, gotAdminRights, loggedInUser)'}},behaviors:[Polymer.appHelpers,Polymer.AccessHelpers,Polymer.ypLoggedInUserBehavior,Polymer.ypGotAdminRightsBehavior],_deletePoint:function(){var a=Polymer.dom(document).querySelector('yp-app').getDialog('confirmationDialog');a.open(this.t('point.confirmDelete'),this._reallyDeletePoint.bind(this))},_reallyDeletePoint:function(){this.$$('#deletePointAjax').url='/api/points/'+this.point.id,this.$$('#deletePointAjax').body={},this.$$('#deletePointAjax').generateRequest()},_editResponse:function(a,b){b.response&&this.set('point',b.response),this.set('isEditing',!1)},_deleteResponse:function(){this.fire('yp-point-deleted',{pointId:this.point.id}),this.set('point',null)},_reportPoint:function(){window.appGlobals.activity('open','point.report');var a=Polymer.dom(document).querySelector('yp-app').getDialog('apiActionDialog');a.setup('/api/points/'+this.point.id+'/report',this.t('reportConfirmation'),this._onReport.bind(this),this.t('point.report'),'PUT'),a.open()},_onReport:function(){window.appGlobals.notifyUserViaToast(this.t('point.report')+': '+this.point.content)},_pointChanged:function(a){this.user=a?this.point.PointRevisions[0].User:null},_hasPointAccess:function(a){return this.checkPointAccess(a)},loginName:function(){return this.point.PointRevisions[0].User.name}});</script></dom-module></body></html>