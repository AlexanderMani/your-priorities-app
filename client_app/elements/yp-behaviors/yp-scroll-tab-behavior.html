<link rel="import" href="../../bower_components/polymer/polymer.html">

<script>
  /**
   * @polymerBehavior YpScrollTabBehavior
   */
  Polymer.YpScrollTabBehavior = {

    properties: {
      moreToLoad: {
        type: Boolean,
        value: false
      }
    },

    attached: function () {
      window.addEventListener('scroll', this._isLoadMoreElementInView.bind(this));
    },

    detached: function () {
      window.removeEventListener('scroll', this._isLoadMoreElementInView);
      debugger;
    },

    _isLoadMoreElementInView: function () {
      var loadMoreButton = this.$$("#loadMoreButton");
      if (this._isVisible() && loadMoreButton && withinviewport(loadMoreButton)) {
        this._loadMoreData();
      }
    },

    _isVisible: function () {
      return this.offsetParent && Boolean(this.offsetParent.offsetWidth || this.offsetParent.offsetHeight);
    },

    setMoreToLoad: function () {
      this.async(function () {
        this.set('moreToLoad', true);
        this.async(function () {
          this._isLoadMoreElementInView();
        }, 400);
      }, 250);
    }
  }
</script>
