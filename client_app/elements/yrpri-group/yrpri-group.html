  <!--
      TODO(polyup): unable to infer path to components
      directory. This import path is probably incomplete.
   -->
  <link rel="import" href="iron-flex-layout/iron-flex-layout.html">
<dom-module id="yrpri-group">
  <style>
    /* TODO(polyup): For speed, consider reworking these styles with .classes
                     and #ids rather than [attributes].
    */
    [layout] {
      @apply(--layout);
    }
    [layout][flex] {
      @apply(--layout-flex);
    }
    [layout][vertical] {
      @apply(--layout-vertical);
    }
    [layout][around-justified] {
      @apply(--layout-around-justified);
    }
    [layout][horizontal] {
      @apply(--layout-horizontal);
    }
  </style>
  <link rel="import" type="css" href="yrpri-group.css">
  <template>

    <div layout="" flex="" horizontal$="{{!small}}">
      <div layout="" style="vertical-align: top;width:100%;">
        <div layout="" vertical="" around-justified="" flex="">
          <div>
            <template is="dom-if" if="{{group.top_banner_file_name}}">
              <img width="568" class="groupImage" on-tap="goToGroup" src="{{computeSrc(group)}}">
            </template>
            <template is="dom-if" if="{{!group.top_banner_file_name}}">
              <img width="568" class="groupImage" on-tap="goToGroup" src="{{computeSrc2()}}">
            </template>
          </div>
          <div flex="" class="header" on-tap="goToGroup" layout="" vertical="">
            <div>
              <template is="dom-if" if="{{group.name}}">
                <b>{{computeExpression1(group, small)}}</b>
              </template>
              <template is="dom-if" if="showShortName">
                <br><span>{{group.short_name}}</span>
              </template>
            </div>
            <template is="dom-if" if="{{!small}}">
              <div flex="" style="">
                <idea-action-bar idea="{{idea}}" small="{{small}}" flex="" style="float:right; clear:right;"></idea-action-bar>
              </div>
              <paper-icon-button icon="report" style="color:#eee;"></paper-icon-button>
              <paper-icon-button class="share" style="color:#b0b0b0;" icon="image:remove-red-eye"></paper-icon-button>
              <paper-icon-button class="share" icon="social:share"></paper-icon-button>
              <template is="dom-if" if="{{computeIf()}}">
                <paper-menu-button class="selected-items" layout="" horizontal="">
                  <paper-icon-button icon="more-vert"></paper-icon-button>
                  <iron-dropdown class="dropdown" horizontal-align="right">
                    <div class="separator">Admin</div>
                    <paper-item>Breyta</paper-item>
                    <paper-item>Staða</paper-item>
                    <paper-item>Eyða</paper-item>
                  </iron-dropdown>
                </paper-menu-button>
              </template>
            </template>
          </div>

          <div layout="" class="description" horizontal="">
            <template is="dom-if" if="{{group.IsoCountry}}">
              <div style="padding-right:16px;">
                <iron-image src="{{computeSrc3(group)}}"></iron-image>
              </div>
            </template>
            <template is="dom-if" if="{{group.description}}">
              <div>
                <span>{{computeExpression3(group, small)}}</span>
              </div>
            </template>
          </div>
          <group-action-bar group="{{group}}"></group-action-bar>
        </div>
      </div>
    </div>
  </template>
  <script>
    Polymer({
      is: 'yrpri-group',
      properties: {
        group: { notify: true },
        showShortName: { notify: true },
        small: { notify: true }
      },
      goToGroup: function (e) {
        var groupUrl = '/#/groups/' + this.group.id + '/ideas/top/' + this.group.name;
        window.globals.activity('Anonymous', 'open', 'group', groupUrl);
        window.location = groupUrl;
      },
      computeSrc: function (group) {
        return 'https://s3.amazonaws.com/' + this.s3bucketName('') + '/sub_instances/top_banners/000/000/' + this.padNumber(group.id) + '/icon_full/' + group.top_banner_file_name;
      },
      computeSrc2: function () {
        return this.defaultGroupImage('');
      },
      computeIf: function () {
        return false;
      },
      computeSrc3: function (group) {
        return this.isoCountryImagePath('') + this.lowercase(group.IsoCountry.code) + '.png';
      },
      computeExpression1: function (group, small) {
        return this.truncate(this.trim(group.name), small ? 60 : 200);
      },
      computeExpression3: function (group, small) {
        return this.truncate(this.trim(group.description), small ? 200 : 10000, '...');
      }
    });
  </script>
</dom-module>
