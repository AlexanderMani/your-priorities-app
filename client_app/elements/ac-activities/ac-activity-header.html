<link rel="import" href="../../bower_components/polymer/polymer.html">

<link rel="import" href="../../bower_components/iron-flex-layout/iron-flex-layout.html">
<link rel="import" href="../../bower_components/iron-image/iron-image.html">

<link rel="import" href="../yp-behaviors/app-helpers.html">
<link rel="import" href="../yp-user/yp-user-image.html">

<dom-module id="ac-activity-header">
  <template>
    <style>

      yp-user-image {
        padding-right: 16px;
        padding-left: 16px;
      }

      .name {
        padding-top: 4px;
        color: #fff;
        font-weight: bold;
        text-align: right;
      }

      .imageStatus {
        padding-left: 16px;
      }

      .rousnded {
        -webkit-border-radius: 25px;
        -moz-border-radius: 25px;
        border-radius: 25px;
        display: block;
      }

      .organizationName {
        color: #eee;
        text-align: right;
      }
    </style>

    <div class="layout horizontal">
      <div class="layout vertical" hidden$="[[noText]]">
        <div class="name">
          [[activity.User.name]]
        </div>
        <div class="organizationName" hidden$="[[!_organizationName(activity.User)]]">
          [[_organizationName(activity.User)]]
        </div>
      </div>
      <template is="dom-if" if="[[_organizationImageUrl(activity.User)]]">
        <img sizing="cover" class="imageStatus rounded" src$="[[_organizationImageUrl(activity.User)]]">
      </template>
      <yp-user-image user="[[activity.User]]" hidden$="[[noImage]]"></yp-user-image>
    </div>
  </template>

  <script>
    Polymer({

      is: 'ac-activity-header',

      behaviors: [
        Polymer.appHelpers
      ],

      properties: {

        activity: {
          type: Object,
          observer: '_activityChanged'
        },

        noImage: {
          type: Boolean,
          value: false
        },

        noText: {
          type: Boolean,
          value: false
        }
      },

      _organizationName: function (user) {
        if (user.OrganizationUsers && user.OrganizationUsers.length > 0 && user.OrganizationUsers[0].name) {
          return user.OrganizationUsers[0].name;
        } else {
          return null;
        }
      },

      _organizationImageUrl: function (user) {
        if (user.OrganizationUsers && user.OrganizationUsers.length > 0 &&
            user.OrganizationUsers[0].OrganizationLogoImages &&
            user.OrganizationUsers[0].OrganizationLogoImages.length > 0) {
          var url = this.getImageFormatUrl(user.OrganizationUsers[0].OrganizationLogoImages, 2);
          return url;
        } else {
          return null;
        }
      },

      _activityChanged: function (newValue) {
      }

    });
  </script>
</dom-module>
