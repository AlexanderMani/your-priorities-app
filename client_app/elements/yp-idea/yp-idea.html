
<dom-module id="yp-idea">
  <style>
    /* TODO(polyup): For speed, consider reworking these styles with .classes
                     and #ids rather than [attributes].
    */
    :host[layout] {
      @apply(--layout);
    }
    :host[layout][vertical] {
      @apply(--layout-vertical);
    }
    [layout] {
      @apply(--layout);
    }
    [layout][vertical] {
      @apply(--layout-vertical);
    }
    [layout][center-center] {
      @apply(--layout-center-center);
    }
  </style>
  <link rel="import" type="css" href="yp-idea.css">
  <template bind="">
    <!--
    On larger screens, change the behavior of the header panel so it doesn't
    scroll away or do the condenses feature. Instead, treat its content like
    a regular toolbar.
    -->
        <div layout="" vertical="" center-center="">

          <yrpri-idea-header idea="{{idea}}" showcategory="true"></yrpri-idea-header>

          <paper-tabs selected="{{selected}}" id="paper_tabs" focused="">
            <paper-tab><span>{{computeExpression1()}}</span> (<span>{{idea.Points.length}}</span>)</paper-tab>
            <paper-tab>{{computeExpression3()}}</paper-tab>
            <paper-tab>{{computeExpression4()}}</paper-tab>
            <paper-tab>{{computeExpression5()}}</paper-tab>
          </paper-tabs>

          <neon-animated-pages notap="" selected="{{selected}}" style="width:100%;" transitions="slide-from-right">
            <yp-idea-points points="{{idea.Points}}"></yp-idea-points>
            <section><center><br><br><h1>{{computeExpression8()}}</h1></center></section>
            <section><center><br><br><h1>{{computeExpression8()}}</h1></center></section>
            <section><center><br><br><h1>{{computeExpression8()}}</h1></center></section>
          </neon-animated-pages>
        </div>
      </template>
    </base-layout>

    <iron-ajax auto="false" id="ajax" url$="{{computeUrl(idea_id)}}" last-response="{{response}}" handle-as="json">
    </iron-ajax>
  </template>
  <script>
    (function () {
      Polymer({

        is: 'yp-idea',

        properties: {
          contactId: { notify: true },
          contacts: { notify: true },
          ideaName: { notify: true },
          response: { observer: 'responseChanged' },
          selected: { observer: 'selectedChanged' }
        },

        responseChanged: function (detail, e, sender) {
          this.$.layout.setSpinner(false);
          this.idea = detail;
          if (this.idea.description === null) {
            this.idea.description = this.idea.Points[0].content;
            this.idea.Points.shift();
          }
        },

        selectedChanged: function (selected, previous) {
          if (selected == 0)
            window.globals.activity('Anonymous', 'open', 'pointsTab');
          else if (selected == 1)
            window.globals.activity('Anonymous', 'open', 'newsfeedTab');
          else if (selected == 2)
            window.globals.activity('Anonymous', 'open', 'photosTab');
          else if (selected == 3)
            window.globals.activity('Anonymous', 'open', 'solutionsTab');
        },

        ready: function () {
          this.$.layout.setSpinner(true);
          this.$.ajax.go();
        },

        computeUrl: function (idea_id) {
          return '/api/ideas/' + idea_id;
        },
        computeExpression1: function () {
          return this.t('ideas.tabs.debate');
        },
        computeExpression3: function () {
          return this.t('ideas.tabs.newsfeed');
        },
        computeExpression4: function () {
          return this.t('ideas.tabs.photos');
        },
        computeExpression5: function () {
          return this.t('ideas.tabs.solutions');
        },
        computeExpression8: function () {
          return this.t('ideas.tabs.not_implemented');
        }
      });
    }());
  </script>
</dom-module>
